<?xml version='1.0' encoding='UTF-8' ?>
<Adml xmlns="http://www.oracle.com/iAS/aggregator"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      TableSpace="websphere_j2eeserver">

 <Table Name="Response">
  <ColumnDef Name="serverName" Type="String" Key="true"/>
  <ColumnDef Name="Status" Type="Integer"/>

  <Select Name="Response_from_server">
    <TableFrom Name="Server"/>
    <Column Name="serverName" Type="String">
      <ColumnFrom Name="name"/>
    </Column>
    <Column Name="Status" Type="Integer">
      <Value>1</Value>
    </Column>
    <Where>
      <And>
      <Condition Type="String" Operator="EQ">
         <ColumnFrom Name="state"/>
         <Value>STARTED</Value>
      </Condition>
      <Condition Type="String" Operator="EQ">
        <ColumnFrom Name="serverName"/>
        <Value Name="ServerNames.parameter" />
      </Condition>
      </And>
    </Where>
  </Select>
  <Select Name="Response_result_count">
   <TableFrom Name="Response_from_server"/>

   <!-- If the server is down, there will be no runtime mBean. -->
   <!-- The number of rows will be zero.  In this case, return 0. -->
   <Column Name="numRows" Type="Integer">
    <Aggregation Operator="Count"/>
    <Default>0</Default>
   </Column>
   <Column Name="Status" Type="Integer">
     <Aggregation Operator="Max" Name="Status"/>
   </Column>
  </Select>

  <Select Name="Response_result">
   <TableFrom Name="Response_result_count"/>

   <Column Name="Status" Type="Integer">
    <If>
     <Condition Operator="GT">
      <ColumnFrom Name="numRows"/>
      <Value>0</Value>
     </Condition>
     <Then>
      <ColumnFrom Name="Status"/>
     </Then>
     <Else>
      <Value>0</Value>
     </Else>
    </If>
    <Default>0</Default>
   </Column>
  </Select>

 </Table>

</Adml>
