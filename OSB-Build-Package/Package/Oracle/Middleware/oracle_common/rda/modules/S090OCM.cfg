# S090OCM.cfg: Set up the Configuration Manager Interface
# $Id: S090OCM.cfg,v 2.19 2012/01/02 17:25:16 mschenke Exp $
# ARCS: $Header: /home/cvs/cvs/RDA_4/src/scripting/lib/modules/S090OCM.cfg,v 2.19 2012/01/02 17:25:16 mschenke Exp $
#
# Copyright (c) 2002, 2012, Oracle and/or its affiliates. All rights reserved.
#
# Change history
# 20120102  MSC  Change the copyright notice.

###############################################################################
# Collect the Oracle Configuration Manager setup information
###############################################################################

#------------------------------------------------------------------------------
# Module definition
#------------------------------------------------------------------------------
col=${OCM_IN_USE}
dsc='Set up the Configuration Manager Interface'
env=JAVA_HOME
exe=OCMcfg
fam=Cygwin,Unix,Windows
frk=1
lim=0
req=S000INI
var=ocm_enabled

#------------------------------------------------------------------------------
# Setting definitions
#------------------------------------------------------------------------------
[ocm_enabled]
typ=B
alt=ocm_in_use,has_instance_root
dft=${NO_OCM}
dsc="Prevent interferences between OCM installation and automated setup"
nam=-
var=no_ocm

[chk_in_use]
typ=B
dft=${can_use}
dsc='Is Oracle Configuration Manager in use?'
nam=OCM_IN_USE
var=OCM_DISTRIBUTION

[ocm_in_use]
typ=B
dft=1
dsc='Is Oracle Configuration Manager in use?'
nam=OCM_IN_USE
var=OCM_DISTRIBUTION

[no_ocm]
typ=B
alt=log_info
dft=0
dsc='Is Oracle Configuration Manager in use?'
nam=OCM_IN_USE

[OCM_DISTRIBUTION]
typ=T
dsc=OCM Distribution kit
opt=1

#------------------------------------------------------------------------------
# Check Oracle Configuration Manager existence
#------------------------------------------------------------------------------
[has_instance_root]
typ=D
alt=ocm_home
dft=${INSTANCE_ROOT}
dsc="Check the existance of the instance root directory"
nam=-
var=chk_setup

[ocm_home]
typ=D
alt=no_home
dft=${ORACLE_HOME}
dsc="Oracle Configuration Manager home"
nam=OCM_HOME
var=chk_ocm_home

[chk_ocm_home]
typ=D
alt=chk_ocm_kit
dft="${OCM_HOME}/ccr"
dsc="Check if $ORACLE_HOME/ccr already exists"
nam=-
var=ocm_ccr_bin

[ocm_ccr_bin]
typ=D
alt=chk_ocm_kit
dft="${OCM_HOME}/ccr/bin"
dsc="Get the $ORACLE_HOME/ccr/bin directory"
nam=-TMP_CCR_BIN
var=chk_emCCR

[chk_emCCR]
typ=F
alt=chk_ocm_kit
dft="<<Search:TMP_CCR_BIN:p:^emCCR(\.bat)?$"
dsc="Check for the existence of emCCR"
nam=-

#------------------------------------------------------------------------------
# OCM installation prerequisite checks
#------------------------------------------------------------------------------
[chk_ocm_kit]
typ=D
alt=no_kit
dft='${GRP.D_RDA}/ccr'
dsc='Check if OCM software directory exists'
nam=-TMP_RDA_CCR
var=chk_platform

[chk_platform]
typ=I
alt=not_supported
dft='member:RDA.OS:aix,hpux,linux,solaris,MSWin32,MSWin64'
dsc='Validate the platform'
nam=-
var=chk_aix

[chk_aix]
typ=I
alt=chk_mw_home
dft='member:RDA.OS:aix'
dsc='Check if it is a AIX'
nam=-
var=get_aix_version,chk_aix_version

[get_aix_version]
typ=T
dft=`oslevel`
dsc='AIX version'
nam=-TMP_AIX_VERSION

[chk_aix_version]
typ=I
alt=chk_mw_home
dft='match:TMP_AIX_VERSION:^[1-4]+'
dsc='Check AIX version (OCM does not support 4.3.0)'
nam=-
var=not_supported

[chk_mw_home]
typ=D
alt=chk_mw_home2
dft="${OCM_HOME}/../oracle_common"
dsc="Check for the existence of MW_HOME"
nam=-
var=mw_home

[chk_mw_home2]
typ=D
alt=chk_owner
dft="${OCM_HOME}/../utils"
dsc="Check for the existence of MW_HOME"
nam=-
var=mw_home

[chk_owner]
typ=I
alt=not_owner
dft='owner:OCM_HOME'
dsc='Validate the Oracle Configuration Manager home owner'
nam=-
var=chk_java_home

[chk_java_home]
typ=D
alt=chk_ora_jdk
dft='${JAVA_HOME}/jre'
dsc='Checks if JDK can be located using JAVA_HOME'
nam=-
var=chk_auto_setup

[chk_ora_jdk]
typ=D
alt=ask_ocm_java
dft=${ORACLE_HOME}/jdk
dsc="Is JDK installed in the ORACLE home?"
nam=-
var=chk_auto_setup

[ask_ocm_java]
typ=B
alt=no_java
dft=<<COND:NO_DIALOG:0:1
dsc="Specify alternate JAVA_HOME"
inp="RDA did not find a Java Development kit either in the Oracle home \
     directory or through the JAVA_HOME environment variable. Do you want to \
     specify an alternate location (Y/N)?"
nam=-
var=OCM_JAVA_HOME

[OCM_JAVA_HOME]
typ=D
dsc="Alternate Java home"
err="Warning: The specified directory does not -yet- exist"
inp="Enter the location of a Java Development Kit"
val=W
var=chk_ocm_java

[chk_ocm_java]
typ=D
alt=bad_java,ask_ocm_java
dft='${OCM_JAVA_HOME}/jre'
dsc='Checks if JDK can be located using OCM_JAVA_HOME'
nam=-
var=chk_auto_setup

[bad_java]
typ=C
dsc="Invalid JAVA_HOME candidate"
inp="${OCM_JAVA_HOME} does not correspond to a Java Development Kit.\n "
vis=0

[chk_auto_setup]
typ=B
alt=OCM_REQUEST
dft=${NO_DIALOG}
dsc="Is it an automated setup?"
nam=-
var=not_interactive

#------------------------------------------------------------------------------
# Oracle Configuration Manager installation requirement check results
#------------------------------------------------------------------------------
[mw_home]
typ=T
dft='OCM-09009: Middleware home found'
dsc='OCM installation requirement check result'
nam=LAST_INFO_S090OCM

[no_home]
typ=T
dft='OCM-09007: Oracle home not found'
dsc='OCM installation requirement check result'
nam=LAST_INFO_S090OCM

[not_interactive]
typ=T
dft='OCM-09006: Automated setup'
dsc='OCM installation requirement check result'
nam=LAST_INFO_S090OCM

[no_java]
typ=T
dft='OCM-09004: Java Development Kit not found'
dsc='OCM installation requirement check result'
nam=LAST_INFO_S090OCM

[no_kit]
typ=T
dft='OCM-09002: The Oracle Configuration Manager software is not available'
dsc='OCM installation requirement check result'
nam=LAST_INFO_S090OCM

[not_owner]
typ=T
dft='OCM-09003: Not owner of the destination home directory'
dsc='OCM installation requirement check result'
nam=LAST_INFO_S090OCM

[not_requested]
typ=T
dft='OCM-09000: Oracle Configuration Manager installation not requested' 
dsc='OCM installation requirement check result'
nam=LAST_INFO_S090OCM

[not_supported]
typ=T
dft='OCM-09001: The platform is not supported'
dsc='OCM installation requirement check result'
nam=LAST_INFO_S090OCM

[no_info]
typ=T
dsc='OCM installation result'
nam=LAST_INFO_S090OCM

[setup_postponed]
typ=T
dft='OCM-09010: Oracle Configuration Manager setup postponed'
dsc='OCM installation requirement check result'
nam=LAST_INFO_S090OCM

#------------------------------------------------------------------------------
# Oracle Configuration Manager log settings
#------------------------------------------------------------------------------
[log_config]
typ=E
dft="OCM|config|${OCM_DFT_MODE}|"
dsc="Log the Oracle home setup details"
nam=-

[log_info]
typ=E
dft="OCM|setup|N|||${LAST_INFO_S090OCM}"
dsc="Log the installation details"
nam=-

[log_install]
typ=E
dft="OCM|setup|${OCM_INSTALL}|${OCM_DB_SCRIPTS}|${OCM_APPS_SCRIPTS}|"
dsc="Log the installation details"
nam=-

[log_setup_mw]
typ=E
dft="OCM|setup|${OCM_SETUP_MOD_MW}|0|0|"
dsc="Log the Middleware home setup details"
nam=-

[log_setup_oh]
typ=E
dft="OCM|setup|${OCM_SETUP_MOD_OH}|0|0|"
dsc="Log the Oracle home setup details"
nam=-

#------------------------------------------------------------------------------
# Oracle Configuration Manager installation settings
#------------------------------------------------------------------------------
[OCM_REQUEST]
typ=B
dft=1
dsc='Has Oracle Configuration Manager installation been proposed?'
var=OCM_INSTALL

[OCM_INSTALL]
typ=M
alt=not_requested
bef="Select the mode that you want to install Oracle Configuration Manager in \
     ${OCM_HOME}"
cas=0
dft="C"
dsc="Oracle Configuration Manager installation mode"
err="Only a single letter corresponding to a menu item should be used"
hlp="RDA benefits from Oracle Configuration Manager by improving its data \
     collection. Oracle Configuration Manager (OCM) collects the configuration \
     information and uploads it to the OCM Repository in connected mode. \
     When OCM is configured in disconnected mode, it adds the OCM payload to \
     the RDA report packages in future RDA runs.\n "
itm="C|Connected Mode|D|Disconnected Mode|N|Do not install OCM"
inp="Enter the letter corresponding to your choice"
nam=OCM_INSTALL
mnu="C|D"
rsp="C|C|D|D|N|N"
val=F
var=ocm_select

[ocm_select]
typ=I
dft="decode:OCM_INSTALL:\
     C:chk_scripts,no_info,log_install,do_install:\
     D:chk_scripts,no_info,log_install,do_install:\
     N:not_requested"
nam=-

[chk_scripts]
typ=D
dft=${ORACLE_HOME}
dsc='Only install the scripts, when installed in ORACLE_HOME'
nam=-
var=OCM_DB_SCRIPTS

[OCM_DB_SCRIPTS]
typ=B
dft=1
dsc="Need to install the database collection scripts ?"
inp="Do you want to install OCM Database collection scripts (Y/N)?"
var=OCM_SYSDBA_USER,OCM_APPS_SCRIPTS

[OCM_SYSDBA_USER]
typ=T
dft="sys"
dsc="Sysdba user"
inp="Enter a SYSDBA user for installing the OCM Database collection scripts"

[OCM_APPS_SCRIPTS]
typ=B
dft=0
dsc="Is this an Oracle E-Business suite Database Oracle home?"
inp="Is ${ORACLE_HOME} an Oracle E-Business Suite Database Oracle home (Y/N)?"
var=OCM_APPS_USER

[OCM_APPS_USER]
typ=T
dft="APPS"
dsc="Apps user name, used for configuring eBusiness data collection"
inp="Enter the Apps Database user name"

#------------------------------------------------------------------------------
# OCM configuration prerequisite checks
#------------------------------------------------------------------------------
[chk_setup]
typ=B
alt=chk_in_use,chk_cfg_java_home
dsc="Check if some OCM setup is needed and if RDA can use OCM
exe=analyze
nam=-
var=chk_in_use

[chk_cfg_java_home]
typ=D
alt=chk_cfg_ora_jdk
dft='${JAVA_HOME}/jre'
dsc='Checks if JDK can be located using JAVA_HOME'
nam=-
var=chk_cfg_auto_setup

[chk_cfg_ora_jdk]
typ=D
alt=c_ask_ocm_java
dft=${ORACLE_HOME}/jdk
dsc="Is JDK installed in the ORACLE home?"
nam=-
var=chk_cfg_auto_setup

[c_ask_ocm_java]
typ=B
alt=no_java
dft=<<COND:NO_DIALOG:0:1
dsc="Specify alternate JAVA_HOME"
inp="RDA did not find a Java Development kit either in the Oracle home \
     directory or through the JAVA_HOME environment variable. Do you want to \
     specify an alternate location (Y/N)?"
nam=-
var=ask_java_home

[ask_java_home]
typ=D
dft=${OCM_JAVA_HOME}
dsc="Alternate Java home"
err="Warning: The specified directory does not -yet- exist"
inp="Enter the location of a Java Development Kit"
nam=OCM_JAVA_HOME
val=W
var=chk_cfg_ocm_java

[chk_cfg_ocm_java]
typ=D
alt=bad_java,c_ask_ocm_java
dft='${OCM_JAVA_HOME}/jre'
dsc='Checks if JDK can be located using OCM_JAVA_HOME'
nam=-
var=chk_cfg_auto_setup

[chk_cfg_auto_setup]
typ=B
alt=dsp_overview,OCM_SETUP
dft=${NO_DIALOG}
dsc="Is it an automated setup?"
nam=-
var=not_interactive

#------------------------------------------------------------------------------
# Oracle Configuration Manager configuration settings
#------------------------------------------------------------------------------
[dsp_overview]
typ=C
dsc="Display an OCM overview
exe=get_overview
inp="RDA benefits from Oracle Configuration Manager by improving its data \
     collection. Oracle Configuration Manager (OCM) collects the configuration \
     information and uploads it to the OCM Repository in connected mode. \
     When OCM is configured in disconnected mode, it adds the OCM payload to \
     the RDA report packages in future RDA runs.\n "

[OCM_SETUP]
typ=B
alt=setup_postponed
dft=1
dsc="Do you want RDA to configure OCM?"
inp="Do you want RDA to configure OCM now (Y/N)?"
var=ocm_setup_oh_mode,ocm_setup_mw_mode,cfg_instances

[set_dft_mode_c]
typ=T
dft="C"
dsc="Set 'C' as default mode"
nam=-OCM_DFT_MODE

[set_dft_mode_d]
typ=T
dft="D"
dsc="Set 'D' as default mode"
nam=-OCM_DFT_MODE

[set_dft_mode_n]
typ=T
dft="N"
dsc="Set 'N' as default mode"
nam=-OCM_DFT_MODE

[ocm_setup_oh_mode]
typ=M
bef="Oracle Configuration Manager is present in ${OCM_SETUP_DIR_OH} but its \
     setup is not complete.\n\
     Select the mode that you want to use:"
cas=0
dft="${OCM_DFT_MODE:C}"
dsc="Oracle Configuration Manager setup mode (OH)"
err="Only a single letter corresponding to a menu item should be used"
itm="C|Connected Mode|D|Disconnected Mode|N|Do not setup OCM"
inp="Enter the letter corresponding to your choice"
mnu="C|D|N"
nam=OCM_SETUP_MOD_OH
rsp="${OCM_SETUP_RSP_OH}"
val=F
var=ocm_oh_select

[ocm_oh_select]
typ=I
dft="decode:OCM_SETUP_MOD_OH:\
     C:set_dft_mode_c,set_oh_dir,no_info,log_setup_oh,do_config:\
     D:set_dft_mode_d,set_oh_dir,no_info,log_setup_oh,do_config:\
     N:set_dft_mode_n"
nam=-

[set_oh_dir]
typ=D
dft=${OCM_SETUP_DIR_OH}
dsc="Oracle home directory"
nam=OCM_SETUP_DIR_OH

[ocm_setup_mw_mode]
typ=M
bef="Oracle Configuration Manager is present in ${OCM_SETUP_DIR_MW} but its \
     setup is not complete.\n\
     Select the mode that you want to use:"
cas=0
dft="${OCM_DFT_MODE:C}"
dsc="Oracle Configuration Manager setup mode (MW)"
err="Only a single letter corresponding to a menu item should be used"
itm="C|Connected Mode|D|Disconnected Mode|N|Do not setup OCM"
inp="Enter the letter corresponding to your choice"
mnu="C|D|N"
nam=OCM_SETUP_MOD_MW
rsp="${OCM_SETUP_RSP_MW}"
val=F
var=ocm_mw_select

[ocm_mw_select]
typ=I
dft="decode:OCM_SETUP_MOD_MW:\
     C:set_dft_mode_c,no_info,log_setup_mw,do_config,set_mw_dir:\
     D:set_dft_mode_d,no_info,log_setup_mw,do_config,set_mw_dir:\
     N:set_dft_mode_n"
nam=-

[set_mw_dir]
typ=D
dft=${OCM_SETUP_DIR_MW}
dsc="Middleware oracle_common or utils directory"
nam=OCM_SETUP_DIR_MW

[cfg_instances]
typ=L
alt=OCM_INSTANCES
dft=${OCM_INSTANCE_IDS}
nam=-instance
sep="|"
var=get_config_dir

[get_config_dir]
typ=D
dft=${OCM_CONFIG_DIR_${instance}}
dsc="Home directory of instance ${instance}"
nam=-TMP_DIR
var=get_config_mode

[get_config_mode]
typ=M
bef="Select the mode that you want to configure the instance ${TMP_DIR}:"
cas=0
dft="${OCM_DFT_MODE:C}"
dsc="Configuration mode for instance ${instance}"
err="Only a single letter corresponding to a menu item should be used"
itm="C|Connected Mode|D|Disconnected Mode|N|Do not setup OCM"
inp="Enter the letter corresponding to your choice"
mnu="C|D|N"
nam=OCM_CONFIG_MOD_${instance}
val=F
var=sel_config_mode

[sel_config_mode]
typ=I
dft="decode:OCM_CONFIG_MOD_${instance}:\
     C:set_dft_mode_c,set_config_dir,no_info,log_config,do_config:\
     D:set_dft_mode_d,set_config_dir,no_info,log_config,do_config:\
     N:set_dft_mode_n,log_config"
nam=-

[set_config_dir]
typ=D
dft=${TMP_DIR}
dsc="Home directory of instance ${instance}"
nam=OCM_CONFIG_DIR_${instance}

[OCM_INSTANCES]
typ=M
bef="Multiplying the OCM collections is increasing the total collection time\n\
     Indicate which OCM collection at instance home level RDA should trigger:"
dft=S
dsc="Instance home collection mode"
err="Use 1, 2, or 3 only"
itm="1|All instances homes found|2|Selected instance homes|3|No instance homes"
inp="Enter the digit corresponding to your choice"
rsp="${OCM_INSTANCES_RSP}"
val=F

#------------------------------------------------------------------------------
# Post requests
#------------------------------------------------------------------------------
[do_config]
typ=T
dft='OCMinit'
dsc='Configure OCM in a post package treatment'
nam=POST_PACKAGE_S090OCM

[do_install]
typ=T
dft='OCMsetup'
dsc='Install OCM in a post package treatment'
nam=POST_PACKAGE_S090OCM
