# S280EXA.cfg: Collects Exadata Information
# $Id: S280EXA.cfg,v 2.22 2012/08/22 13:06:49 mschenke Exp $
# ARCS: $Header: /home/cvs/cvs/RDA_4/src/scripting/lib/modules/S280EXA.cfg,v 2.22 2012/08/22 13:06:49 mschenke Exp $
#
# Copyright (c) 2002, 2012, Oracle and/or its affiliates. All rights reserved.
#
# Change history
# 20120821  KRA  Include exa_network_comment setting.

###############################################################################
# Collect the Exadata Setup Information
###############################################################################

#------------------------------------------------------------------------------
# Module definition
#------------------------------------------------------------------------------
col=${EXA_IN_USE}
dsc="Collects Exadata Information"
exe=EXAcfg
req=S000INI
rpt=EXA_IN_USE
ttl="Oracle Product Settings"
var=force_exa_tests

#------------------------------------------------------------------------------
# Setting definitions
#------------------------------------------------------------------------------
[force_exa_tests]
typ=B
alt=EXA_IN_USE
dft=0
dsc="Is the Exadata collection required by the profile?"
nam=-
var=exa_in_use

[exa_in_use]
typ=B
dft=1
dsc="Is Exadata in use?"
nam=EXA_IN_USE
var=chk_cellip

[EXA_IN_USE]
typ=B
dft="<<COND:SELECTED_MODULE,1,RDA_DEFAULT,1,0"
dsc="Is Exadata in use?"
inp="Do you want to collect Exadata information (Y/N)?"
var=chk_cellip

[chk_cellip]
typ=F
alt=exa_comment,no_exa
dft="/etc/oracle/cell/network-config/cellip.ora"
dsc="Check if cellip.ora file exists"
nam=-
var=chk_profile,chk_type,exa_ssh_comment

[chk_profile]
typ=I
alt=EXA_TYPE
dft="exists:exa_type"
dsc="Profile based variable exists?"
nam=-
var=select_type

[select_type]
typ=T
dft="${exa_type}"
dsc="Collection type"
nam=EXA_TYPE

[EXA_TYPE]
typ=M
bef="Exadata collection type:"
dft="^"
dsc="Collection type"
err="Enter a menu item number only"
inp="Enter the number corresponding to the collection type"
itm="0|All diagnostic information|\
     1|Long brownout due to cell failure|\
     2|Cell failure issue|\
     3|Failed drives on cell or compute node|\
     4|Flash drives issue|\
     5|IB switch issue|\
     6|ILOM issue|\
     7|General network issue|\
     8|Network cabling issue|\
     9|RAC instance issue|\
     10|Sick or underperforming cell"
mnu="<<N"
rsp="0|_All_|\
     1|_CellBrownout_|\
     2|_CellFailure_|\
     3|_FailedDrives_|\
     4|_FlashDrives_|\
     5|_IbSwitch_|\
     6|_Ilom_|\
     7|_Network_|\
     8|_NetworkCabling_|\
     9|_RacInstance_|\
     10|_SickCell_"
val=E

[chk_type]
typ=I
dft="decode:EXA_TYPE:\
     _All_:chk_cells,EXA_COLLECT_SWITCH:\
     _CellBrownout_:chk_cells:\
     _CellFailure_:chk_cells:\
     _FailedDrives_:chk_cells:\
     _FlashDrives_:chk_cells:\
     _IbSwitch_:EXA_COLLECT_SWITCH:\
     _Ilom_:chk_cells,chk_nodes:\
     _Network_:chk_cells,chk_network_user:\
     _NetworkCabling_:chk_cells:\
     _RacInstance_:chk_cells:\
     _SickCell_:chk_cells"
dsc="Apply the type-related setup"
nam=-

[exa_comment]
typ=C
dsc="Report no cellip.ora"
inp="RDA is unable to locate cellip.ora in /etc/oracle/cell/network-config \
     directory. The collection is disabled.\n\n\
     Hit 'Return' to continue"

[no_exa]
typ=B
dft=0
dsc="Is Exadata in use?"
nam=EXA_IN_USE

[chk_cells]
typ=B
dft=0
dsc="Check which cells are present to analyze"
exe=chk_cells
nam=-
var=EXA_COLLECT_CELL

[EXA_COLLECT_CELL]
typ=B
dft=1
dsc="Should we collect cell information?"
inp="Do you want to collect cell information (Y/N)?"
lvl=1
var=select_cells,chk_selection

[select_cells]
typ=M
add="*|All cells|*|all_cells"
ask=0
bef="Exadata cell list:"
dft="${TMP_DFT_CELLS}"
dsc="Cell list"
dup="Cell already selected"
end="."
err="Enter a menu item number only"
inp="Enter the number corresponding to the cell, or * to select all cells, or \
     ${end} to terminate the list"
itm="${TMP_ITM_CELLS}"
mnu="<<I"
nam=EXA_CELLS
one="*"
rsp="^"
sep="|"
val=E

[all_cells]
typ=T
dft=${TMP_ALL_CELLS}
dsc="List all cells"
nam=EXA_CELLS

[chk_selection]
typ=I
alt=EXA_CELL_LOGIN,EXA_CELL_WAIT_PWD,EXA_ALERT_TAIL,EXA_MSODL_TAIL,\
    EXA_TRACE_TAIL
dft="match:EXA_CELLS:^\s*$"
dsc="Skip when the cell menu is empty"
nam=-

[EXA_CELL_LOGIN]
typ=T
dft='celladmin'
dsc="User to log in as on remote cells"
inp="Enter the user to login as on remote cells"

[EXA_CELL_WAIT_PWD]
typ=N
dft=30
dsc="Number of seconds to wait between password prompts for cells"
err="The number of seconds must be an integer greater than zero"
inp="Enter the number of seconds to wait between password prompts for \
     connecting to cells"
lvl=1
ref="I]0,["
val=F

[EXA_ALERT_TAIL]
typ=N
dft=30000
dsc="Default number of lines to be collected from alert.log"
err="The number of lines must be an integer greater than zero"
inp="Enter the default number of lines to be collected from the alert.log file"
lvl=9
ref="I]0,["
val=F

[EXA_MSODL_TAIL]
typ=N
dft=30000
dsc="Default number of lines to be collected from ms-odl.trc"
err="The number of lines must be an integer greater than zero"
inp="Enter the default number of lines to be collected from the ms-odl.trc file"
lvl=9
ref="I]0,["
val=F

[EXA_TRACE_TAIL]
typ=N
dft=1000
dsc="Default number of lines to be collected from trace files"
err="The number of lines must be an integer greater than zero"
inp="Enter the default number of lines to be collected from trace files"
lvl=9
ref="I]0,["
val=F

[chk_network_user]
typ=B
dft=${CUR.UID}
dsc="Check if it is root user"
fam=Unix
nam=-
var=exa_network_comment

[exa_network_comment]
typ=C
dsc="Report to execute TLroot to complete the collection"
fam=Unix
inp="WARNING: Collecting network information requires superuser privileges.\n\n\
     When the normal collection is complete, switch to root and execute the \
     TLroot tool with a command like:\n\
     \040\040${RDA_SELF} -vdT root\n\
     Next, switch back to the previous user to package the results with a \
     command like:\n\
     \040\040${RDA_SELF} -vP\n\n\
     Hit 'Return' to continue"

[EXA_COLLECT_SWITCH]
typ=B
dft=1
dsc="Should we collect switch information using remote connection?"
inp="Do you want to collect switch information using remote connection (Y/N)?"
lvl=1
var=EXA_SWITCH_LOGIN,EXA_SWITCH_WAIT_PWD,chk_user

[EXA_SWITCH_LOGIN]
typ=T
dsc="User to log in as on remote switches"
inp="Enter the user to login as on remote switches"

[EXA_SWITCH_WAIT_PWD]
typ=N
dft=30
dsc="Number of seconds to wait between password prompts for switches"
err="The number of seconds must be an integer greater than zero"
inp="Enter the number of seconds to wait between password prompts for \
     connecting to switches"
lvl=1
ref="I]0,["
val=F

[chk_user]
typ=B
dft=${CUR.UID}
dsc="Check if it is root user"
fam=Unix
nam=-
var=exa_switch_comment

[exa_switch_comment]
typ=C
dsc="Report to execute TLroot to complete the collection"
fam=Unix
inp="WARNING: Collecting switch information requires superuser privileges.\n\n\
     When the normal collection is complete, switch to root and execute the \
     TLroot tool with a command like:\n\
     \040\040${RDA_SELF} -vdT root\n\
     Next, switch back to the previous user to package the results with a \
     command like:\n\
     \040\040${RDA_SELF} -vP\n\n\
     Hit 'Return' to continue"

[chk_nodes]
typ=B
dft=0
dsc="Check which nodes are present to analyze"
exe=chk_nodes
nam=-
var=EXA_COLLECT_NODE

[EXA_COLLECT_NODE]
typ=B
dft=1
dsc="Should we collect remote compute node information?"
inp="Do you want RDA to collect ILOM information from remote compute nodes \
     (Y/N)?"
lvl=1
var=select_nodes,chk_node_selection

[select_nodes]
typ=M
add="*|All nodes|*|all_nodes"
ask=0
bef="Exadata remote compute node list:"
dft="${TMP_DFT_NODES}"
dsc="Remote compute node list"
dup="Node already selected"
end="."
err="Enter a menu item number only"
inp="Enter the number corresponding to the remote compute node, or * to select \
     all nodes, or ${end} to terminate the list"
itm="${TMP_ITM_NODES}"
mnu="<<I"
nam=EXA_NODES
one="*"
rsp="^"
sep="|"
val=E

[all_nodes]
typ=T
dft=${TMP_ALL_NODES}
dsc="List all remote compute nodes"
nam=EXA_NODES

[chk_node_selection]
typ=I
alt=EXA_NODE_LOGIN,EXA_NODE_WAIT_PWD,chk_node_user
dft="match:EXA_NODES:^\s*$"
dsc="Skip when the node menu is empty"
nam=-

[EXA_NODE_LOGIN]
typ=T
dsc="User to log in as on remote compute nodes"
inp="Enter the user to login as on remote compute nodes"

[EXA_NODE_WAIT_PWD]
typ=N
dft=30
dsc="Number of seconds to wait between password prompts for compute nodes"
err="The number of seconds must be an integer greater than zero"
inp="Enter the number of seconds to wait between password prompts for \
     connecting to compute nodes"
lvl=1
ref="I]0,["
val=F

[chk_node_user]
typ=B
dft=${CUR.UID}
dsc="Check if it is root user"
fam=Unix
nam=-
var=exa_ilom_comment

[exa_ilom_comment]
typ=C
dsc="Report to execute TLroot to complete the collection"
fam=Unix
inp="WARNING: Collecting ILOM information requires superuser privileges.\n\n\
     When the normal collection is complete, switch to root and execute the \
     TLroot tool with a command like:\n\
     \040\040${RDA_SELF} -vdT root\n\
     Next, switch back to the previous user to package the results with a \
     command like:\n\
     \040\040${RDA_SELF} -vP\n\n\
     Hit 'Return' to continue"

[exa_ssh_comment]
typ=C
dsc="Report to execute ssh manually before RDA"
fam=Unix
inp="NOTE: Collecting remote information requires ssh connection.\n\n\
     Take care that RDA does not perform the first connection to a remote \
     host. Run first ssh manually to verify the remote's host finger print \
     and to accept connecting to it.\n\n\
     Hit 'Return' to continue"
