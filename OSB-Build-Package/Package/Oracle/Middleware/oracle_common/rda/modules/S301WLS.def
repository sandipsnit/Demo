# S301WLS.def: Collects Oracle WebLogic Server Information
# $Id: S301WLS.def,v 2.11 2012/01/03 13:34:45 mschenke Exp $
# ARCS: $Header: /home/cvs/cvs/RDA_4/src/scripting/lib/modules/S301WLS.def,v 2.11 2012/01/03 13:34:45 mschenke Exp $
#
# Change History
# 20120103  MSC  Change the copyright notice.

=head1 NAME

S301WLS - Collects Oracle WebLogic Server Information

=head1 DESCRIPTION

This module collects Oracle WebLogic Server-related information. The module
covers Oracle WebLogic Server Release 9.x and 10.x.

It includes all reports produced by the WREQ module for the specified Oracle
WebLogic Server domains under C<Oracle WebLogic Server>.

=cut

echo tput('bold'),'Processing Oracle WebLogic Server module ...',tput('off')

# Identify the domains per Oracle WebLogic Server home
var (@orp,%dom,%nam,%top) = ()
loop $key (grepSetting('^WLS_DOM\d+_REQ_DOMAIN$'))
{var $tid = substr($key,0,-11)
 var $dom = getSetting($key)
 next !testDir('d',$dom)

 if missing($dom{$dom})
  var $dom{$dom} = addTarget('DOM_Req$$',{DOMAIN_HOME   =>$dom,\
                                          MISSING_HOME  =>1,\
                                          MISSING_COMMON=>1})
 if and(defined($par = $dom{$dom}->get_wl_home),\
        testDir('d',$par->get_info('wlh')))
  call push($top{$par->get_info('oid')},$tid)
 else
  call push(@orp,$tid)
 var $nam{$tid} = basename(catDir($dom))
}

# Report the domains per Oracle WebLogic Server home
var $cnt = 0
loop $oid (keys(%top))
{var ($flg,$tid) = ($cnt,replace($top{$oid}->[0],'_DOM','_TOP'))
 incr $cnt
 if $flg
  toc '%PUSH("0:   * Oracle WebLogic Server ',$cnt,'")%'
 else
  toc '%PUSH("0:   * Oracle WebLogic Server")%'
 toc '%PUSH("1+:Oracle WebLogic Server Overview")%'
 toc '%INCLUDE("',${CUR.GROUP},'_WREQ_',$tid,'.toc")%'
 toc '%POP%'
 loop $tid (@{$top{$oid}})
 {toc '%PUSH("%SPLIT%")%'
  toc '%PUSH("1+:',"'",$nam{$tid},"'",' Domain")%'
  toc '%INCLUDE("',${CUR.GROUP},'_WREQ_',$tid,'.toc")%'
  toc '%POP2%'
 }
 toc '%PUSH("%SPLIT%")%'
}
toc '%POP2%'

# Report domains that are not associated to a Oracle WebLogic Server home
pretoc '%PUSH("0:   * Orphan Domains")%'
loop $tid (@orp)
{toc '%PUSH("%SPLIT%")%'
 toc '%PUSH("1+:',"'",$nam{$tid},"'",' Domain")%'
 toc '%INCLUDE("',${CUR.GROUP},'_WREQ_',$tid,'.toc")%'
 toc '%POP2%'
}
if hasTocOutput(true)
 toc '%POP%'

=head1 SEE ALSO

L<S301WREQ.def|modules::S301WREQ>

=begin credits

=over 10

=item RDA 4.13: Greg Cook, Andrew Salt.

=item RDA 4.14: Greg Cook, Eric Gross, Andrew Salt.

=item RDA 4.15: Greg Cook, Eric Gross, Ari Kermaier, Andrew Salt, Christo Tonev.

=item RDA 4.16: Greg Cook, Sandhya Mohan, Babu Rallapalli, Andrew Salt.

=item RDA 4.17: Greg Cook, Adriana Dominguez, Bruce Irvin, Marcus Lachmanez,
Andrew Salt.

=item RDA 4.18: Greg Cook, Andrew Salt.

=item RDA 4.19: Greg Cook, Brad Donison, Meraj Mohammed, Daniel Mortimer,
Andrew Salt, Roelof Van Suilichem.

=item RDA 4.20: Greg Cook, Adriana Dominguez, Daniel Mortimer, Wes Root,
Andrew Salt.

=item RDA 4.21: Greg Cook, Tony Mitri, Eliane Papillon Le Noc, Andrew Salt,
Hector Viveros.

=back

=end credits

=head1 COPYRIGHT NOTICE

Copyright (c) 2002, 2012, Oracle and/or its affiliates. All rights reserved.

=head1 TRADEMARK NOTICE

Oracle and Java are registered trademarks of Oracle and/or its
affiliates. Other names may be trademarks of their respective owners.

=cut
