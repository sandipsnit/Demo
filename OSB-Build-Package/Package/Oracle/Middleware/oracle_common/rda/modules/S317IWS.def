# S317IWS.def: Collects Oracle iPlanet Web Server Information
# $Id: S317IWS.def,v 1.5 2012/01/03 13:34:45 mschenke Exp $
# ARCS: $Header: /home/cvs/cvs/RDA_4/src/scripting/lib/modules/S317IWS.def,v 1.5 2012/01/03 13:34:45 mschenke Exp $
#
# Change History
# 20120103  MSC  Change the copyright notice.

=head1 NAME

S317IWS - Collects Oracle iPlanet Web Server Information

=head1 DESCRIPTION

This module collects information related to Oracle iPlanet Web Server,
formerly known as Sun Java System Web Server. The module covers Oracle iPlanet
Web Server Release 6.x and later.

The following reports can be generated and are regrouped under
C<iPlanet Web Server>:

=cut

echo tput('bold'),'Processing IWS module ...',tput('off')

# Initialization
var $INS_HOME = getSetting('IWS_INSTANCE_HOME','')
var $IWS_HOME = getSetting('IWS_HOME','')
var $TAIL     = getSetting('RDA_TAIL',1000)

var $TOC = '%TOC%'
var $TOP = '[[#Top][Back to top]]'
pretoc '1:iPlanet Web Server'

# Load the common macros
run library()

=head1 IPLANET WEB SERVER INFORMATION

=head2 version_info - Version Information

Gathers Oracle iPlanet Web Server version information.

=cut

debug ' Inside IWS module, gathering version information'
pretoc '2:Server Information'
if testFile('fx',catFile($IWS_HOME,'bin',${AS.EXE:'wadm'}))
 var $cmd = concat(lastCommand(),' --version')
elsif testFile('fx',catFile($IWS_HOME,'bin','https','bin',${AS.EXE:'webservd'}))
 var $cmd = concat(lastCommand(),' -v')
else
 var $cmd = undef
if ?$cmd
{report version_info
 prefix
 {write '---+ Oracle iPlanet Web Server Version Information'
  write '---## Using: ',encode($cmd)
 }
 call writeCommand(concat($cmd,' 2>&1'))
 if isCreated(true)
  toc '3:[[',getFile(),'][rda_report][Version Information]]'
}

=head2 Configuration Files

Gathers Administration Server-related configuration files.

=cut

if testDir('d',$IWS_HOME)
{debug ' Inside IWS module, collecting the admin configuration files'
 pretoc '3:Configuration Files'
 call sort_files(4,0,\
  grepDir(catDir($IWS_HOME,'admin-server','config'),'^\.+$','pv'),\
  grepDir(catDir($IWS_HOME,'https-admserv','config'),'^\.+$','pv'),\
  grepDir(catDir($IWS_HOME,'httpacl'),'^\.+$','pv'))
 unpretoc

=head2 Log Files

Gathers Administration Server-related log files.

=cut

 debug ' Inside IWS module, collecting the admin log files'
 pretoc '3:Log Files'
 call sort_files(4,$TAIL,\
  grepDir(catDir($IWS_HOME,'admin-server','logs'),'^\.+$','pv'),\
  grepDir(catDir($IWS_HOME,'https-admserv','logs'),'^\.+$','pv'))
 unpretoc
}
unpretoc

=head1 WEB SERVER INSTANCE INFORMATION

=head2 Configuration Files

Gathers Web Server instance-related configuration files.

=cut

if testDir('d',$INS_HOME)
{debug ' Inside IWS module, collecting the instance configuration files'
 pretoc '2:Instance Information'
 pretoc '3:Configuration Files'
 call sort_files(4,0,grepDir(catDir($INS_HOME,'config'),'^\.+$','pv'))
 unpretoc

=head2 Log Files

Gathers Web Server instance-related log files.

=cut

 debug ' Inside IWS module, collecting the instance log files'
 pretoc '3:Log Files'
 call sort_files(4,$TAIL,grepDir(catDir($INS_HOME,'logs'),'^\.+$','pv'))
 unpretoc 2
}

unpretoc

=head1 SEE ALSO

L<library.def|modules::library>

=begin credits

=over 10

=item RDA 4.26: Jeff Brown.

=back

=end credits

=head1 COPYRIGHT NOTICE

Copyright (c) 2002, 2012, Oracle and/or its affiliates. All rights reserved.

=head1 TRADEMARK NOTICE

Oracle and Java are registered trademarks of Oracle and/or its
affiliates. Other names may be trademarks of their respective owners.

=cut
