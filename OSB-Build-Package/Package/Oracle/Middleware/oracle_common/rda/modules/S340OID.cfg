# S340OID.cfg: Collects Oracle Internet Directory Information
# $Id: S340OID.cfg,v 2.16 2012/01/02 17:25:17 mschenke Exp $
# ARCS: $Header: /home/cvs/cvs/RDA_4/src/scripting/lib/modules/S340OID.cfg,v 2.16 2012/01/02 17:25:17 mschenke Exp $
#
# Copyright (c) 2002, 2012, Oracle and/or its affiliates. All rights reserved.
#
# Change history
# 20120102  MSC  Change the copyright notice.

###############################################################################
# Collect Oracle Internet Directory setup information
###############################################################################

#------------------------------------------------------------------------------
# Module definition
#------------------------------------------------------------------------------
col=${INTERNET_DIRECTORY_IN_USE}
dsc="Collects Oracle Internet Directory Information"
env=ORACLE_INSTANCE
exe=ASITcfg
req=S000INI,*?OID_REQ_WREQ:S301WREQ,*?OID_REQ_IREQ:S313IREQ
rpt=INTERNET_DIRECTORY_IN_USE
trg=?OID_REQ_WREQ:S301WREQ,?OID_REQ_IREQ:S313IREQ
ttl="Oracle Product Settings"
var=check_internet_directory

#------------------------------------------------------------------------------
# Setting definitions
#------------------------------------------------------------------------------
[check_internet_directory]
typ=D
alt=no_internet_directory
dft="${ORACLE_HOME}/ldap"
nam=-
var=INTERNET_DIRECTORY_IN_USE

[no_internet_directory]
typ=B
dft=0
dsc="Is OID in use?"
nam=INTERNET_DIRECTORY_IN_USE

[INTERNET_DIRECTORY_IN_USE]
typ=B
dft="<<COND:SELECTED_MODULE,1,RDA_DEFAULT,1,0"
dsc="Is OID in use?"
inp="Is Oracle Internet Directory used in this Oracle home (Y/N)?"
var=get_install,OID_DIAG

[get_install]
typ=P
alt=check_rcu
dft="product"
dsc="Installation Type"
nam=-TMP_INSTALL
var=check_install

[check_install]
typ=I
alt=check_rcu
dft="match:TMP_INSTALL:^Oracle Identity Management 11g"
dsc="Check for AS 11g install"
nam=-
var=check_profile

[check_rcu]
typ=D
alt=check_sid
dft=${ORACLE_HOME}/rcu
dsc="Oracle home rcu directory"
nam=-
var=check_profile

[check_profile]
typ=B
alt=force_primary
dft=${ofm_profile}
dsc="Is it a profile based collection?"
nam=-
var=set_primary

[force_primary]
typ=B
dft=1
dsc="Is OID the primary module?"
nam=OID_PRIMARY
var=OID_CH_REQ_COMMON,oid_instance_root,OID_DOM_REQ_DOMAIN

[set_primary]
typ=B
dft=${oid_primary}
dsc="Is OID the primary module?"
nam=OID_PRIMARY
var=OID_CH_REQ_COMMON,oid_instance_root,OID_DOM_REQ_DOMAIN

#------------------------------------------------------------------------------
# Setting definitions for common home
#------------------------------------------------------------------------------
[OID_CH_REQ_COMMON]
typ=D
alt=missing
dft="${ORACLE_HOME}/../oracle_common"
dsc="Common Product home"
var=oid_ch_focus,oid_req_ireq

[oid_ch_focus]
typ=T
dft="Manifest"
dsc="Focus areas for WebLogic common home collection"
nam=OID_CH_FOCUS

#------------------------------------------------------------------------------
# Setting definitions for Oracle Instance
#------------------------------------------------------------------------------
[oid_instance_root]
typ=D
alt=chk_oracle_instance,OID_INSTANCE_ROOT
dft=${INSTANCE_ROOT}
dsc="Instance root directory"
nam=OID_INSTANCE_ROOT
var=chk_instances

[chk_oracle_instance]
typ=I
dft="exists:ORACLE_INSTANCE"
dsc="Check the ORACLE_INSTANCE environment variable existence"
nam=-
var=dft_instance_root

[dft_instance_root]
typ=D
dft="${ENV.ORACLE_INSTANCE}/.."
dsc="Default instance root directory"
nam=-TMP_INSTANCE_ROOT

[OID_INSTANCE_ROOT]
typ=D
dft=${TMP_INSTANCE_ROOT}
dsc="Instance root directory"
err="Warning: The specified directory does not -yet- exist"
inp="Enter the location of the directory containing the instance homes to \
     analyze (For example the parent directory of the path specified by an \
     ORACLE_INSTANCE environment variable)"
var=chk_instances

[chk_instances]
typ=B
alt=oid_comment
dft=0
dsc="Get the directories present in the instance root directory"
exe=chk_instances
nam=-
var=oid_instances,set_loop,oid_tnsadmin_list,oid_req_ireq

[oid_comment]
typ=C
dsc="Report bad Oracle instance root directory"
inp="The specified Oracle instance root directory is either invalid or does \
     not contain some Oracle OID instance related-files. \
     Collection will not contain complete instance data.\n\n\
     Hit 'Return' to continue"

#------------------------------------------------------------------------------
# Select instances
#------------------------------------------------------------------------------
[oid_instances]
typ=M
add="*|All instances|*|all_instances"
bef="Instance list:"
col=1
dft="${TMP_DFT_INSTANCES}"
dsc="Instance list"
dup="Instance already selected"
end="."
err="Enter a menu item number only"
inp="Enter the number corresponding to the instance directory name, or * to \
     select all instances, or ${end} to terminate the list"
itm="${TMP_ITM_INSTANCES}"
mnu="<<I"
nam=OID_INSTANCES
one="*"
rsp="${TMP_RSP_INSTANCES}"
sep="|"
val=E

[all_instances]
typ=T
dft=${TMP_ALL_INSTANCES}
dsc="List all instances"
nam=-OID_INSTANCES

[set_loop]
typ=L
dft="${OID_INSTANCES}"
dsc="Examine all directories"
nam=-cnt
sep="|"
var=set_req_instance

[set_req_instance]
typ=D
dft="${OID_OI${cnt}_REQ_INSTANCE}"
dsc="Instance ${cnt}"
nam=OID_OI${cnt}_REQ_INSTANCE
var=set_oh_focus,set_oi_focus,chk_tnsadmin_list

[set_oh_focus]
typ=T
dft="HTTP,Manifest,OID,OPMN"
dsc="Focus areas for Oracle home associated to the instance home"
nam=OID_OH${cnt}_FOCUS

[set_oi_focus]
typ=T
dft="HTTP,OID,OPMN"
dsc="Focus areas for instance home"
nam=OID_OI${cnt}_FOCUS

[chk_tnsadmin_list]
typ=I
dft="join:TMP_TNSADMIN_LIST:${OID_OI${cnt}_REQ_INSTANCE}/config"
dsc="List of extra TNS_ADMIN directories"
nam=-TMP_TNSADMIN_LIST

[oid_tnsadmin_list]
typ=D
dft=${TMP_TNSADMIN_LIST}
dsc="List of extra TNS_ADMIN directories"
nam=OID_TNSADMIN_LIST
sep="|"

[oid_req_ireq]
typ=B
dft=1
dsc="Does OID require Oracle Instance Request Handler collection?"
nam=OID_REQ_IREQ

#------------------------------------------------------------------------------
# Setting definitions for Oracle WebLogic
#------------------------------------------------------------------------------
[OID_DOM_REQ_DOMAIN]
typ=D
dft=${ENV.DOMAIN_HOME}
dsc="Oracle WebLogic server domain home"
err="Warning: The specified directory does not -yet- exist"
inp="Enter the Oracle WebLogic Server domain home to be used for data analysis"
val=W
var=chk_servers,oid_top_focus,oid_dom_focus,oid_req_wreq

[chk_servers]
typ=B
alt=missing
dft=0
dsc="Check which server homes are present in the domain home directory"
exe=chk_servers
nam=-
var=oid_wls_servers

[missing]
typ=B
dsc="Used to reject settings"
nam=-

#------------------------------------------------------------------------------
# Select the server(s)
#------------------------------------------------------------------------------
[oid_wls_servers]
typ=M
add="*|All servers|*|all_servers"
bef="Oracle WebLogic Server list:"
dft="${TMP_DFT_SERVERS}"
dsc="Server list"
dup="Server already selected"
end="."
err="Enter a menu item number only"
inp="Enter the number corresponding to the server directory name, or * to \
     select all servers, or ${end} to terminate the list"
itm="${TMP_ITM_SERVERS}"
mnu="<<I"
nam=OID_DOM_WLS_SERVERS
one="*"
rsp="^"
sep="|"
val=E

[all_servers]
typ=T
dft=${TMP_ALL_SERVERS}
dsc="List all servers"
nam=OID_DOM_WLS_SERVERS

[oid_top_focus]
typ=T
dft="Generic,Manifest"
dsc="Focus areas for Oracle WebLogic home collection"
nam=OID_TOP_FOCUS

[oid_dom_focus]
typ=T
dft="ExtDomCfg,ExtSrvCfg,MinDomCfg,MinSrvCfg,OID"
dsc="Focus areas for Oracle WebLogic domain collection"
nam=OID_DOM_FOCUS

[oid_req_wreq]
typ=B
dft=1
dsc="Does OID require Oracle WebLogic Request Handler collection?"
nam=OID_REQ_WREQ

#------------------------------------------------------------------------------
# Setting definitions for version prior 11g
#------------------------------------------------------------------------------
[check_sid]
typ=I
alt=oid_local
dft="exists:ORACLE_SID"
dsc="Check if ORACLE_SID is defined"
nam=-
var=OID_LOCAL

[oid_local]
typ=B
alt=OID_SID
dft=0
dsc="Is the OID schema stored in the database to be analyzed?"
nam=OID_LOCAL

[OID_LOCAL]
typ=B
alt=OID_SID
dft=1
dsc="Is the OID schema stored in the database to be analyzed?"
inp="Is the OID schema stored in the '${ORACLE_SID}' database (Y/N)?"

[OID_SID]
typ=T
clr='-'
dft=''
dsc="Database SID"
err="Database SID should not contain any space"
inp="Enter the OID database SID. If you do not want RDA to collect \
     information from the database, then enter a dash ('${clr}')."
ref="^(|\S+)$"
val=E

#------------------------------------------------------------------------------
# Common setting definitions
#------------------------------------------------------------------------------
[OID_DIAG]
typ=B
dft=1
dsc="Is the output of the oiddiag command requested?"
inp="Do you want RDA to collect the output of the oiddiag command (Y/N)?"
hlp="oiddiag command execution can hang. If you face a hang during RDA data \
     collection, you must rerun the setup and disable the oiddiag execution."
var=check_sid_format,OID_DB_HOST,OID_DB_PORT,OID_SERVICE_NAME

[check_sid_format]
typ=I
dft="match:OID_SID:^[^:]+\:\d+\:[^:]*\:.*$"
dsc="Check the sid format"
nam=-
var=tmp_db_host,tmp_db_port,tmp_service_name

[tmp_db_host]
typ=I
dft="re:OID_SID:1:^([^:]+)\:\d+\:[^:]*\:.*$"
dsc="Database host name"
nam=-TMP_DB_HOST

[tmp_db_port]
typ=I
dft="re:OID_SID:1:^[^:]+\:(\d+)\:[^:]*\:.*$"
dsc="Database listener port number"
nam=-TMP_DB_PORT

[tmp_service_name]
typ=I
dft="re:OID_SID:1:^[^:]+\:\d+\:[^:]*\:(.*)$"
dsc="Database Service Name"
nam=-TMP_SERVICE_NAME

[OID_DB_HOST]
typ=T
dft=${TMP_DB_HOST:${RDA.HOST}}
dsc="Database host name"
err="Fully domain-qualified database host name cannot be null and should not \
     contain any space"
inp="Enter the fully domain-qualified database host name"
ref="^\S+$"
val=E

[OID_DB_PORT]
typ=N
dft=${TMP_DB_PORT:1521}
dsc="Database listener port number"
inp="Enter the database listener port number"

[OID_SERVICE_NAME]
typ=T
dft=${TMP_SERVICE_NAME}
dsc="Database Service Name"
err="Database service name cannot be null and should not contain any space"
inp="Enter the database service name"
hlp="oiddiag expects the database service name instead of the database system \
     identifier. Depending on the configuration, it could require a fully \
     qualified service name. You can often retrieve the information from the \
     tnsnames.ora file or by running a tnsping command. When the listener \
     is configured on the local system, you can retrieve the information by \
     running 'lsnrctl status' or 'lsnrctl services' commands."
ref="^\S+$"
val=E
