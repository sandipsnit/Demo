# S374BAM.cfg: Collects Business Activity Monitoring Information
# $Id: S374BAM.cfg,v 2.10 2012/01/02 17:25:17 mschenke Exp $
# ARCS: $Header: /home/cvs/cvs/RDA_4/src/scripting/lib/modules/S374BAM.cfg,v 2.10 2012/01/02 17:25:17 mschenke Exp $
#
# Copyright (c) 2002, 2012, Oracle and/or its affiliates. All rights reserved.
#
# Change history
# 20120102  MSC  Change the copyright notice.

###############################################################################
# Collect the Business Activity Monitoring setup information
###############################################################################

#------------------------------------------------------------------------------
# Module definition
#------------------------------------------------------------------------------
col=${BAM_IN_USE}
dsc="Collects Business Activity Monitoring Information"
env=DOMAIN_HOME
exe=WLSsetup
req=S000INI,*?BAM_REQ_WREQ:S301WREQ,*?BAM_REQ_IREQ:S313IREQ
rpt=BAM_IN_USE
trg=?BAM_REQ_WREQ:S301WREQ,?BAM_REQ_IREQ:S313IREQ
ttl="Oracle Product Settings"
var=force_bam_tests

#------------------------------------------------------------------------------
# Setting definitions
#------------------------------------------------------------------------------
[force_bam_tests]
typ=B
alt=BAM_IN_USE
dft=0
dsc="Are the BAM tests required by the profile?"
nam=-
var=bam_in_use

[bam_in_use]
typ=B
dft=1
dsc="Is BAM information requested?"
nam=BAM_IN_USE
var=BAM_DISTINCT_HOME,BAM_AGE

[BAM_IN_USE]
typ=B
dft="<<COND:SELECTED_MODULE,1,RDA_DEFAULT,1,0"
dsc="Is BAM information requested?"
inp="Is Business Activity Monitoring (BAM) in use (Y/N)?"
var=BAM_DISTINCT_HOME,BAM_AGE

[BAM_DISTINCT_HOME]
typ=B
alt=bam_oracle_home,check_rcu
dft=1
dsc="Is BAM installed in another Oracle home?"
inp="Is BAM installed in an Oracle home other than '${ORACLE_HOME}' (Y/N)?"
var=BAM_ORACLE_HOME,BAM_INTERIM,check_rcu

[BAM_ORACLE_HOME]
typ=D
dsc="BAM Oracle home"
err="Warning: The specified directory does not -yet- exist"
inp="Enter the BAM Oracle home to be analyzed"
val=W

[BAM_INTERIM]
typ=B
dft=0
dsc="Collect the file/directory list for the interim patches"
inp="Do you want to collect the file and directory list for the interim \
     patches in inventory (Y/N)?"
lvl=1

[bam_oracle_home]
typ=D
dft=${ORACLE_HOME}
dsc="BAM Oracle home"
nam=BAM_ORACLE_HOME

[check_rcu]
typ=D
alt=check_soa_home
dft=${BAM_ORACLE_HOME}/rcu
dsc="Oracle home rcu directory"
nam=-
var=check_bam_home

[check_soa_home]
typ=D
alt=bam_home1,BAM_ROOT_DIR,bam_log1,BAM_LOG_DIR
dft=${BAM_ORACLE_HOME}/soa
dsc="Oracle SOA home"
nam=-
var=check_bam_home

[check_bam_home]
typ=D
alt=bam_home1,BAM_ROOT_DIR,bam_log1,BAM_LOG_DIR
dft=${BAM_ORACLE_HOME}/bam
dsc="Oracle BAM home"
nam=-
var=BAM_CH_REQ_COMMON,exist_domain,bam_domain_root

#------------------------------------------------------------------------------
# Setting definitions for common home
#------------------------------------------------------------------------------
[BAM_CH_REQ_COMMON]
typ=D
alt=missing
dft="${BAM_ORACLE_HOME}/../oracle_common"
dsc="Common Product home"
var=bam_ch_focus,bam_req_ireq

[bam_ch_focus]
typ=T
dft="Manifest"
dsc="Focus areas for common home collection"
nam=BAM_CH_FOCUS

[bam_req_ireq]
typ=B
dft=1
dsc="Does BAM require Oracle Instance Request Handler collection?"
nam=BAM_REQ_IREQ

#------------------------------------------------------------------------------
# Setting definitions for Oracle WebLogic Server
#------------------------------------------------------------------------------
[exist_domain]
typ=I
dft="exists:DOMAIN_HOME"
dsc="Check if DOMAIN_HOME environment variable set"
nam=-
var=dft_domain_root

[dft_domain_root]
typ=D
dft="${DOMAIN_HOME}/.."
dsc="Default domain root directory"
nam=-TMP_DOM_ROOT

[bam_domain_root]
typ=D
dft=${BAM_DOMAIN_ROOT:${TMP_DOM_ROOT}}
dsc="Domain root directory"
err="Warning: The specified directory does not -yet- exist"
inp="Enter the location of the directory where the domains to analyze are \
     located (For example in UNIX, <BEA Home>/user_projects/domains or \
     <Middleware Home>/user_projects/domains)"
nam=BAM_DOMAIN_ROOT
val=W
var=chk_domains

[chk_domains]
typ=B
alt=edit_domain_root
dft=0
dsc="Check which domain homes are present in the domain root directory"
exe=chk_domains
nam=-
var=ask_domains,set_loop,bam_req_wreq

[edit_domain_root]
typ=B
alt=missing
dft=0
dsc="Do you want to modify the domain root location?"
inp="The specified domain root directory is either invalid or does not \
     contain some Oracle WebLogic Server related-files. The collection will \
     not contain Oracle WebLogic Server related information.\n\n\
     Do you want to modify the domain root path (Y/N)?"
nam=-
var=bam_domain_root

#------------------------------------------------------------------------------
# Select the domain(s)
#------------------------------------------------------------------------------
[ask_domains]
typ=M
add="*|All domains|*|all_domains"
bef="Domain list:"
dft="${TMP_DFT_DOMAINS}"
dsc="Domain list"
dup="Domain already selected"
end="."
err="Enter a menu item number only"
inp="Enter the number corresponding to the domain directory name, or * to \
     select all domains, or ${end} to terminate the list"
itm="${TMP_ITM_DOMAINS}"
mnu="<<I"
nam=BAM_DOMAINS
one="*"
rsp="${TMP_RSP_DOMAINS}"
sep="|"
val=E

[all_domains]
typ=T
dft=${TMP_ALL_DOMAINS}
dsc="List all domains"
nam=-BAM_DOMAINS

[set_loop]
typ=L
dft="${BAM_DOMAINS}"
dsc="Examine all directories"
nam=-TMP_CNT
sep="|"
var=get_dom_basename,set_req_domain

[get_dom_basename]
typ=T
dft="${BAM_DOM${TMP_CNT}}"
dsc="Domain name"
nam=-dom

[set_req_domain]
typ=D
dft="${BAM_DOM${TMP_CNT}_REQ_DOMAIN}"
dsc="Domain ${TMP_CNT}"
nam=BAM_DOM${TMP_CNT}_REQ_DOMAIN
var=chk_servers,bam_top_focus,bam_dom_focus

[chk_servers]
typ=B
alt=missing
dft=0
dsc="Check which server homes are present in the domain home directory"
exe=chk_servers
nam=-
var=bam_wls_servers,get_user,check_user

[missing]
typ=B
dsc="Used to reject settings"
nam=-

#------------------------------------------------------------------------------
# Select the server(s)
#------------------------------------------------------------------------------
[bam_wls_servers]
typ=M
add="*|All servers|*|all_servers"
bef="Oracle WebLogic Server list:"
dft="${TMP_DFT_SERVERS}"
dsc="Server list"
dup="Server already selected"
end="."
err="Enter a menu item number only"
inp="Enter the number corresponding to the server directory name, or * to \
     select all servers, or ${end} to terminate the list"
itm="${TMP_ITM_SERVERS}"
mnu="<<I"
nam=BAM_DOM${TMP_CNT}_WLS_SERVERS
one="*"
rsp="^"
sep="|"
val=E

[all_servers]
typ=T
dft=${TMP_ALL_SERVERS}
dsc="List all servers"
nam=BAM_DOM${TMP_CNT}_WLS_SERVERS

#------------------------------------------------------------------------------
# Identify the user
#------------------------------------------------------------------------------
[get_user]
typ=T
dsc="Get the Oracle WebLogic Server user name from configuration file"
exe=get_wls_user
nam=-TMP_BAM_WLS_USER

[check_user]
typ=I
alt=set_user2,set_last_user
dft="match:TMP_BAM_WLS_USER:\S"
dsc="Check whether the Oracle WebLogic user is specified"
nam=-
var=set_user1,set_last_user

[set_user1]
typ=T
clr=-
dft=${BAM_DOM${TMP_CNT}_WLS_USER:${TMP_LAST_USER:${TMP_BAM_WLS_USER}}}
dsc="Oracle WebLogic Server user name for domain ${TMP_CNT}"
err="The user name should not contain spaces"
inp="Enter the user name for the Oracle WebLogic Server connection. If a dash \
     ('${clr}') is specified as input, default user name retrieved from \
     '${dom}' domain configuration file is considered."
lvl=1
nam=BAM_DOM${TMP_CNT}_WLS_USER
ref="^\S*$"
val=E

[set_user2]
typ=T
dft=${BAM_DOM${TMP_CNT}_WLS_USER:${TMP_LAST_USER}}
dsc="Oracle WebLogic Server user name for domain ${TMP_CNT}"
err="The user name should not contain spaces"
inp="Enter the user name for the Oracle WebLogic Server connection for \
     '${dom}' domain"
nam=BAM_DOM${TMP_CNT}_WLS_USER
ref="^\S+$"
val=E

[set_last_user]
typ=T
dft="${BAM_DOM${TMP_CNT}_WLS_USER}"
dsc="Last Oracle WebLogic Server user name entered"
nam=-TMP_LAST_USER

[bam_top_focus]
typ=T
dft="Generic,Manifest"
dsc="Focus areas for Oracle WebLogic Server Middleware collection"
nam=BAM_TOP${TMP_CNT}_FOCUS

[bam_dom_focus]
typ=T
dft="ExtDomCfg,ExtSrvCfg,MinDomCfg,MinSrvCfg,WLST"
dsc="Focus areas for Oracle WebLogic Server domain collection"
nam=BAM_DOM${TMP_CNT}_FOCUS

[bam_req_wreq]
typ=B
dft=1
dsc="Does BAM require Oracle WebLogic Server domain collection?"
nam=BAM_REQ_WREQ

#------------------------------------------------------------------------------
# Other settings
#------------------------------------------------------------------------------
[bam_home1]
typ=D
alt=bam_home2
dft=${BAM_ORACLE_HOME}/bam
dsc="BAM home directory"
nam=-BAM_HOME

[bam_home2]
typ=D
alt=bam_home3
dft=${BAM_ORACLE_HOME}/BAM
dsc="BAM home directory"
nam=-BAM_HOME

[bam_home3]
typ=D
dft="C:\OracleBAM\BAM"
dsc="BAM home directory"
nam=-BAM_HOME

[BAM_ROOT_DIR]
typ=D
dft=${BAM_HOME}
dsc="The root directory for Business Activity Monitoring collections"
err="Warning: The specified directory does not exist"
inp="Enter the absolute path of the root directory in which to collect BAM \
     event data"
val=W

[bam_log1]
typ=D
alt=bam_log2
dft=${BAM_ORACLE_HOME}/bam/logs
dsc="BAM log directory"
nam=-BAM_LOG_HOME

[bam_log2]
typ=D
alt=bam_log3
dft=${BAM_ORACLE_HOME}/Logs
dsc="BAM log directory"
nam=-BAM_LOG_HOME

[bam_log3]
typ=D
dft="C:\OracleBAM\Logs"
dsc="BAM log directory"
nam=-BAM_LOG_HOME

[BAM_LOG_DIR]
typ=D
dft=${BAM_LOG_HOME}
dsc="The directory for Diagnostic Log File collections"
err="Warning: The specified directory does not exist"
inp="Enter the absolute path of the directory in which to collect \
     diagnostic log file data"
val=W

#------------------------------------------------------------------------------
# Common setting definitions
#------------------------------------------------------------------------------
[BAM_AGE]
typ=N
dft=365
dsc="The maximum age of the BAM events to be collected"
inp="Specify the maximum age (in days) for the collected BAM events"
lvl=1
ref="R[0,["
val=F
