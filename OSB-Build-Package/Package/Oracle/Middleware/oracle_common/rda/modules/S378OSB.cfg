# S378OSB.cfg: Collects Oracle Service Bus Information
# $Id: S378OSB.cfg,v 1.10 2012/01/02 17:25:17 mschenke Exp $
# ARCS: $Header: /home/cvs/cvs/RDA_4/src/scripting/lib/modules/S378OSB.cfg,v 1.10 2012/01/02 17:25:17 mschenke Exp $
#
# Copyright (c) 2002, 2012, Oracle and/or its affiliates. All rights reserved.
#
# Change history
# 20120102  MSC  Change the copyright notice.

###############################################################################
# Collect Oracle Service Bus setup information
###############################################################################

#------------------------------------------------------------------------------
# Module definition
#------------------------------------------------------------------------------
col=${OSB_IN_USE}
dsc="Collects Oracle Service Bus Information"
env=DOMAIN_HOME
exe=WLSsetup
req=S000INI,*?OSB_REQ_WREQ:S301WREQ,*?OSB_REQ_IREQ:S313IREQ
rpt=OSB_IN_USE
trg=?OSB_REQ_WREQ:S301WREQ,?OSB_REQ_IREQ:S313IREQ
ttl="Oracle Product Settings"
var=force_osb_tests

#------------------------------------------------------------------------------
# Setting definitions
#------------------------------------------------------------------------------
[force_osb_tests]
typ=B
alt=OSB_IN_USE
dft=0
nam=-
var=osb_in_use

[osb_in_use]
typ=B
dft=1
dsc="Is Oracle Service Bus in use?"
nam=OSB_IN_USE
var=get_install

[OSB_IN_USE]
typ=B
dft="<<COND:SELECTED_MODULE,1,RDA_DEFAULT,1,0"
dsc="Is Oracle Service Bus in use?"
inp="Do you want RDA to collect Oracle Service Bus information (Y/N)?"
var=get_install

[get_install]
typ=P
alt=check_osb1
dft="product"
dsc="Installation Type"
nam=-TMP_INSTALL
var=check_install

[check_install]
typ=I
alt=check_osb1
dft="match:TMP_INSTALL:^Oracle Service Bus"
dsc="Check the installation type"
nam=-
var=osb_home

[check_osb1]
typ=D
alt=OSB_HOME
dft=${ORACLE_HOME}/..
dsc="Middleware home directory"
nam=-TMP_MW_HOME
var=check_osb2

[check_osb2]
typ=D
alt=OSB_HOME
dft="<<Search:TMP_MW_HOME:p:^(alsb|osb)_"
nam=-TMP_OSB_HOME
var=OSB_HOME,OSB_RUN_BSU

[no_osb]
typ=B
dft=0
dsc="Is Oracle Service Bus in use?"
nam=OSB_IN_USE

[OSB_RUN_BSU]
typ=B
dft=1
dsc="Smart update feature for OSB product home available?"

[osb_home]
typ=D
dft=${ORACLE_HOME}
dsc="Oracle Service Bus home directory"
nam=-TMP_OSB_HOME
var=OSB_HOME

[OSB_HOME]
typ=D
dft=${TMP_OSB_HOME}
dsc="Oracle Service Bus home directory"
err="The specified directory does not -yet- exist"
inp="Specify the Oracle Service Bus home directory"
val=E
var=check_osb3

[check_osb3]
typ=D
alt=no_osb
dft=${OSB_HOME}/..
nam=-TMP_MW_HOME
var=check_osb4

[check_osb4]
typ=F
alt=no_osb
dft=${TMP_MW_HOME}/registry.xml
nam=-
var=OSB_CH_REQ_COMMON,exist_domain,osb_domain_root

#------------------------------------------------------------------------------
# Setting definitions for common home
#------------------------------------------------------------------------------
[OSB_CH_REQ_COMMON]
typ=D
alt=missing
dft="${OSB_HOME}/../oracle_common"
dsc="Common Product home"
var=osb_ch_focus,osb_req_ireq

[osb_ch_focus]
typ=T
dft="Generic,Manifest"
dsc="Focus areas for common home collection"
nam=OSB_CH_FOCUS

[osb_req_ireq]
typ=B
dft=1
dsc="Does OSB require Oracle Instance Request Handler collection?"
nam=OSB_REQ_IREQ

#------------------------------------------------------------------------------
# Setting definitions for Oracle WebLogic Server
#------------------------------------------------------------------------------
[exist_domain]
typ=I
dft="exists:DOMAIN_HOME"
dsc="Check if DOMAIN_HOME environment variable set"
nam=-
var=dft_domain_root

[dft_domain_root]
typ=D
dft="${DOMAIN_HOME}/.."
dsc="Default domain root directory"
nam=-TMP_DOM_ROOT

[osb_domain_root]
typ=D
dft=${OSB_DOMAIN_ROOT:${TMP_DOM_ROOT}}
dsc="Domain root directory"
err="Warning: The specified directory does not -yet- exist"
inp="Enter the location of the directory where the domains to analyze are \
     located (For example in UNIX, <BEA Home>/user_projects/domains or \
     <Middleware Home>/user_projects/domains)"
nam=OSB_DOMAIN_ROOT
val=W
var=chk_domains

[chk_domains]
typ=B
alt=edit_domain_root
dft=0
dsc="Check which domain homes are present in the domain root directory"
exe=chk_domains
nam=-
var=ask_domains,set_loop,osb_req_wreq

[edit_domain_root]
typ=B
dft=0
dsc="Do you want to modify the domain root location?"
inp="The specified domain root directory is either invalid or does not \
     contain some Oracle WebLogic Server related-files. The collection will \
     not contain Oracle WebLogic Server related information.\n\n\
     Do you want to modify the domain root path (Y/N)?"
nam=-
var=osb_domain_root

#------------------------------------------------------------------------------
# Select the domain(s)
#------------------------------------------------------------------------------
[ask_domains]
typ=M
add="*|All domains|*|all_domains"
bef="Domain list:"
dft="${TMP_DFT_DOMAINS}"
dsc="Domain list"
dup="Domain already selected"
end="."
err="Enter a menu item number only"
inp="Enter the number corresponding to the domain directory name, or * to \
     select all domains, or ${end} to terminate the list"
itm="${TMP_ITM_DOMAINS}"
mnu="<<I"
nam=OSB_DOMAINS
one="*"
rsp="${TMP_RSP_DOMAINS}"
sep="|"
val=E

[all_domains]
typ=T
dft=${TMP_ALL_DOMAINS}
dsc="List all domains"
nam=-OSB_DOMAINS

[set_loop]
typ=L
dft="${OSB_DOMAINS}"
dsc="Examine all directories"
nam=-TMP_CNT
sep="|"
var=get_dom_basename,set_req_domain

[get_dom_basename]
typ=T
dft="${OSB_DOM${TMP_CNT}}"
dsc="Domain name"
nam=-dom

[set_req_domain]
typ=D
dft="${OSB_DOM${TMP_CNT}_REQ_DOMAIN}"
dsc="Domain ${TMP_CNT}"
nam=OSB_DOM${TMP_CNT}_REQ_DOMAIN
var=chk_servers,osb_top_focus,osb_dom_focus

[chk_servers]
typ=B
alt=missing
dft=0
dsc="Check which server homes are present in the domain home directory"
exe=chk_servers
nam=-
var=osb_servers,get_user,check_user

[missing]
typ=B
dsc="Used to reject settings"
nam=-

#------------------------------------------------------------------------------
# Select the server(s)
#------------------------------------------------------------------------------
[osb_servers]
typ=M
add="*|All servers|*|all_servers"
bef="Oracle WebLogic Server list for '${dom}' Domain:"
dft="${TMP_DFT_SERVERS}"
dsc="Server list for Domain ${TMP_CNT}"
dup="Server already selected"
end="."
err="Enter a menu item number only"
inp="Enter the number corresponding to the server directory name, or * to \
     select all servers, or ${end} to terminate the list"
itm="${TMP_ITM_SERVERS}"
mnu="<<I"
nam=OSB_DOM${TMP_CNT}_WLS_SERVERS
one="*"
rsp="^"
sep="|"
val=E

[all_servers]
typ=T
dft=${TMP_ALL_SERVERS}
dsc="List all servers"
nam=OSB_DOM${TMP_CNT}_WLS_SERVERS

#------------------------------------------------------------------------------
# Identify the user
#------------------------------------------------------------------------------
[get_user]
typ=T
dsc="Get the Oracle WebLogic Server user name from configuration file"
exe=get_wls_user
nam=-TMP_OSB_WLS_USER

[check_user]
typ=I
alt=set_user2,set_last_user
dft="match:TMP_OSB_WLS_USER:\S"
dsc="Check whether the Oracle WebLogic user is specified"
nam=-
var=set_user1,set_last_user

[set_user1]
typ=T
clr=-
dft=${OSB_DOM${TMP_CNT}_WLS_USER:${TMP_LAST_USER:${TMP_OSB_WLS_USER}}}
dsc="Oracle WebLogic Server user name for domain ${TMP_CNT}"
err="The user name should not contain spaces"
inp="Enter the user name for the Oracle WebLogic Server connection. If a dash \
     ('${clr}') is specified as input, default user name retrieved from \
     '${dom}' domain configuration file is considered."
lvl=1
nam=OSB_DOM${TMP_CNT}_WLS_USER
ref="^\S*$"
val=E

[set_user2]
typ=T
dft=${OSB_DOM${TMP_CNT}_WLS_USER:${TMP_LAST_USER}}
dsc="Oracle WebLogic Server user name for domain ${TMP_CNT}"
err="The user name should not contain spaces"
inp="Enter the user name for the Oracle WebLogic Server connection for \
     '${dom}' domain"
nam=OSB_DOM${TMP_CNT}_WLS_USER
ref="^\S+$"
val=E

[set_last_user]
typ=T
dft="${OSB_DOM${TMP_CNT}_WLS_USER}"
dsc="Last Oracle WebLogic Server user name entered"
nam=-TMP_LAST_USER

[osb_top_focus]
typ=T
dft="Generic,Manifest"
dsc="Focus areas for Oracle WebLogic Server Middleware collection"
nam=OSB_TOP${TMP_CNT}_FOCUS

[osb_dom_focus]
typ=T
dft="ASA,ExtDomCfg,ExtSrvCfg,MinDomCfg,MinSrvCfg,OSB,OWSM,WLST"
dsc="Focus areas for Oracle WebLogic Server domain collection"
nam=OSB_DOM${TMP_CNT}_FOCUS

[osb_req_wreq]
typ=B
dft=1
dsc="Does OSB require Oracle WebLogic Request Handler collection?"
nam=OSB_REQ_WREQ
