# S555HIR.def: Collects Oracle Hyperion Interactive Reporting Information
# $Id: S555HIR.def,v 1.3 2012/01/03 13:34:47 mschenke Exp $
# ARCS: $Header: /home/cvs/cvs/RDA_4/src/scripting/lib/modules/S555HIR.def,v 1.3 2012/01/03 13:34:47 mschenke Exp $
#
# Change History
# 20120103  MSC  Change the copyright notice.

=head1 NAME

S555HIR - Collects Oracle Hyperion Interactive Reporting Information

=head1 DESCRIPTION

This module collects information for Oracle Hyperion Interactive Reporting.

The following reports can be generated and are regrouped under C<Hyperion
Interactive Reporting>:

=cut

echo tput('bold'),'Processing HIR module ...',tput('off')

# Initialization
var $EPM_HOME     = ${EPM_HOME:${ENV.EPM_ORACLE_HOME:${ENV.HYPERION_HOME:''}}}
var $HIR_REQUESTS = ${HIR_REQUESTS}

var $TOC = '%TOC%'
var $TOP = '[[#Top][Back to top]]'

pretoc '1:Hyperion Interactive Reporting'

=head2 registry - ODBC Registry Information

For Windows, collects system ODBC Registry information.

=cut

if or(isWindows(),isCygwin())
{debug ' Inside HIR module, gathering registry information'
 report registry
 write '---+!! ODBC Registry Information'
 write $TOC
 call writeRegistry('HKLM\SOFTWARE\ODBC')
 toc '2:[[',getFile(),'][rda_report][Registry Information]]'
}

=head2 Oracle WebLogic Server Information

Includes the Oracle WebLogic Server reports generated by the WREQ module for
the associated Oracle WebLogic Server domain (on versions having a product
registry).

=cut

if ?$HIR_REQUESTS
{loop $uid (split('\|',$HIR_REQUESTS))
 {next !$uid
  var $ins = getSetting(concat('HIR_HOME',$uid))
  call setAbbr(concat('HIR_i',$uid))
  toc '%SPLIT%'
  toc "1+:'",getSetting(concat('HIR_INSTANCE',$uid)),"' Deployment"
  if ?getSetting(concat('HIR_DOM',$uid,'_REQ_DOMAIN'))
  {var $dom = basename(last)
   toc '%PUSH("%SPLIT%")%'
   toc '%PUSH("1++:Oracle WebLogic Server Overview")%'
   toc '%INCLUDE("',${CUR.GROUP},'_WREQ_HIR_TOP',$uid,'.toc",1)%'
   toc '%POP2%'
   toc '%PUSH("%SPLIT%")%'
   toc '%PUSH("1++:',"'",$dom,"'",' Domain")%'
   toc '%INCLUDE("',${CUR.GROUP},'_WREQ_HIR_DOM',$uid,'.toc",1)%'
   toc '%POP2%'
  }
  unpretoc 2
 }
}
elsif ?${HIR_DOM_REQ_DOMAIN}
{var $dom = basename(last)
 toc '%PUSH("%SPLIT%")%'
 toc '%PUSH("1+:Oracle WebLogic Server Overview")%'
 toc '%INCLUDE("',${CUR.GROUP},'_WREQ_HIR_TOP.toc")%'
 toc '%POP2%'
 toc '%PUSH("%SPLIT%")%'
 toc '%PUSH("1+:',"'",$dom,"'",' Domain")%'
 toc '%INCLUDE("',${CUR.GROUP},'_WREQ_HIR_DOM.toc")%'
 toc '%POP2%'
}
unpretoc

=begin credits

=over 10

=item RDA 4.23: Yun Kuo.

=back

=end credits

=head1 COPYRIGHT NOTICE

Copyright (c) 2002, 2012, Oracle and/or its affiliates. All rights reserved.

=head1 TRADEMARK NOTICE

Oracle and Java are registered trademarks of Oracle and/or its
affiliates. Other names may be trademarks of their respective owners.

=cut
