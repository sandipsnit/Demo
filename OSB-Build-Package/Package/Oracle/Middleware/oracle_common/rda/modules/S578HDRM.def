# S578HDRM.def: Collects Hyperion Data Relationship Management Information
# $Id: S578HDRM.def,v 1.9 2012/01/23 13:49:01 mschenke Exp $
# ARCS: $Header: /home/cvs/cvs/RDA_4/src/scripting/lib/modules/S578HDRM.def,v 1.9 2012/01/23 13:49:01 mschenke Exp $
#
# Change History
# 20120123  KRA  Use HKCU abbreviation.

=head1 NAME

S578HDRM - Collects Hyperion Data Relationship Management Information

=head1 DESCRIPTION

This module collects information for Hyperion Data Relationship Management. This
module is applicable for Microsoft Windows only.

The following reports can be generated and are regrouped under C<Hyperion
Data Relationship Management>:

=cut

echo tput('bold'),'Processing HDRM module ...',tput('off')

# Initialization
var $EPM_HOME      = ${EPM_HOME:${ENV.EPM_ORACLE_HOME:${ENV.HYPERION_HOME:''}}}
var $HDRM_REQUESTS = ${HDRM_REQUESTS}

var $TOC = '%TOC%'
var $TOP = '[[#Top][Back to top]]'

toc '1:Hyperion Data Relationship Management'

=head2 config - Configuration File

Gathers F<config.xml> from F<$EPM_HOME/Master Data Management> directory.

=cut

if testFile('fr',catFile($EPM_HOME,'Master Data Management','config.xml'))
{var $fil = lastFile()
 debug ' Inside HDRM module, getting configuration file'
 report config
 write '---+!! Configuration File'
 write '---## Information Taken from ',$fil
 call writeFile($fil)
 toc '2:[[',getFile(),'][rda_report][Configuration File]]'
}

=head2 registry - Registry Information

Collects Windows registry information.

=cut

debug ' Inside HDRM module, gathering registry information'
report registry
write '---+!! Registry Information'
write $TOC
write '---+ Install Values'
call writeRegistry(\
      'HKLM\SOFTWARE\Hyperion Solutions\Master Data Management\InstallValues')
write $TOP
write '---+ Master Data Management'
call writeRegistry('HKCU\Software\Hyperion Solutions\Master Data Management')
write $TOP
toc '2:[[',getFile(),'][rda_report][Registry Information]]'

=head2 Oracle WebLogic Server Information

Includes the Oracle WebLogic Server reports generated by the WREQ module for
the associated Oracle WebLogic Server domain (on versions having a product
registry).

=cut

if ?$HDRM_REQUESTS
{loop $uid (split('\|',$HDRM_REQUESTS))
 {next !$uid
  var $ins = getSetting(concat('HDRM_HOME',$uid))
  call setAbbr(concat('HDRM_i',$uid))
  toc '%SPLIT%'
  toc "1+:'",getSetting(concat('HDRM_INSTANCE',$uid)),"' Deployment"
  if ?getSetting(concat('HDRM_DOM',$uid,'_REQ_DOMAIN'))
  {var $dom = basename(last)
   toc '%PUSH("%SPLIT%")%'
   toc '%PUSH("1++:Oracle WebLogic Server Overview")%'
   toc '%INCLUDE("',${CUR.GROUP},'_WREQ_HDRM_TOP',$uid,'.toc",1)%'
   toc '%POP2%'
   toc '%PUSH("%SPLIT%")%'
   toc '%PUSH("1++:',"'",$dom,"'",' Domain")%'
   toc '%INCLUDE("',${CUR.GROUP},'_WREQ_HDRM_DOM',$uid,'.toc",1)%'
   toc '%POP2%'
  }
  unpretoc 2
 }
}
elsif ?${HDRM_DOM_REQ_DOMAIN}
{var $dom = basename(last)
 toc '%PUSH("%SPLIT%")%'
 toc '%PUSH("1+:Oracle WebLogic Server Overview")%'
 toc '%INCLUDE("',${CUR.GROUP},'_WREQ_HDRM_TOP.toc")%'
 toc '%POP2%'
 toc '%PUSH("%SPLIT%")%'
 toc '%PUSH("1+:',"'",$dom,"'",' Domain")%'
 toc '%INCLUDE("',${CUR.GROUP},'_WREQ_HDRM_DOM.toc")%'
 toc '%POP2%'
}

=begin credits

=over 10

=item RDA 4.21: Michael Berte, Yun Kuo.

=back

=end credits

=head1 COPYRIGHT NOTICE

Copyright (c) 2002, 2012, Oracle and/or its affiliates. All rights reserved.

=head1 TRADEMARK NOTICE

Oracle and Java are registered trademarks of Oracle and/or its
affiliates. Other names may be trademarks of their respective owners.

=cut
