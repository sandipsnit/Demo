# TLsecure.def: Identifies Potential Security Risks
# $Id: TLsecure.def,v 2.11 2012/04/25 07:03:57 mschenke Exp $
# ARCS: $Header: /home/cvs/cvs/RDA_4/src/scripting/lib/modules/TLsecure.def,v 2.11 2012/04/25 07:03:57 mschenke Exp $
#
# Change History
# 20120423  MSC  Improve the credential management.

=head1 NAME

TLsecure - Identifies Potential Security Risks

=head1 DESCRIPTION

This tool performs checks to identify potential security risks. Most checks 
come from the Oracle Technology Network article C<Project Lockdown> available
at the following URL:
F<http://www.oracle.com/technetwork/articles/index-087388.html>.
This tool does not incorporate all of the checks and additional checks may be
implemented in future releases.

=cut


=head1 USAGE

This tool can be used in two ways:

=over 3

=item a)

Runs interactively. It requests the user to enter the required information.

<rda> -vT secure

=item b)

Runs from the command line. The input can be given in the command line using
the following syntax:

<rda> -vT secure:<opt1>[,<opt2>[,...]]

=back

The tool generates a report with findings.

=cut

# Initialisation
var $ORACLE_HOME = getSetting('ORACLE_HOME',getEnv('ORACLE_HOME',''))
var $ORACLE_SID  = getSetting('ORACLE_SID',getEnv('ORACLE_SID',''))
var $DBVER       = undef

var $TOC = '%TOC%'
var $TOP = '[[#Top][Back to top]]'

# Load the common library
run DBinfo()

# Set the current login and load passwords
macro get_login_info
{import $ORACLE_SID

 debug ' Inside TLsecure module, getting login information'
 if !defined($ORACLE_SID)
  call setSqlSid($ORACLE_SID)
 if !?getSetting('SQL_LOGIN')
  call setSqlLogin('','','',true)
 call setSqlError(false)
}

#------------------------------------------------------------------------------
# Database Checks
#------------------------------------------------------------------------------

=head2 D_DP - Users with a Default Password

Checks the existence of users with a default password (Oracle Database 11g and
later).

=cut

macro DB_default_pwd
{import $DBVER,$TOP

 debug ' Inside TLsecure module, checking for users with a default password'
 write '---+ List of Users with a Default Password'
 if match($DBVER,'^11')
 {prefix
   write '|*User Name*|*Comment*|'

  set $sql
  {SELECT DISTINCT '|' || u.name || ' |' ||
  "      DECODE (u.astatus,8,'LOCKED',9,'LOCKED',10,'LOCKED','-') || ' |'
  " FROM sys.user$ u,sys.default_pwd$ d
  " WHERE u.type# = 1
  "   AND u.password = d.pwd_verifier
  "   AND u.name = d.user_name
  "   AND d.pv_type = 0;
  }
  call writeSql($sql)
  if !hasOutput(true)
   write 'No occurrences found%BR%'
 }
 else
  write 'Only available on Oracle Database 11g and later%BR%'
 write $TOP
}

=head2 D_KP - Users with a Well Known Password

Checks the existence of users with a well known password and displays
whether the account is locked. You must have access to the C<sys.user$> table
to get the results.

=cut

macro DB_known_pwd
{import $DBVER,$TOP

 var %tbl = (\
   "!DEMO_USER","'F5815FA39C791FED'",\
   "#INTERNAL","'38379FC3621F7DA2','87DADF57B623B777','628055A82588AC60'",\
   "AASH","'9B52488370BB3D77'",\
   "ABA1","'30FD307004F350DE'",\
   "ABM","'D0F2982F121C7840'",\
   "ADAMS","'0CDB0D6C522BEF86','72CDEF4A3483F60D'",\
   "ADLDEMO","'147215F51929A6E8'",\
   "ADMIN","'95F3C64472751462','B8B15AC9A946886A','CAC22318F162D597'",\
   "ADMINISTRATOR","'1848F0A31D1C5C62','F9ED601D936158BD'",\
   "ADS","'D23F0F5D871EB69F'",\
   "ADSEUL_US","'4953B2EB6FCB4339','A5567FC63A8ED1E2'",\
   "AD_MONITOR","'2D50778276904957','54F0C83F51B03F49'",\
   "AHL","'7910AE63C9F7EEEE'",\
   "AHM","'33C2E27CF5E401A4'",\
   "AK","'8FCB78BBA8A59515'",\
   "AL","'384B2C568DE4C2B5'",\
   "ALA1","'90AAC5BD7981A3BA'",\
   "ALHRO","'049B2397FB1A419E','A1D376BAC26753DC'",\
   "ALHRW","'734E6895801A3494','B064872E7F344CAE'",\
   "ALLUSERS","'42F7CD03B7D2CA0F'",\
   "ALR","'BE89B24F9F8231A9'",\
   "AMA1","'585565C23AB68F71'",\
   "AMA2","'37E458EE1688E463'",\
   "AMA3","'81A66D026DC5E2ED'",\
   "AMA4","'194CCC94A481DCDE'",\
   "AMF","'EC9419F55CDC666B'",\
   "AMS","'BD821F59270E5F34'",\
   "AMS1","'DB8573759A76394B'",\
   "AMS2","'EF611999C6AD1FD7'",\
   "AMS3","'41D1084F3F966440'",\
   "AMS4","'5F5903367FFFB3A3'",\
   "AMSYS","'4C1EF14ECE13B5DE'",\
   "AMV","'38BC87EB334A1AC4'",\
   "AMW","'0E123471AACA2A62'",\
   "ANDY","'316E63CFFF5BA4C8','B8527562E504BC3F'",\
   "ANNE","'1EEA3E6F588599A6'",\
   "ANONYMOUS","'4A44FB43A9DD3E2A','4A88837B49DFE54B','94C33111FD9C66F3',\
                'Anonymous','FE0E8CE7C92504E9','FE0E8CE7C92504E9'",\
   "AOLDEMO","'D04BBDD5E643C436'",\
   "AP","'EED09A552944B6AD'",\
   "APA1","'D00197BF551B2A79'",\
   "APA2","'121C6F5BD4674A33'",\
   "APA3","'5F843C0692560518'",\
   "APA4","'BF21227532D2794A'",\
   "APEX_PUBLIC_USER","'EE57D9237462E876'",\
   "APPLEAD","'5331DB9C240E093B'",\
   "APPLMGR","'CB562C240E871070'",\
   "APPLSYS","'0F886772980B8C79','E153FFF4DAE6C9F7','FE84888987A6BF5A'",\
   "APPLSYSPUB","'78194639B5C3DF9F','D2E3EF40EE87221E','D5DB40BB03EA1270'",\
   "APPLYSYSPUB","'2D09C9A345289907','315ECD223BB3DFA9','6A477D2DBE0AA75F',\
                  'E3C57FAC4FF4EFCC','315ECD223BB3DFA9','78194639B5C3DF9F',\
                  'A5E09E84EC486FC9','D2E3EF40EE87221E'",\
   "APPS","'D728438E8A5925E0'",\
   "APPS_MRC","'2FFDCBB4FD11D9DC','4F0AFEAC94972330'",\
   "APPUSER","'30745432E18C90D5','7E2C3C2D4BF4071B'",\
   "APS1","'F65751C55EA079E6'",\
   "APS2","'5CACE7B928382C8B'",\
   "APS3","'C786695324D7FB3B'",\
   "APS4","'F86074C4F4F82D2C'",\
   "AQ","'2B0C31040A1CFB48'",\
   "AQDEMO","'5140E342712061DD'",\
   "AQJAVA","'8765D2543274B42E'",\
   "AQUSER","'4CF13BDAC1D7511C'",\
   "AQ_ADMINISTRATOR_ROLE","''",\
   "AQ_USER_ROLE","''",\
   "AR","'BBBFE175688DED7E'",\
   "ARA1","'4B9F4E0667857EB8'",\
   "ARA2","'F4E52BFBED4652CD'",\
   "ARA3","'E3D8D73AE399F7FE'",\
   "ARA4","'758FD31D826E9143'",\
   "ARS1","'433263ED08C7A4FD'",\
   "ARS2","'F3AF9F26D0213538'",\
   "ARS3","'F6755F08CC1E7831'",\
   "ARS4","'452B5A381CABB241'",\
   "ART","'665168849666C4F3'",\
   "ASF","'B6FD427D08619EEE'",\
   "ASG","'1EF8D8BD87CF16BE'",\
   "ASL","'03B20D2C323D0BFE'",\
   "ASN","'1EE6AEBD9A23D4E0'",\
   "ASO","'F712D80109E3C9D8'",\
   "ASP","'CF95D2C6C85FF513'",\
   "AST","'F13FF949563EAB3C'",\
   "ATM","'5D49B0BD42DF6B85','7B83A0860CF3CB71'",\
   "AUC_GUEST","'8A59D349DAEC26F7'",\
   "AUDIOUSER","'CB4F2CEC5A352488'",\
   "AURORA$JIS$UTILITY$","'A150AF65C4F8F54B','E1BAE6D95AA95F1E',\
                          'INVALID_ENCRYPTED_PASSWORD'",\
   "AURORA$ORB$UNAUTHENTICATED","'64A31D2239848B2D','80C099F0EADF877E',\
                                 'INVALID_ENCRYPTED_PASSWORD'",\
   "AUTHENTICATEDUSER","''",\
   "AUTHORIA","'CC78120E79B57093'",\
   "AX","'0A8303530E86FCDD'",\
   "AZ","'AAA18B5D51B0D5AC'",\
   "B2B","'CC387B24E013C616'",\
   "BAM","'031091A1D1A30061'",\
   "BC4J","'EAA333E83BF2810D'",\
   "BCA1","'398A69209360BD9D'",\
   "BCA2","'801D9C90EBC89371'",\
   "BEN","'1.80E+308','9671866348E03616'",\
   "BI","'3E8BC1910E890908','EB32A21961929D0C','EB32A21961929D0C'",\
   "BIC","'E84CC95CBBAC1B67'",\
   "BIL","'BF24BCE2409BE1F7'",\
   "BIM","'6026F9A8A54B9468'",\
   "BIS","'7E9901882E5F3565'",\
   "BIV","'2564B34BE50C2524'",\
   "BIX","'3DD36935EAEDE2E3'",\
   "BLAKE","'4B46E4AD436310D3','9435F2E60569158E'",\
   "BLEWIS","'C9B597D7361EE067'",\
   "BMEADOWS","'2882BA3D3EE1F65A'",\
   "BNE","'080B5C7EE819BF78'",\
   "BOM","'56DB3E89EAE5788E'",\
   "BP01","'612D669D2833FACD'",\
   "BP02","'FCE0C089A3ECECEE'",\
   "BP03","'0723FFEEFBA61545'",\
   "BP04","'E5797698E0F8934E'",\
   "BP05","'58FFC821F778D7E9'",\
   "BP06","'2F358909A4AA6059'",\
   "BRIO_ADMIN","'EB50644BE27DF70B'",\
   "BRUGERNAVN","'2F11631B6B4E0B6F','529B94BA5C2060D9','529B94BA5C2060D9',\
                 '652C49CDF955F83A','8B1539626562E020','DEE595779FF826D9',\
                 'DEE595779FF826D9'",\
   "BSC","'EC481FD7DCE6366A'",\
   "BUG_REPORTS","'E9473A88A4DD31F2'",\
   "BUYACCT","'D6B388366ECF2F61'",\
   "BUYAPPR1","'CB04931693309228'",\
   "BUYAPPR2","'3F98A3ADC037F49C'",\
   "BUYAPPR3","'E65D8AD3ACC23DA3'",\
   "BUYER","'547BDA4286A2ECAE'",\
   "BUYMTCH","'0DA5E3B504CC7497'",\
   "CALVIN","'1374F80222606408','34200F94830271A3'",\
   "CAMRON","'4384E3F9C9C9B8F1'",\
   "CANDICE","'CF458B3230215199'",\
   "CARL","'99ECCC664FFDFEA2'",\
   "CARLY","'F7D90C099F9097F1'",\
   "CARMEN","'46E23E1FD86A4277'",\
   "CARRIECONYERS","'9BA83B1E43A5885B'",\
   "CATADMIN","'AF9AB905347E004F'",\
   "CATALOG","'397129246919E8DA'",\
   "CCT","'C6AF8FCA0B51B32F'",\
   "CDEMO82","'67B891F114BE3AEB','7299A5E2A5A05820','73EAE7C39B42EA15'",\
   "CDEMOCOR","'3A34F0B26B951F3F'",\
   "CDEMORID","'E39CEFE64B73B308'",\
   "CDEMOUCB","'CEAE780F25D556F8'",\
   "CDOUGLAS","'C35109FE764ED61E'",\
   "CE","'E7FDFE26A524FE39'",\
   "CEASAR","'E69833B8205D5DD7'",\
   "CEDIES","'10265581DAD00BDC'",\
   "CEDOC","'B85EF6C219B9AD57'",\
   "CENTRA","'63BF5FFE5E3EA16D'",\
   "CENTRAL","'A98B26E2F65CA4D3'",\
   "CFD","'667B018D4703C739'",\
   "CHANDRA","'184503FA7786C82D'",\
   "CHARLEY","'E500DAA705382E8D'",\
   "CHRISBAKER","'52AFB6B3BE485F81'",\
   "CHRISTIE","'C08B79CCEC43E798'",\
   "CIDS","'AA71234EF06CE6B3'",\
   "CINDY","'3AB2C717D1BD0887'",\
   "CIS","'7653EBAF048F0A10','77AC7F9418B82AD6','AA2602921607EE84'",\
   "CISINFO","'3AA26FC267C5F577','BEA52A368C31B86F'",\
   "CLARK","'74DF527800B6D713','7AAFE7D01511D73F'",\
   "CLAUDE","'C6082BCBD0B69D20'",\
   "CLINT","'163FF8CCB7F11691'",\
   "CLKANA","'','541F6C43BA6A452C','541F6C43BA6A452C','784A01E7112DE363'",\
   "CLKRT","'','1AB4FB99AA8815A6','F9B060BDD25BD1B0'",\
   "CLN","'A18899D42066BFCA'",\
   "CN","'73F284637A54777D'",\
   "CN=ORCLADMIN","'95A8AC4484A4C5DF','A437E1C0C6BD6E08'",\
   "CNCADMIN","'C7C8933C678F7BF9'",\
   "COMPANY","'402B659C15EAF6CB'",\
   "COMPIERE","'E3D0DCF4B4DBE626'",\
   "CONNECT","''",\
   "CONNIE","'982F4C420DD38307'",\
   "CONNOR","'52875AEB74008D78'",\
   "CORY","'93CE4CCE632ADCD2'",\
   "CQSCHEMAUSER","'04071E7EDEB2F5CC','098B0543BA574A6E'",\
   "CQUSERDBUSER","'0273F484CD3F44B7','DEC3F8517BE519B9'",\
   "CRM1","'6966EA64B0DFC44E'",\
   "CRM2","'B041F3BEEDA87F72'",\
   "CRP","'F165BDE5462AD557'",\
   "CRPB733","'2C9AB93FF2999125'",\
   "CRPCTL","'4C7A200FB33A531D'",\
   "CRPDTA","'6665270166D613BC'",\
   "CS","'DB78866145D4E1C3'",\
   "CSADMIN","'94327195EF560924'",\
   "CSAPPR1","'47D841B5A01168FF'",\
   "CSC","'EDECA9762A8C79CD'",\
   "CSD","'144441CEBAFC91CF'",\
   "CSDUMMY","'7A587C459B93ACE4'",\
   "CSE","'D8CC61E8F42537DA'",\
   "CSF","'684E28B3C899D42C'",\
   "CSI","'71C2B12C28B79294'",\
   "CSL","'C4D7FE062EFB85AB'",\
   "CSM","'94C24FC0BE22F77F'",\
   "CSMIG","'09B4BB013FBD0D65'",\
   "CSP","'5746C5E077719DB4'",\
   "CSR","'0E0F7C1B1FE3FA32'",\
   "CSS","'3C6B8C73DDC6B04F'",\
   "CSW_USR_ROLE","'F79FD2B778DEA3AA'",\
   "CTXAPP","''",\
   "CTXDEMO","'CB6B5E9D9672FE89'",\
   "CTXSYS","'24ABAB8B06281B4C','71E687F036AD56E5','A13C035631643BA0','',\
             '59A09E95123A11BA','E6279CD19B30E05B'",\
   "CTXTEST","'064717C317B551B6'",\
   "CUA","'CB7B2E6FFDD7976F'",\
   "CUE","'A219FE4CA25023AA'",\
   "CUF","'82959A9BD2D51297'",\
   "CUG","'21FBCADAEAFCC489'",\
   "CUI","'AD7862E01FA80912'",\
   "CUN","'41C2D31F3C85A79D'",\
   "CUP","'C03082CD3B13EC42'",\
   "CUS","'00A12CC6EBF8EDB8'",\
   "CWM_USER","''",\
   "CZ","'9B667E9C5A0D21A6'",\
   "DATAPUMP_EXP_FULL_DATABASE","''",\
   "DATAPUMP_IMP_FULL_DATABASE","''",\
   "DATA_SCHEMA","'5ECB30FD1A71CC54','6A7A4F1F0840D891'",\
   "DAVIDMORGAN","'B717BAB262B7A070'",\
   "DBA","''",\
   "DBI","'35C0679701A91877','D8FF6ECEF4C50809'",\
   "DBSNMP","'E066D214D5421CCC','E24E1D144F1B6D41'",\
   "DBVISION","'F74F7EF36A124931'",\
   "DCM","'','45CCF86E1058D3A5','5B5FF58F89F1EA3F'",\
   "DD7333","'44886308CF32B5D4'",\
   "DD7334","'D7511E19D9BD0F90'",\
   "DD810","'0F9473D8D8105590'",\
   "DD811","'D8084AE609C9A2FD'",\
   "DD812","'AB71915CF21E849E'",\
   "DD9","'E81821D03070818C'",\
   "DDB733","'7D11619CEE99DE12'",\
   "DDD","'6CB03AF4F6DD133D'",\
   "DDIC","'4F9FFB093F909574','BB3C993647668581'",\
   "DELETE_CATALOG_ROLE","''",\
   "DEMO","'4646116A123897CF'",\
   "DEMO8","'0E7260738FDFD678'",\
   "DEMO9","'EE02531A80D998CA'",\
   "DES","'ABFEC5AC2274E54D'",\
   "DES2K","'611E7A73EC4B425A'",\
   "DEV2000_DEMOS","'18A0C8BD6B13BEE2'",\
   "DEVB733","'7500DF89DC99C057'",\
   "DEVUSER","'C10B4A80D00CA7A5'",\
   "DGRAY","'03291DF1B7E72391'",\
   "DGRAY","'5B76A1EB8F212B85'",\
   "DIANE","'46DC27700F2ADE28','D1348AFAEEBBB5A8'",\
   "DIP","'CE4A36B8E06CA59C'",\
   "DISCOVERER5","'','02585FA8A8CCAE08','AF0EDB66D914B731'",\
   "DISCOVERER_ADMIN","'5C1AED4D1AADAA4C'",\
   "DKING","'255C2B0E1F0912EA'",\
   "DLD","'4454B932A1E0E320'",\
   "DMADMIN","'77BBC9E0DBD96703','E6681A8926B40826'",\
   "DMATS","'8C692701A4531286'",\
   "DMS","'1351DC7ED400BD59'",\
   "DMSYS","'BFBA5A553FD9E28A'",\
   "DOM","'51C9F2BECA78AE0E'",\
   "DPF","'A52970CD16DB50E7'",\
   "DPF","'E53F7C782FAA6898'",\
   "DPOND","'79D6A52960EEC216'",\
   "DSGATEWAY","'','4356E831A8F94F55','6869F3CFD027983A'",\
   "DSSYS","'E3B6E6006B3A99E0'",\
   "DTSP","'5A40D4065B3673D2'",\
   "DV7333","'36AFA5CD674BA841'",\
   "DV7334","'473B568021BDB428'",\
   "DV810","'52C38F48C99A0352'",\
   "DV811","'B6DC5AAB55ECB66C'",\
   "DV812","'7359E6E060B945BA'",\
   "DV9","'07A1D03FD26E5820'",\
   "DVP1","'0559A0D3DE0759A6'",\
   "EAA","'A410B2C5A0958CDF'",\
   "EAM","'CE8234D92FCFB563'",\
   "EARLYWATCH","'8AA1C62E08C76445','FAE8FCC8FCC41218'",\
   "EAST","'C5D5C455A1DE5F4D'",\
   "EC","'6A066C462B62DD46'",\
   "ECX","'0A30645183812087'",\
   "EDR","'5FEC29516474BB3A'",\
   "EDWEUL_US","'5922BA2E72C49787'",\
   "EDWREP","'79372B4AB748501F'",\
   "EGC1","'D78E0F2BE306450D'",\
   "EGD1","'DA6D6F2089885BA6'",\
   "EGM1","'FB949D5E4B5255C0'",\
   "EGO","'B9D919E5F5A9DA71'",\
   "EGR1","'BB636336ADC5824A'",\
   "EJB","'69CB07E2162C6C93'",\
   "EJBCLIENT","''",\
   "EJSADMIN","'313F9DFD92922CD2','4C59B97125B6641A'",\
   "EMP","'B40C23C6E2B4EA3D'",\
   "END1","'688499930C210B75'",\
   "ENG","'4553A3B443FB3207'",\
   "ENI","'05A92C0958AFBCBC'",\
   "ENM1","'3BDABFD1246BFEA2'",\
   "ENS1","'F68A5D0D6D2BB25B'",\
   "ENTMGR_CUST","'45812601EAA2B8BD'",\
   "ENTMGR_PRO","'20002682991470B3'",\
   "ENTMGR_TRAIN","'BE40A3BE306DD857'",\
   "EOPP_PORTALADM","'B60557FD8C45005A','9BB3CF93F7DE25F1'",\
   "EOPP_USER","'13709991FC4800A1'",\
   "ESTOREUSER","'0AB4F4864F7B4525','51063C47AC2628D4'",\
   "EUL_US","'28AEC22561414B29'",\
   "EVENT","'7CA0A42DA768F96D'",\
   "EVM","'137CEDC20DE69F71'",\
   "EXA1","'091BCD95EE112EE3'",\
   "EXA2","'E4C0A21DBD06B890'",\
   "EXA3","'40DC4FA801A73560'",\
   "EXA4","'953885D52BDF5C86'",\
   "EXAMPLE","'637417B1DC47C2E5'",\
   "EXECUTE_CATALOG_ROLE","''",\
   "EXFSYS","'66F4EF5650C20355'",\
   "EXP_FULL_DATABASE","''",\
   "EXS1","'C5572BAB195817F0'",\
   "EXS2","'8FAA3AC645793562'",\
   "EXS3","'E3050174EE1844BA'",\
   "EXS4","'E963BFE157475F7D'",\
   "EXTDEMO","'BAEF9D34973EE4EC'",\
   "EXTDEMO2","'6A10DD2DB23880CB'",\
   "FA","'21A837D0AED8F8E5'",\
   "FEM","'BD63D79ADF5262E7'",\
   "FIA1","'2EB76E07D3E094EC'",\
   "FII","'CF39DE29C08F71B9'",\
   "FINANCE","'6CBBF17292A1B9AA'",\
   "FINPROD","'8E2713F53A3D69D5'",\
   "FLM","'CEE2C4B59E7567A3'",\
   "FLOWS_030000","'E17C97E4DF430B40'",\
   "FLOWS_FILES","'D0D249432624C419'",\
   "FND","'0C0832F8B6897321'",\
   "FNI1","'308839029D04F80C'",\
   "FNI2","'05C69C8FEAB4F0B9'",\
   "FOO","'707156934A6318D4','CF638D37C33D5B71'",\
   "FPA","'9FD6074B9FD3754C'",\
   "FPT","'73E3EC9C0D1FAECF'",\
   "FRM","'9A2A7E2EBE6E4F71'",\
   "FROSTY","'2ED539F71B4AA697','A2BED55A8AAF0CCD'",\
   "FTA1","'65FF9AB3A49E8A13'",\
   "FTE","'2FB4D2C9BAE2CCCA'",\
   "FUN","'8A7055CA462DB219'",\
   "FV","'907D70C0891A85B1'",\
   "FVP1","'6CC7825EADF994E8'",\
   "GALLEN","'F8E8ED9F15842428'",\
   "GATHER_SYSTEM_STATISTICS","''",\
   "GCA1","'47DA9864E018539B'",\
   "GCA2","'FD6E06F7DD50E868'",\
   "GCA3","'4A4B9C2E9624C410'",\
   "GCA9","'48A7205A4C52D6B5'",\
   "GCMGR1","'14A1C1A08EA915D6'",\
   "GCMGR2","'F4F11339A4221A4D'",\
   "GCMGR3","'320F0D4258B9D190'",\
   "GCS","'7AE34CA7F597EBF7'",\
   "GCS1","'2AE8E84D2400E61D'",\
   "GCS2","'C242D2B83162FF3D'",\
   "GCS3","'DCCB4B49C68D77E2'",\
   "GEORGIAWINE","'F05B1C50A1C926DE'",\
   "GL","'CD6E99DACE4EA3A6'",\
   "GLA1","'86C88007729EB36F'",\
   "GLA2","'807622529F170C02'",\
   "GLA3","'863A20A4EFF7386B'",\
   "GLA4","'DB882CF89A758377'",\
   "GLOBAL_AQ_USER_ROLE","'GLOBAL'",\
   "GLS1","'7485C6BD564E75D1'",\
   "GLS2","'319E08C55B04C672'",\
   "GLS3","'A7699C43BB136229'",\
   "GLS4","'7C171E6980BE2DB9'",\
   "GMA","'DC7948E807DFE242'",\
   "GMD","'E269165256F22F01'",\
   "GME","'B2F0E221F45A228F'",\
   "GMF","'A07F1956E3E468E1'",\
   "GMI","'82542940B0CF9C16'",\
   "GML","'5F1869AD455BBA73'",\
   "GMP","'450793ACFCC7B58E'",\
   "GMS","'E654261035504804'",\
   "GM_AWDA","'4A06A107E7A3BB10'",\
   "GM_COPI","'03929AE296BAAFF2'",\
   "GM_DPHD","'0519252EDF68FA86'",\
   "GM_MLCT","'24E8B569E8D1E93E'",\
   "GM_PLADMA","'2946218A27B554D8'",\
   "GM_PLADMH","'2F6EDE96313AF1B7'",\
   "GM_PLCCA","'7A99244B545A038D'",\
   "GM_PLCCH","'770D9045741499E6'",\
   "GM_PLCOMA","'91524D7DE2B789A8'",\
   "GM_PLCOMH","'FC1C6E0864BF0AF2'",\
   "GM_PLCONA","'1F531397B19B1E05'",\
   "GM_PLCONH","'C5FE216EB8FCD023'",\
   "GM_PLNSCA","'DB9DD2361D011A30'",\
   "GM_PLNSCH","'C80D557351110D51'",\
   "GM_PLSCTA","'3A778986229BA20C'",\
   "GM_PLSCTH","'9E50865473B63347'",\
   "GM_PLVET","'674885FDB93D34B9'",\
   "GM_SPO","'E57D4BD77DAF92F0'",\
   "GM_STKH","'C498A86BE2663899'",\
   "GPFD","'BA787E988F8BC424'",\
   "GPLD","'9D561E4D6585824B'",\
   "GR","'F5AB0AA3197AEE42'",\
   "GUEST","'1C0A090E404CECD0'",\
   "HADES","'2485287AC1DB6756'",\
   "HCC","'25A25A7FEFAC17B6'",\
   "HCPARK","'3DE1EBA32154C56B'",\
   "HHCFO","'62DF37933FB35E9F'",\
   "HLW","'855296220C095810'",\
   "HR","'33EBE1C63D5B7FEF','4C6D73C3E8B0F0DA','6399F3B38EDF3288',\
         '6E0C251EABE4EBB8','7A1163C674A5F5B6'",\
   "HRI","'49A3A09B8FC291D0'",\
   "HS_ADMIN_ROLE","''",\
   "HVST","'5787B0D15766ADFD'",\
   "HXC","'4CEA0BF02214DA55'",\
   "HXT","'169018EB8E2C4A77'",\
   "IA","'42C7EAFBCEEC09CC'",\
   "IBA","'0BD475D5BF449C63'",\
   "IBC","'9FB08604A30A4951'",\
   "IBE","'9D41D2B3DD095227'",\
   "IBP","'840267B7BD30C82E'",\
   "IBU","'0AD9ABABC74B3057'",\
   "IBY","'F483A48F6A8C51EC'",\
   "ICDBOWN","'76B8D54A74465BB4'",\
   "ICX","'7766E887AF4DCC46'",\
   "IDEMO_USER","'739F5BC33AC03043'",\
   "IEB","'A695699F0F71C300'",\
   "IEC","'CA39F929AF0A2DEC'",\
   "IEM","'37EF7B2DD17279B5'",\
   "IEO","'E93196E9196653F1'",\
   "IES","'30802533ADACFE14'",\
   "IEU","'5D0E790B9E882230'",\
   "IEX","'6CC978F56D21258D'",\
   "IFSSYS","'1DF0D45B58E72097'",\
   "IGC","'D33CEB8277F25346'",\
   "IGF","'1740079EFF46AB81'",\
   "IGI","'8C69D50E9D92B9D0'",\
   "IGS","'DAF602231281B5AC'",\
   "IGW","'B39565F4E3CF744B'",\
   "IMAGEUSER","'E079BF5E433F0B89'",\
   "IMC","'C7D0B9CDE0B42C73'",\
   "IMEDIA","'8FB1DC9A6F8CE827'",\
   "IMP_FULL_DATABASE","''",\
   "IMT","'E4AAF998653C9A72'",\
   "INS1","'2ADC32A0B154F897'",\
   "INS2","'EA372A684B790E2A'",\
   "INTERNAL","'AB27B53EDC5FEF41','E0BF7F3DDE682D3B'",\
   "INTERNET_APPSERVER_REGISTRY","'926ED87CC8860D4D','A1F98A977FFD73CD'",\
   "INV","'ACEAB015589CF4BC'",\
   "IP","'D29012C144B58A40'",\
   "IPA","'EB265A08759A15B4'",\
   "IPD","'066A2E3072C1F2F3'",\
   "IPLANET","'7404A12072F4E5E8'",\
   "ISC","'373F527DC0CFAE98'",\
   "ISTEWARD","'8735CA4085DE3EEA'",\
   "ITG","'D90F98746B68E6CA'",\
   "IX","'885DA62CD26FED7E'",\
   "IX","'93E74FEFC0C5BA40'",\
   "JA","'9AC2B58153C23F3D'",\
   "JAKE","'1CE0B71B4A34904B'",\
   "JAKE","'DE24B8035C21E637'",\
   "JAVADEBUGPRIV","''",\
   "JAVAIDPRIV","''",\
   "JAVASYSPRIV","''",\
   "JAVAUSERPRIV","''",\
   "JAVA_ADMIN","''",\
   "JAVA_DEPLOY","''",\
   "JD7333","'FB5B8A12AE623D52'",\
   "JD7334","'322810FCE43285D9'",\
   "JD9","'9BFAEC92526D027B'",\
   "JDE","'7566DC952E73E869'",\
   "JDEDBA","'B239DD5313303B1D'",\
   "JE","'FBB3209FD6280E69'",\
   "JG","'37A99698752A1CF1'",\
   "JILL","'0D719190C6F172B6'",\
   "JILL","'D89D6F9EB78FC841'",\
   "JL","'489B61E488094A8D'",\
   "JMUSER","'063BA85BF749DF8E'",\
   "JMXSERVER","''",\
   "JOHN","'29ED3FDC733DC86D'",\
   "JOHNINARI","'B3AD4DA00F9120CE'",\
   "JONES","'5215700C08CDCF93','B9E99443032F059D'",\
   "JTF","'5C5F6FC2EBB94124'",\
   "JTI","'B8F03D3E72C96F71'",\
   "JTM","'6D79A2259D5B4B5A'",\
   "JTR","'B4E2BE38B556048F'",\
   "JTS","'4087EE6EB7F9CD7C'",\
   "JUNK_PS","'BBC38DB05D2D3A7A'",\
   "JUSTOSHUM","'53369CD63902FAAA'",\
   "JWARD","'AEC101637BB519AF','CF9CB787BD98DA7F'",\
   "KELLYJONES","'DD4A3FF809D2A6CF'",\
   "KEVINDONS","'7C6D9540B45BBC39'",\
   "KPN","'DF0AED05DE318728'",\
   "KWALKER","'AD0D93891AEB26D2'",\
   "L2LDEMO","'0A6B2DF907484CEE'",\
   "LADAMS","'AE542B99505CDCD2'",\
   "LBA","'18E5E15A436E7157'",\
   "LBACSYS","'AC9700FD3F1410EB'",\
   "LDQUAL","'1274872AB40D4FCD'",\
   "LHILL","'E70CA2CA0ED555F5'",\
   "LIBRARIAN","'11E0654A7068559C','C308C88FC950DA82'",\
   "LNS","'F8D2BC61C10941B2'",\
   "LOGSTDBY_ADMINISTRATOR","''",\
   "LQUINCY","'13F9B9C1372A41B6'",\
   "LSA","'2D5E6036E3127B7E'",\
   "MANPROD","'F0EB74546E22E94D'",\
   "MAPAE_V0101_AOO","'F61E87F6E58EB33C'",\
   "MAPAE_V0101_DML","'CE385207F340ADFB'",\
   "MAPAE_V0101_RDO","'4D37C014D8E5C689'",\
   "MARK","'364CE7DAA61CF042','F7101600ACABCD74'",\
   "MASCARM","'236AE47CF9F45C1C','4EA68D0DDE8AAC6B'",\
   "MASTER","'76626E2F3790C349','9C4F452058285A74'",\
   "MDDATA","'DF02A496267DEE66'",\
   "MDDEMO","'46DFFB4D08C33739'",\
   "MDDEMO_CLERK","'564F871D61369A39','E5288E225588D11F','5C396B38F946C229'",\
   "MDDEMO_MGR","'2E175141BEE66FF6','B41BCD9D3737F5C4'",\
   "MDSYS","'72979A94BAD2AF80','9AAEB2214DCC9A31'",\
   "ME","'E5436F7169B29E4D'",\
   "MFG","'FC1B0DD35E790847'",\
   "MGMT_USER","''",\
   "MGMT_VIEW","'8A6AC3DC0A01D641'",\
   "MGR","'9D1F407F3A05BDD9'",\
   "MGR1","'E013305AB0185A97'",\
   "MGR2","'5ADE358F8ACE73E8'",\
   "MGR3","'05C365C883F1251A'",\
   "MGR4","'E229E942E8542565'",\
   "MGWUSER","'EA514DD74D7DE14C'",\
   "MIGRATE","'5A88CE52084E9700'",\
   "MIKEIKEGAMI","'AAF7A168C83D5C47'",\
   "MILLER","'D0EFCD03C95DF106'",\
   "MJONES","'EE7BB3FEA50A21C5'",\
   "MLAKE","'7EC40274AC1609CA'",\
   "MM1","'4418294570E152E7'",\
   "MM2","'C06B5B28222E1E62'",\
   "MM3","'A975B1BD0C093DA3'",\
   "MM4","'88256901EB03A012'",\
   "MM5","'4CEA62CBE776DCEC'",\
   "MMARTIN","'D52F60115FE87AA4'",\
   "MMO2","'62876B0382D5B550','A0E2085176E05C85','AE128772645F6709'",\
   "MOBILEADMIN","'080B020CA654274D','253922686A4A45CC'",\
   "MODTEST","'BBFF58334CDEF86D','ECD536C7468C9DD3'",\
   "MOREAU","'CF5A081E7585936B'",\
   "MRP","'B45D4DF02D4E0C85'",\
   "MSC","'89A8C104725367B2'",\
   "MSD","'6A29482069E23675'",\
   "MSO","'3BAA3289DB35813C'",\
   "MSR","'C9D53D00FE77D813'",\
   "MST","'A96D2408F62BE1BC'",\
   "MTSSYS","'6465913FF5FF1831'",\
   "MTS_USER","'2FB9DFDA1939943D','E462DB4671A51CD4'",\
   "MTYSYS","'8423ADBE033BCDF2'",\
   "MWA","'1E2F06BE2A1D41A6'",\
   "MXAGENT","'C5F0512A64EB0E7F'",\
   "NAMES","'9B95D28A979CC5C4'",\
   "NEILKATSU","'1F625BB9FEBC7617'",\
   "NEOTIX_SYS","'05BFA7FF86D6EB32'",\
   "NNEUL","'2B3D1D8FAE5637E2','4782D68D42792139'",\
   "NOMEUTENTE","'8A43574EFB1C71C7','D7E31E63957CFCC8'",\
   "NOME_UTILIZADOR","'71452E4797DF917B','AA7B972E026DA06D'",\
   "NOM_UTILISATEUR","'DF08E66D59590582','FD621020564A4978'",\
   "NUME_UTILIZATOR","'36B5A539D43FB2A7','73A3AC32826558AE'",\
   "OAIHUB902","'','09128818DB415317','91631DAD6C6CBC83'",\
   "OAS_PUBLIC","'17F43A270D2CB072','1A550C73530AE1AF','9300C0977D7DC75E',\
                 'A8116DB6E84FA95D','A8116DB6E84FA95D'",\
   "OBJ7333","'D7BDC9748AFEDB52'",\
   "OBJ7334","'EB6C5E9DB4643CAC'",\
   "OBJB733","'61737A9F7D54EF5F'",\
   "OCA","'9BC450E4C6569492'",\
   "OCITEST","'C09011CB0205B347'",\
   "OCM_DB_ADMIN","'2C3A5DEF1EE57E92','75D0D0E00377B21C',''",\
   "ODM","'C252E8FA117AF049'",\
   "ODM_MTR","'A7A32CD03D3CE8D5','D518D2CA05A52402'",\
   "ODS","'89804494ADFC71BC'",\
   "ODSCOMMON","'59BBED977430C1A8'",\
   "ODS_SERVER","'0FBEF162DCEE7236','C6E799A949471F57'",\
   "OE","'62FADF01C4DC1ED4','9C30855E7E0CB02D','D1A2DFC623FDA40A',\
          'D1A2DFC623FDA40A'",\
   "OEMADM","'9DCE98CCF541AAE6'",\
   "OEMREP","'7BB2F629772BF2E5'",\
   "OEM_ADVISOR","''",\
   "OEM_MONITOR","''",\
   "OEM_REPOSITORY","'1FF89109F7A16FEF','3F7C248965F89135','71BD40296256AFB1',\
                     'B71C6D18842E132B'",\
   "OKB","'A01A5F0698FC9E31'",\
   "OKC","'31C1DDF4D5D63FE6'",\
   "OKE","'B7C1BB95646C16FE'",\
   "OKI","'991C817E5FD0F35A'",\
   "OKL","'DE058868E3D2B966'",\
   "OKO","'6E204632EC7CA65D'",\
   "OKR","'BB0E28666845FCDC'",\
   "OKS","'C2B4C76AB8257DF5'",\
   "OKX","'F9FDEB0DE52F5D6B'",\
   "OL810","'E2DA59561CBD0296'",\
   "OL811","'B3E88767A01403F8'",\
   "OL812","'AE8C7989346785BA'",\
   "OL9","'17EC83E44FB7DB5B'",\
   "OLAPDBA","'1AF71599EDACFB00'",\
   "OLAPI_TRACE_USER","''",\
   "OLAPSVR","'3B3F6DB781927D0F','AF52CFD036E8F425'",\
   "OLAPSYS","'3FB8EF9DB538647C','C1510E7AC8F0D90D','4AC23CC3B15E2208'",\
   "OLAP_DBA","''",\
   "OLAP_USER","''",\
   "OLAP_XS_ADMIN","''",\
   "OMWB_EMULATION","'54A85D2A0AB8D865','9ACB097463663608'",\
   "ONT","'9E3C81574654100A'",\
   "OO","'2AB9032E4483FAFC'",\
   "OPENSPIRIT","'D664AAB21CE86FD2'",\
   "OPI","'1BF23812A0AEEDA0'",\
   "ORABAM","'D0A4EA93EF21CE25'",\
   "ORABAMSAMPLES","'507F11063496F222'",\
   "ORABPEL","'26EFDE0C9C051988'",\
   "ORACACHE","'5A4EEC421DE68DDD','8BFB137373446175','AF7CD1A939FFCFB2',''",\
   "ORACLE","'38E38619A12E0257'",\
   "ORACLE-TST_O11G_RMAN111","'193A5C133F68C526'",\
   "ORACLE_OCM","'6D17CF1EB1611F94'",\
   "ORACLE_TST_O11G_RMAN111","'1E55347AE6528EFB'",\
   "ORADBA","'1F5A6E0781B90891','C37E732953A8ABDB'",\
   "ORAESB","'CC7FCCB3A1719EDA'",\
   "ORANGE","'1F2075D58FD83617','5FD6C95208210AAA','68E4FDEF494F46B5',\
             '3D9B7E34A4F7D4E9'",\
   "ORAOCA_PUBLIC","'FA99021634DDC111'",\
   "ORAPROBE","'2E3EA470A4CA2D94'",\
   "ORAREGSYS","'28D778112C63CB15'",\
   "ORASAGENT","'234B6F4505AD8F25'",\
   "ORASSO","'F3701A008AA578CF'",\
   "ORASSO_DS","'17DC8E02BC75C141'",\
   "ORASSO_PA","'133F8D161296CB8F'",\
   "ORASSO_PS","'63BB534256053305'",\
   "ORASSO_PUBLIC","'C6EED68A8F75F5D3'",\
   "ORASTAT","'6102BAE530DD4B95'",\
   "ORCLADMIN","'275EE0C5110899AA','7C0BE475D580FBA2'",\
   "ORDADMIN","''",\
   "ORDCOMMON","'9B616F5489F90AD7'",\
   "ORDPLUGINS","'88A2B2C183431F00'",\
   "ORDSYS","'7EFA02EC7EA6B86F'",\
   "OSE$HTTP$ADMIN","'05327CD9F6114E21','INVALID_ENCRYPTED_PASSWORD'",\
   "OSE$HTTP$ADMIN","'30F6C41397B5D73D'",\
   "OSM","'106AE118841A5D8C'",\
   "OSP22","'C04057049DF974C2'",\
   "OSSAQ_HOST","'4854640A7CC32756','55626318CFB9E310',''",\
   "OSSAQ_PUB","'A495C7FF72D1F153','FBD40D34731AA0F1',''",\
   "OSSAQ_SUB","'12E5A27BB1DC2FA0','8F5799E3E0C5A6C6',''",\
   "OTA","'F5E498AC7009A217'",\
   "OUTLN","'4A3BA55E08595C81'",\
   "OWA","'CA5D67CD878AFC49'",\
   "OWAPUB","'6696361B64F9E0A9'",\
   "OWA_PUBLIC","'0D9EC1D1F2A37657'",\
   "OWB$CLIENT","'13D492A4459DFE0D'",\
   "OWBSYS","'610A3C38F301776F'",\
   "OWB_DESIGNCENTER_VIEW","'876EB62037E6316A'",\
   "OWB_USER","''",\
   "OWF_MGR","'3CBED37697EB01D1','8848199D12058A74',''",\
   "OWNER","'5C3546B4F9165300'",\
   "OZF","'970B962D942D0C75'",\
   "OZP","'B650B1BB35E86863'",\
   "OZS","'0DABFF67E0D33623'",\
   "PA","'8CE2703752DB36D8'",\
   "PABLO","'5E309CB43FE2C2FF'",\
   "PAIGE","'02B6B704DFDCE620'",\
   "PAM","'1383324A0068757C'",\
   "PANAMA","'3E7B4116043BEAFF'",\
   "PARRISH","'79193FDACFCE46F6'",\
   "PARSON","'AE28B2BD64720CD7'",\
   "PAT","'DD20769D59F4F7BF'",\
   "PATORILY","'46B7664BD15859F9'",\
   "PATRICKSANCHEZ","'47F74BD3AD4B5F0A'",\
   "PATROL","'0478B8F047DECC65'",\
   "PATSY","'4A63F91FEC7980B7'",\
   "PAUL","'35EC0362643ADD3F'",\
   "PAULA","'BB0DC58A94C17805'",\
   "PAXTON","'4EB5D8FAD3434CCC'",\
   "PCA1","'8B2E303DEEEEA0C0'",\
   "PCA2","'7AD6CE22462A5781'",\
   "PCA3","'B8194D12FD4F537D'",\
   "PCA4","'83AD05F1D0B0C603'",\
   "PCS1","'2BE6DD3D1DEA4A16'",\
   "PCS2","'78117145145592B1'",\
   "PCS3","'F48449F028A065B1'",\
   "PCS4","'E1385509C0B16BED'",\
   "PD7333","'5FFAD8604D9DC00F'",\
   "PD7334","'CDCF262B5EE254E1'",\
   "PD810","'EB04A177A74C6BCB'",\
   "PD811","'3B3C0EFA4F20AC37'",\
   "PD812","'E73A81DB32776026'",\
   "PD9","'CACEB3F9EA16B9B7'",\
   "PDA1","'C7703B70B573D20F'",\
   "PEARL","'E0AFD95B9EBD0261'",\
   "PEG","'20577ED9A8DB8D22'",\
   "PENNY","'BB6103E073D7B811'",\
   "PEOPLE","'139303C8DE6B05A8','613459773123B38A'",\
   "PERCY","'EB9E8B33A2DDFD11'",\
   "PERFSTAT","'AC98877DE1297365'",\
   "PERRY","'D62B14B93EE176B6'",\
   "PERSTAT","'4D45555910EA2F3A','A68F56FBBCDC04AB'",\
   "PETE","'4040619819A9C76E'",\
   "PEYTON","'B7127140004677FC'",\
   "PHIL","'181446AE258EE2F6'",\
   "PJI","'5024B1B412CD4AB9'",\
   "PJM","'021B05DBB892D11F'",\
   "PLANNING","'71B5C2271B7CFF18'",\
   "PLEX","'99355BF0E53FF635'",\
   "PLSQL","'C4522E109BCF69D0','CF0AD27074D4AC82'",\
   "PM","'72E382A52E89575A','C7A235E6D2AF6018','F67E035BF8352CB4'",\
   "PMI","'A7F7978B21A6F65E'",\
   "PN","'D40D0FEF9C8DC624'",\
   "PO","'355CBEC355C10FEF'",\
   "PO7","'6B870AF28F711204'",\
   "PO8","'7E15FBACA7CDEBEC'",\
   "POA","'2AB40F104D8517A0'",\
   "POLLY","'ABC770C112D23DBE'",\
   "POM","'123CF56E05D4EF3C'",\
   "PON","'582090FD3CC44DA3'",\
   "PORTAL","'','829E23D5AB685EA6','A96255A27EC33614'",\
   "PORTAL30","'969F9C3839672C6D','D373ABE86992BE68'",\
   "PORTAL30_ADMIN","'7AF870D89CABF1C7'",\
   "PORTAL30_DEMO","'CFD1302A7F832068'",\
   "PORTAL30_PS","'333B8121593F96FB'",\
   "PORTAL30_PUBLIC","'42068201613CA6E2'",\
   "PORTAL30_SSO","'882B80B587FCDBC8'",\
   "PORTAL30_SSO_ADMIN","'BDE248D4CCCD015D'",\
   "PORTAL30_SSO_PS","'F2C3DC8003BC90F8'",\
   "PORTAL30_SSO_PUBLIC","'98741BDA2AC7FFB2'",\
   "PORTAL_APP","'831A79AFB0BD29EC','A8DBF597514F207E',''",\
   "PORTAL_DEMO","'86A470CBB8450B7E','A0A3A6A577A931A3',''",\
   "PORTAL_PUBLIC","'6FAB2C7782E2C665','70A9169655669CE8',''",\
   "PORTAL_SSO_PS","'D1FB757B6E3D8E2F'",\
   "POS","'6F6675F272217CF7'",\
   "POWERCARTUSER","'2C5ECE3BEC35CE69'",\
   "PPM1","'AA4AE24987D0E84B'",\
   "PPM2","'4023F995FF78077C'",\
   "PPM3","'12F56FADDA87BBF9'",\
   "PPM4","'84E17CB7A3B0E769'",\
   "PPM5","'804C159C660F902C'",\
   "PRIMARY","'70C3248DFFB90152'",\
   "PRISTB733","'1D1BCF8E03151EF5'",\
   "PRISTCTL","'78562A983A2F78FB'",\
   "PRISTDTA","'3FCBC379C8FE079C'",\
   "PRODB733","'9CCD49EB30CB80C4'",\
   "PRODCTL","'E5DE2F01529AE93C'",\
   "PRODDTA","'2A97CD2281B256BA'",\
   "PRODUSER","'752E503EFBF2C2CA'",\
   "PROJMFG","'34D61E5C9BC7147E','A2E05D2F73A62C69'",\
   "PRP","'C1C4328F8862BC16'",\
   "PS","'0AE52ADF439D30BD'",\
   "PS810","'90C0BEC7CA10777E'",\
   "PS810CTL","'D32CCE5BDCD8B9F9'",\
   "PS810DTA","'AC0B7353A58FC778'",\
   "PS811","'B5A174184403822F'",\
   "PS811CTL","'18EDE0C5CCAE4C5A'",\
   "PS811DTA","'7961547C7FB96920'",\
   "PS812","'39F0304F007D92C8'",\
   "PS812CTL","'E39B1CE3456ECBE5'",\
   "PS812DTA","'3780281C933FE164'",\
   "PSA","'FF4B266F9E61F911'",\
   "PSB","'28EE1E024FC55E66'",\
   "PSBASS","'F739804B718D4406'",\
   "PSEM","'40ACD8C0F1466A57'",\
   "PSFT","'7B07F6F3EC08E30D'",\
   "PSFTDBA","'E1ECD83073C4E134'",\
   "PSP","'4FE07360D435E2F0'",\
   "PTADMIN","'4C35813E45705EBA'",\
   "PTCNE","'463AEFECBA55BEE8'",\
   "PTDMO","'251D71390034576A'",\
   "PTE","'380FDDB696F0F266'",\
   "PTESP","'5553404C13601916'",\
   "PTFRA","'A360DAD317F583E3'",\
   "PTG","'7AB0D62E485C9A3D'",\
   "PTGER","'C8D1296B4DF96518'",\
   "PTJPN","'2159C2EAF20011BF'",\
   "PTUKE","'D0EF510BCB2992A3'",\
   "PTUPG","'2C27080C7CC57D06'",\
   "PTWEB","'8F7F509D4DC01DF6'",\
   "PTWEBSERVER","'3C8050536003278B'",\
   "PUBLIC","''",\
   "PUBSUB","'80294AE45A46E77B'",\
   "PUBSUB1","'D6DF5BBC8B64933E'",\
   "PV","'76224BCC80895D3D'",\
   "PY7333","'2A9C53FE066B852F'",\
   "PY7334","'F3BBFAE0DDC5F7AC'",\
   "PY810","'95082D35E94B88C2'",\
   "PY811","'DC548D6438E4D6B7'",\
   "PY812","'99C575A55E9FDA63'",\
   "PY9","'B8D4E503D0C4FCFD'",\
   "QA","'C7AEAA2D59EB1EAE'",\
   "QDBA","'AE62CB8167819595'",\
   "QOT","'B27D0E5BA4DC8DEA'",\
   "QP","'10A40A72991DCA15'",\
   "QRM","'098286E4200B22DE'",\
   "QS","'4603BCD2744BDE4F','8B09C6075BDF2DC4','ACBD635B3A25405D'",\
   "QS_ADM","'3990FB418162F2A0','991CDDAD5C5C32CA','BB424460EFEC9080'",\
   "QS_CB","'870C36D8E6CD7CF5','A2A1265A6BDC8F36','CF9CFACF5AE24964'",\
   "QS_CBADM","'20E788F9D4F1D92C','58C823BA7A2D3D7F','7C632AFB71F8D305'",\
   "QS_CS","'2CA6D0FC25128CF3','5D85C7E8FB28375F','91A00922D8C0F146'",\
   "QS_ES","'723007181C44715C','9A5F2D9F5D1A9EF4','E6A6FA4BB042E3C2'",\
   "QS_OS","'0EF5997DC2638A61','7ABBCF4BEB7854B2','FF09F3EB14AE5C26'",\
   "QS_WS","'0447F2F756B4F460','24ACF617DD7D8F2F','8CF13718CDC81090'",\
   "RE","'933B9A9475E882A6'",\
   "RECOVERY_CATALOG_OWNER","''",\
   "RENE","'9AAD141AB0954CF0'",\
   "REPADMIN","'915C93F34954F5F8'",\
   "REPORTS","'0D9D14FE6653CF69'",\
   "REPORTS_USER","'0E4C268A7FDCC9B8','635074B4416CD3AC'",\
   "REP_MANAGER","'2D4B13A8416073A1','95BAF261774B369C'",\
   "REP_OWNER","'88D8F06915B1FE30','BD99EC2DD84E3B5C'",\
   "REP_USER","'3A7876CB41F01F76','57F2A93832685ADB'",\
   "RESOURCE","''",\
   "RESTRICTED_US","'E7E67B60CFAFBB2D'",\
   "RG","'0FAA06DA0F42F21F'",\
   "RHX","'FFDF6A0C8C96E676'",\
   "RLA","'C1959B03F36C9BB2'",\
   "RLM","'4B16ACDA351B557D'",\
   "RM1","'CD43500DAB99F447'",\
   "RM2","'2D8EE7F8857D477E'",\
   "RM3","'1A95960A95AC2E1D'",\
   "RM4","'651BFD4E1DE4B040'",\
   "RM5","'FDCC34D74A22517C'",\
   "RMAIL","'DA4435BBF8CAE54C'",\
   "RMAN","'E7B5D92911C831E1'",\
   "ROB","'94405F516486CA24'",\
   "RPARKER","'CEBFE4C41BBCC306'",\
   "RRS","'5CA8F5380C959CA9'",\
   "RWA1","'B07E53895E37DBBB'",\
   "SALLYH","'21457C94616F5716'",\
   "SAM","'4B95138CB6A4DB94'",\
   "SAMPLE","'E74B15A3F7A19CA8'",\
   "SAP","'B1344DC1B5F3D903','B8C55254778AE10B','BEAA1036A464F9F0'",\
   "SAPR3","'1D214211EEF96D27'",\
   "SAPR3","'58872B4319A76363'",\
   "SARAHMANDY","'60BE21D8711EE7D9'",\
   "SCHEDULER_ADMIN","''",\
   "SCM1","'507306749131B393'",\
   "SCM2","'CBE8D6FAC7821E85'",\
   "SCM3","'2B311B9CDC70F056'",\
   "SCM4","'1FDF372790D5A016'",\
   "SCOTT","'0EF8B8275E62FBC6','2B82BB92B7BAFEAE',\
            '304FAFF914ED9687','413A5223BF1C8E9D',\
            '5021684F3A79E626','8D10A47746895F7D',\
            '99C3BAB00CD5A4C4','C6F5C1B00321EE3C',\
            'CDC57F9E62A38D03','DDB2B1FA21979374',\
            'F4FCC62BBAEF2DA2','7AA1A84E31ED7771','F894844C34402B67'",\
   "SDAVIS","'A9A3B88C6A550559'",\
   "SDOS_ICSAP","'C789210ACC24DA16'",\
   "SECDEMO","'009BBE8142502E10'",\
   "SEDWARDS","'00A2EDFD7835BC43'",\
   "SELECT_CATALOG_ROLE","''",\
   "SELLCM","'8318F67F72276445'",\
   "SELLER","'B7F439E172D5C3D0'",\
   "SELLTREAS","'6EE7BA85E9F84560'",\
   "SERVICECONSUMER1","'183AC2094A6BD59F'",\
   "SERVICES","'53C01F2A47CFCEC7','B2BE254B514118A5'",\
   "SETUP","'9EA55682C163B9A3'",\
   "SH","'1729F80C5FA78841','54B253CBBAAA8C48','9793B3777CD3BD1A',\
         '9793B3777CD3BD1A'",\
   "SID","'CFA11E6EBA79D33E'",\
   "SITEMINDER","'061354246A45BBAB'",\
   "SI_INFORMTN_SCHEMA","'84B8CBCA4D477FA3'",\
   "SKAYE","'ED671B63BDDB6B50'",\
   "SKYTETSUKA","'EB5DA777D1F756EC'",\
   "SLIDE","'C212C77247233C97','FDFE8B904875643D'",\
   "SLSAA","'99064FC6A2E4BBE8'",\
   "SLSMGR","'0ED44093917BE294'",\
   "SLSREP","'847B6AAB9471B0A5'",\
   "SPATIAL_CSW_ADMIN","'093913703800E437'",\
   "SPATIAL_CSW_ADMIN_USR","'1B290858DD14107E'",\
   "SPATIAL_WFS_ADMIN","'32FA36DC781579AA'",\
   "SPATIAL_WFS_ADMIN_USR","'7117215D6BEE6E82'",\
   "SPIERSON","'4A0A55000357BB3E'",\
   "SRABBITT","'85F734E71E391DF5'",\
   "SRALPHS","'975601AA57CBD61A'",\
   "SRAY","'C233B26CFC5DC643'",\
   "SRIVERS","'95FE94ADC2B39E08'",\
   "SSA1","'DEE6E1BEB962AA8B'",\
   "SSA2","'96CA278B20579E34'",\
   "SSA3","'C3E8C3B002690CD4'",\
   "SSC1","'4F7AC652CC728980'",\
   "SSC2","'A1350B328E74AE87'",\
   "SSC3","'EE3906EC2DA586D8'",\
   "SSOSDK","'7C48B6FF3D54D006'",\
   "SSP","'87470D6CE203FB4D'",\
   "SSS1","'E78C515C31E83848'",\
   "STARTER","'6658C384B8D63B0A'",\
   "STRAT_USER","'25952BD04E577A28'",\
   "STRAT_USER","'AEBEDBB4EFB5225B'",\
   "STRMADMIN","'C1B83B7A8FB89B8E'",\
   "SUPPLIER","'2B45928C2FE77279'",\
   "SVM7333","'04B731B0EE953972'",\
   "SVM7334","'62E2A2E886945CC8'",\
   "SVM810","'0A3DCD8CA3B6ABD9'",\
   "SVM811","'2B0CD57B1091C936'",\
   "SVM812","'778632974E3947C9'",\
   "SVM9","'552A60D8F84441F1'",\
   "SVMB733","'DD2BFB14346146FE'",\
   "SVP1","'F7BF1FFECE27A834'",\
   "SWPRO","'4CB05AA42D8E3A47'",\
   "SWUSER","'783E58C29D2FC7E1'",\
   "SY810","'D56934CED7019318'",\
   "SY811","'2FDC83B401477628'",\
   "SY812","'812B8D7211E7DEF1'",\
   "SY9","'3991E64C4BC2EC5D'",\
   "SYMPA","'E7683741B91AF226'",\
   "SYS","'0B4409DDD5688913','12CFB5AE1D087BA3','1FA22316B703EBDD',\
          '2563EFAAE44E785A','2905ECA56A830226','3522F32DD32A9706',\
          '380E3D3AD5CE32D4','41B328CA13F70713','43BE121A2A135FF3',\
          '4DE42795E66117AE','5638228DAF52805F','57D7CFA12BB5BABF',\
          '5AC333703DE0DBD4','64074AF827F4B74A','66BC3FF56063CE97',\
          '691C5E7E424B821A','6CFF570939041278','8A8F025737A9097A',\
          'A9A57E819B32A03D','BE29E31B2B0EDA33','D4C5016086B2DC6A',\
          'E7686462E8CD2F5E','43CA255A7916ECFE','4DE42795E66117AE'",\
   "SYS7333","'D7CDB3124F91351E'",\
   "SYS7334","'06959F7C9850F1E3'",\
   "SYSADM","'BA3E855E93B5B9B0'",\
   "SYSADMIN","'617AB7EBB43E8584','DC86E8DEAA619C1A',''",\
   "SYSB733","'7A7F5C90BEC02F0E'",\
   "SYSMAN","'447B729161192C24','639C32A115D2CA57','EB258E708132DD2D'",\
   "SYSTEM","'02AB2DB93C952A8F','10B0C2DA37E11872','135176FFB5BA07C9',\
             '1B9F1F9A5CB9EB31','203CD8CF183E716C','2D594E86F93B17A1',\
             '4438308EE0CAFB7F','4861C2264FB17936','49B70B505DF0247F',\
             '604101D3AACE7E88','66A490AEAA61FF72','685657E9DC29E185',\
             '69C27FA786BA774C','86FDB286770CD4B9','8BF0DA8E551DE1B9',\
             '970BAA5B81930A40','B171042374D7E6A2','B49C4279EBD8D1A8',\
             'D4DF7931AB130E37','D5DD57A09A63AA38','D7C18B3B3F2A4D4B',\
             'E4519FCD3A565446','FAAD7ADAF48B5F45','4D27CA6E3E3066E6',\
             '970BAA5B81930A40'",\
   "TAHITI","'F339612C73D27861'",\
   "TALBOT","'4BB1980EADF9783D','905475E949CF2703'",\
   "TDEMARCO","'CAB71A14FA426FAE'",\
   "TDOS_IC","'598BB533E3608A65','7C0900F751723768''CF33DC537C6B54EB'",\
   "TDOS_ICSAP","'7C0900F751723768'",\
   "TEC","'0AF5D1F0069BEAB4','9699CFD34358A7A7'",\
   "TEST","'26ED9DD4450DD33C','7A0F2B316C212D67'",\
   "TESTCTL","'205FA8DF03A1B0A6'",\
   "TESTDTA","'EEAF97B5F20A3FA3'",\
   "TESTPILOT","'DE5B73C964C7B67D'",\
   "TEST_USER","'C0A0F776EBBBB7FB'",\
   "THINSAMPLE","'057DD96CD473F5D4'",\
   "THINSAMPLE","'5DCD6E2E26D33A6E'",\
   "TIBCO","'ED4CDE954630FA82'",\
   "TIP37","'B516D9A33679F56B'",\
   "TOM","'0473A0A9140BFBD7'",\
   "TRA1","'BE8EDAE6464BA413'",\
   "TRACESRV","'8BBA10A8C4978A46','D3DB39EB03F95991','D749D821EADC7F72',\
               'F9DA8977092B7B81'",\
   "TRAVEL","'97FD0AE6DFF0F5FE'",\
   "TRBM1","'B10ED16CD76DBB60'",\
   "TRCM1","'530E1F53715105D0'",\
   "TRDM1","'FB1B8EF14CF3DEE7'",\
   "TRRM1","'4F29D85290E62EBE'",\
   "TSDEV","'29268859446F5A8C'",\
   "TSMSYS","'3DF26A8B17D0F29F'",\
   "TSUSER","'90C4F894E2972F08'",\
   "TURBINE","'76F373437F33F347'",\
   "TWILLIAMS","'6BF819CE663B8499'",\
   "UDDISYS","'BF5E56915C3E1C64','D23FFFD39DDCD8E7',''",\
   "ULTIMATE","'4C3F880EFA364016'",\
   "UM_ADMIN","'F4F306B7AEB5B6FC'",\
   "UM_CLIENT","'82E7FF841BFEAB6C'",\
   "URRP1020","'1CB42F32E93645B7'",\
   "USER","'74085BE8A9CF16B4'",\
   "USER0","'8A0760E2710AB0B4'",\
   "USER1","'BBE7786A584F9103'",\
   "USER2","'1718E5DBB8F89784'",\
   "USER3","'94152F9F5B35B103'",\
   "USER4","'2907B1BFA9DA5091'",\
   "USER5","'6E97FCEA92BAA4CB'",\
   "USER6","'F73E1A76B1E57F3D'",\
   "USER7","'3E9C94488C1A3908'",\
   "USER8","'D148049C2780B869'",\
   "USER9","'0487AFEE55ECEE66'",\
   "USER_NAME","'8D0673831A1EEE3C','96AE343CA71895DA'",\
   "USUARIO","'1AB4E5FD2217F7AA','A86FAC067959A954'",\
   "UTILITY","'81F2423D6811246D'",\
   "UTLBSTATU","'860CAE203220650B','C42D1FA3231AB025'",\
   "VEA","'D38D161C22345902'",\
   "VEH","'72A90A786AAE2914'",\
   "VERTEX_LOGIN","'DEF637F1D23C0C59'",\
   "VIDEO","'9A0AEE2025253A9F','A5184D0B000B428D'",\
   "VIDEO31","'2FA72981199F9B97'",\
   "VIDEO4","'9E9B1524C454EEDE'",\
   "VIDEO5","'748481CFF7BE98BB'",\
   "VIDEOUSER","'29ECA1F239B0F7DF','DFD5879F36D78951'",\
   "VIF_DEVELOPER","'2EA768BF437E4096','9A7DCB0C1D84C488'",\
   "VIRUSER","'404B03707BF5CEA3'",\
   "VP1","'3CE03CD65316DBC7'",\
   "VP2","'FCCEFD28824DFEC5'",\
   "VP3","'DEA4D8290AA247B2'",\
   "VP4","'F4730B0FA4F701DC'",\
   "VP5","'7DD67A696734AE29'",\
   "VP6","'45660DEE49534ADB'",\
   "VPD_ADMIN","'571A7090023BCD04','F97BACA1EBF1F7A8'",\
   "VRR1","'3D703795F61E3A9A','3DA1893A5FCA23BF','811C49394C921D66'",\
   "WAA1","'CF013DC80A9CBEE3'",\
   "WAA2","'6160E7A17091741A'",\
   "WCRSYS","'090263F40B744BD8'",\
   "WEBCAL01","'C69573E9DEC14D50'",\
   "WEBDB","'D4C4DCDD41B05A5D'",\
   "WEBREAD","'F8841A7B16302DE6'",\
   "WEBSYS","'54BA0A1CB5994D64','924E47936BA82A6E','A97282CE3D94E29E'",\
   "WEBUSER","'5EDCA6272C852B42','FD0C7DB4C69FA642'",\
   "WENDYCHO","'7E628CDDF051633A'",\
   "WEST","'DD58348364219102'",\
   "WFADMIN","'C909E4F104002876'",\
   "WFS_USR_ROLE","'094C14AA84362687'",\
   "WH","'91792EFFCB2464F9'",\
   "WIP","'D326D25AE0A0355C'",\
   "WIRELESS","'1495D279640E6C3A','EB9615631433603E','F006CC82E71AB85E',''",\
   "WKADMIN","'888203D36F64C5F6'",\
   "WKPROXY","'18F0B0E50B9F7B12','AA3CB2A4D9188DDB','B97545C4DD2ABE54'",\
   "WKSYS","'545E13456B7DDEA0','69ED49EE1851900D'",\
   "WKUSER","'','8B104568E259B370'",\
   "WK_PROXY","'097C4AC8B49EF06C','1BC62ACE12991581','3B541016A1B75A14',\
               '1BC62ACE12991581','3F9FBD883D787341'",\
   "WK_SYS","'636D90ECD275427C','96A9D8A4A96838FB','FA38AEA068D97C15',\
             '79DF7A1BD138CF11'",\
   "WK_TEST","'29802572EB547DBF'",\
   "WMS","'D7837F182995E381'",\
   "WMSYS","'7C9BA362F8314299'",\
   "WM_ADMIN_ROLE","''",\
   "WOB","'D27FA6297C0313F4'",\
   "WPS","'50D22B9D18547CF7'",\
   "WSH","'D4D76D217B02BD7A'",\
   "WSM","'750F2B109F49CC13'",\
   "WWW","'6DE993A60BC8DBBF'",\
   "WWWUSER","'F239A50072154BAC'",\
   "XADEMO","'ADBC95D8DCC69E66'",\
   "XDB","'5716C02D9127A5C3','FD6C945857807E3C','88D8364765FCE6AF'",\
   "XDBADMIN","''",\
   "XDB_SET_INVOKER","''",\
   "XDB_WEBSERVICES","''",\
   "XDB_WEBSERVICES_OVER_HTTP","''",\
   "XDB_WEBSERVICES_WITH_PUBLIC","''",\
   "XDO","'E9DDE8ACFA7FE8E4'",\
   "XDP","'F05E53C662835FA2'",\
   "XLA","'2A8ED59E27D86D41'",\
   "XLE","'CEEBE966CC6A3E39'",\
   "XNB","'03935918FA35C993'",\
   "XNC","'BD8EA41168F6C664'",\
   "XNI","'F55561567EF71890'",\
   "XNM","'92776EA17B8B5555'",\
   "XNP","'3D1FB783F96D1F5E'",\
   "XNS","'FABA49C38150455E'",\
   "XPRT","'0D5C9EFC2DFE52BA'",\
   "XS$NULL","'7291DF1D260B95B2'",\
   "XS$NULL","'DC4FCC8CB69A6733'",\
   "XTR","'A43EE9629FA90CAE'",\
   "YCAMPOS","'C3BBC657F099A10F'",\
   "YSADMIN","'3523114A59893E7E'",\
   "YSANCHEZ","'E0C033C4C8CC9D84'",\
   "ZFA","'742E092A27DDFB77'",\
   "ZPB","'CAF58375B6D06513'",\
   "ZSA","'AFD3BD3C7987CBB6'",\
   "ZX","'7B06550956254585'",\
   "_NEXT_USER","''")

 debug ' Inside TLsecure module, checking for users with well a known password'
 write '---+ List of Users with a Well Known Password'
 prefix
  write '|*User Name*|*Comment*|'
 var $sql = undef
 set $cod
 {SELECT '|' ||
 "       name || ' |' ||
 "       DECODE (astatus,8,'LOCKED',9,'LOCKED',10,'LOCKED',' ') || '|'
 " FROM sys.user$
 " WHERE name = ':1'
 "   AND password IN (:2);
 }

 loop $nam (keys(%tbl))
  var $sql = join("\012",$sql,bindSql($cod,$nam,$tbl{$nam}))
 call writeSql($sql)
 if !hasOutput(true)
  write 'No occurrences found%BR%'
 write $TOP
}

=head2 D_NV - Users not Visible in dba_users

Lists users from C<sys.user$> table who are not visible in the C<dba_users>
view.

=cut

macro DB_not_visible
{import $TOP

 debug ' Inside TLsecure module, checking for not visble users'
 write '---+ List of Users not Visible in dba_users'
 prefix
  write '|*User Name*|'
 set $sql
 {SELECT '|' || name || ' |'
 " FROM sys.user$
 " WHERE type# = 1
 "MINUS
 "SELECT '|' || username || ' |'
 " FROM dba_users;
 }
 call writeSql($sql)
 if !hasOutput(true)
  write 'No occurrences found%BR%'
 write $TOP
}

=head2 DB_OS - Operating System Authenticated Users with a Password

Lists users who are identified externally but who does not have C<EXTERNAL> as
the password. It considers all user names that start with the 
C<os_authent_prefix> value.

=cut

macro DB_os_password
{import $TOP

 debug ' Inside TLsecure module, checking OS authenticated users'
 write '---+ List Operating System Authenticated Users with a Password'
 prefix
  write '|*User Name*|'
 set $sql
 {SELECT '|' || u.name || ' |'
 " FROM sys.user$ u
 " WHERE u.name LIKE CONCAT((SELECT NVL(value,'')
 "                            FROM v$parameter p
 "                            WHERE p.name = 'os_authent_prefix'),'%')
 "   AND u.password != 'EXTERNAL';
 }
 call writeSql($sql)
 if !hasOutput(true)
  write 'No occurrences found%BR%'
 write $TOP
}

=head2 D_PG - Privileges not granted by their Owner

Lists the privileges that have not been granted by their owner. It reports the
receiver of the privilege, the granter, and the owner.

=cut

macro DB_grants
{import $TOP

 debug ' Inside TLsecure module, checking privileges not granted by owner'
 write '---+ List of Privileges not Granted by their Owner'
 prefix
  write '|*Grantee*|*Grantor*|*Owner*|*Privilege*|*Table*|'
 set $sql
 {SELECT '|' ||
 "       grantee || ' |' ||
 "       grantor || ' |' ||
 "       owner || ' |' ||
 "       privilege || ' |' ||
 "       table_name || ' |'
 " FROM dba_tab_privs
 " WHERE grantor != owner;
 }
 call writeSql($sql)
 if !hasOutput(true)
  write 'No occurrences found%BR%'
 write $TOP
}

=head2 D_UP - Users and Privileges from gv$pwfile_users

Lists the users who have been granted SYSDBA and SYSOPER privileges as derived
from the password file.

=cut

macro DB_pwfile
{import $TOP

 debug ' Inside TLsecure module, checking for users from gv$pwfile_users'
 write '---+ List of Users and Privileges from gv$pwfile_users'
 prefix
  write '| *Instance*|*User Name*|*Sysdba*|*Sysoper*|'
 set $sql
 {SELECT '| ' ||
 "       inst_id || '|' ||
 "       username || ' |' ||
 "       sysdba || ' |' ||
 "       sysoper || ' |'
 " FROM gv$pwfile_users
 " ORDER BY inst_id,username;
 }
 call writeSql($sql)
 if !hasOutput(true)
  write 'No occurrences found%BR%'
 write $TOP
}

=head2 D_ST - Users with SYSTEM as Default Tablespace

Lists users who have C<SYSTEM> as the default tablespace. It skips the C<sys>
and C<system> users.

=cut

macro DB_system
{import $TOP

 debug ' Inside TLsecure module, checking for users with system tablespace'
 write '---+ List of Users with SYSTEM as Default Tablespace'
 write 'Note: SYS and SYSTEM are excluded'
 write
 prefix
  write '|*User Name*|'
 set $sql
 {SELECT '|' ||  u.name || ' |'
 " FROM sys.user$ u,sys.ts$ d
 " WHERE u.datats# = d.ts#
 "   AND u.type# = 1
 "   AND u.name not in ('SYS','SYSTEM')
 "   AND d.name = 'SYSTEM'
 " ORDER BY u.name;
 }
 call writeSql($sql)
 if !hasOutput(true)
  write 'No occurrences found%BR%'
 write $TOP
}

#------------------------------------------------------------------------------
# Listener Checks
#------------------------------------------------------------------------------

# Check the listener file
macro check_listener_file
{var (\%tnp,\%tpl,\%trt,$fil) = @arg

 var $pat = '^(INBOUND_CONNECT_TIMEOUT_|LOG_DIRECTORY_|\
               LOG_FILE_|LOGGING_|SAVE_CONFIG_ON_STOP_|\
               SID_LIST_|STARTUP_WAIT_TIME_|TRACE_DIRECTORY_|\
               TRACE_FILE_|TRACE_FILELEN_|TRACE_FILENO_|TRACE_LEVEL_|\
               TRACE_TIMESTAMP_)(.*)$'

 if createBuffer('BUF','R',$fil)
 {# Parse the file
  var ($key,@lin) = ('')
  while getLine('BUF')
  {var $lin = chomp(last)
   if match($lin,'^(\s*#|\s*$)')
   {if $key
     var $def{$key} = join('',@lin)
    var ($key,@lin) = ('')
    next
   }
   if match($lin,'^\s*([\.\w]+)\s*=\s*(.*)')
   {var ($nxt,$lin) = last
    if $key
     var $def{$key} = join('',@lin)
    var ($key,@lin) = (uc($nxt))
   }
   if $lin
    var @lin = (@lin,$lin)
  }
  if $key
   var $def{$key} = join('',@lin)
  call deleteBuffer('BUF')

  # Analyze the listeners
  loop $key (keys(%def))
  {var $val = replace($def{$key},'\s+','',true)
   if match($val,'^\(DESCRIPTION(_LIST)?=',true) #)
    var $nam = $key
   elsif match($val,'^\(ADDRESS=',true) #)
    var $nam = $key
   elsif match($key,$pat)
    var (undef,$nam) = last
   else
    next

   if missing($def{concat('PASSWORDS_',$nam)})
    var $cnp{$nam} = 1
   elsif !match($def{concat('LOCAL_OS_AUTHENTICATION_',$nam)},'^OFF$',true)
    var $cpl{$nam} = 1
   if !match($def{concat('ADMIN_RESTRICTIONS_',$nam)},'^ON$',true)
    var $crt{$nam} = 1
  }

  # Summarize the findings
  if join('%BR%',keys(%cnp))
   var $tnp{$fil} = concat(last,'|')
  else
   var $tnp{$fil} = ' |No occurrences found'
  if join('%BR%',keys(%cpl))
   var $tpl{$fil} = concat(last,'|')
  else
   var $tpl{$fil} = ' |No occurrences found'
  if join('%BR%',keys(%crt))
   var $trt{$fil} = concat(last,'|')
  else
   var $trt{$fil} = ' |No occurrences found'
 }
}

=head2 L_NP - Listeners without a Password

Reports the name of the listeners without associated passwords present in
the listener.ora files from well known locations. You can specify extra files
with the C<SECURE_LISTENER> setting.

Privileged operations, such as saving configuration changes or stopping the
listener, used from the Listener Control utility, will require a password when
it is set in the appropriate F<listener.ora> file.

=cut

=head2 L_OS - Listeners with Local Operating System Authentication

This check is applicable only for Oracle Database 10g and later.

Reports the name of the listeners with a password but where the local operating
system authentication is not disabled. In such contexts, the user who is
running the listener can administer the listener without providing the password.
It checks all listener.ora files from well known locations. You can specify
extra files with the C<SECURE_LISTENER> setting.

=head2 L_RT - Listeners Modifiable at Runtime

Reports the name of the listeners that do not have ON as the value for
C<ADMIN_RESTRICTIONS>. It checks all F<listener.ora> files from well known
locations. You can specify extra files with the C<SECURE_LISTENER> setting.

Setting C<ADMIN_RESTRICTIONS_E<lt>listener_nameE<gt>=ON> disables the runtime
modification of parameters in F<listener.ora>. That is, the listener refuses
to accept SET commands that alter its parameters.

=cut

macro LSN_checks
{var ($chk) = @arg
 import $ORACLE_HOME,$TOP

 debug ' Inside TLsecure module, checking listener security risks'

 # List of listener file on well known locations
 var @fil = (\
  catFile($ORACLE_HOME,'bin','listener.ora'),\
  catFile('/etc','listener.ora'),\
  catFile('/var/opt/oracle','listener.ora'),\
  catFile($ORACLE_HOME,'network','admin','listener.ora'),\
  catFile($ORACLE_HOME,'network','agent','listener.ora')\
  )
 if getEnv('TNS_ADMIN')
 {if !sameFile('ne',catFile(last,'listener.ora'),$fil[3])
   var $fil[5] =lastFile()
 }
 if getSetting('SECURE_LISTENER')
 {loop $fil (split('\|',last))
  {if $fil
    var @fil = (@fil,catFile($fil))
  }
 }

 # Get the required data from files
 var (%tnp,%tpl,%trt) = ()
 loop $fil (@fil)
 {next !and($fil,testFile('f',catFile($fil)))
  var $fil = lastFile()
  debug ' - Checking ',$fil

  if !testFile('r',$fil)
  {var $err = 'Unreadable file'
   var ($lnp{$fil},$lpl{$fil},$lmr{$fil}) = $err
  }
  else
   call check_listener_file(\%tnp,\%tpl,\%trt,$fil)
 }

 # Report listeners without a password
 if match($chk,'np')
 {write '---+ Listeners without a Password'
  prefix
   write '|*File*|*Listeners*|*Comment*|'
  loop $key (keys(%tnp))
   write '|', encode($key),' |',$tnp{$key},' |'
  if !hasOutput(true)
   write 'No listener.ora found in well known locations%BR%'
  write $TOP
 }

 # Report listeners with password and LOCAL_OS_AUTHENTICATION is not OFF
 if match($chk,'pl')
 {write '---+ Listeners with Local Operating System Authentication'
  prefix
   write '|*File*|*Listeners*|*Comment*|'
  loop $key (keys(%tpl))
   write '|',encode($key),' |',$tpl{$key},' |'
  if !hasOutput(true)
   write 'No listener.ora found in well known locations%BR%'
  write $TOP
 }

 # Report listeners that can be modified at runtime
 if match($chk,'rt')
 {write '---+ Listeners Modifiable at Runtime'
  prefix
   write '|*File*|*Listeners*|*Comment*|'
  loop $key (keys(%trt))
   write '|',encode($key),' |',$trt{$key},' |'
  if !hasOutput(true)
   write 'No listener.ora found in well known locations%BR%'
  write $TOP
 }
}

#------------------------------------------------------------------------------
# Sqlnet Checks
#------------------------------------------------------------------------------

=head2 N_AS - AUTHENTICATION_SERVICES Values in sqlnet.ora Files

Reports the current value of C<SQLNET.AUTHENTICATION_SERVICES> from sqlnet.ora
files found in well known locations. You can specify extra files with the
C<SECURE_SQLNET> setting.

The process of restricting sysdba access with a password only is controlled
by the parameter C<SQLNET.AUTHENTICATION_SERVICES> in the F<sqlnet.ora> file.
If this parameter is set to NONE, then the auto login of the SYSDBA role is
disabled.

A security method that enables you to have high confidence in the identity of
users, clients, and servers in distributed environments. Network authentication
methods can provide the benefit of single sign-on for users also. Oracle
Advanced Security must be installed.

=cut

macro NET_checks
{import $ORACLE_HOME,$TOP

 debug ' Inside TLsecure module, checking sqlnet.ora security risks'

 # List of sqlnet.ora file on well known locations
 var @fil = (\
  catFile($ORACLE_HOME,'bin','sqlnet.ora'),\
  catFile('/etc','sqlnet.ora'),\
  catFile('/var/opt/oracle','sqlnet.ora'),\
  catFile($ORACLE_HOME,'network','admin','sqlnet.ora'),\
  catFile($ORACLE_HOME,'network','agent','sqlnet.ora')\
  )
 if getEnv('TNS_ADMIN')
 {if !sameFile('ne',catFile(last,'sqlnet.ora'),$fil[3])
   var $fil[5] =lastFile()
 }
 if getSetting('SECURE_SQLNET')
 {loop $fil (split('\|',last))
  {if $fil
    var @fil = (@fil,catFile($fil))
  }
 }

 # Extract the required data from files
 var ($pat,%dsc,%val) = ('^SQLNET.AUTHENTICATION_SERVICES\s*=')
 loop $fil (@fil)
 {next !testFile('f',$fil)
  debug ' - Checking ',$fil
  if !testFile('r',$fil)
   var $dsc{$fil} = 'Unreadable file'
  elsif grepFile($fil,$pat,'f')
   var ($dsc{$fil},$val{$fil}) = (' ',value(last))
  else
   var $dsc{$fil} = 'No occurrences found'
 }

 # Report the values found
 write '---+ List of the AUTHENTICATION_SERVICES Values from sqlnet.ora'
 prefix
  write '|*File*|*Value*|*Comment*|'
 loop $key (keys(%dsc))
  write '|',encode($key),'|',$val{$key},' |',$dsc{$key},'|'
 if !hasOutput(true)
  write 'No sqlnet.ora found in well known locations%BR%'
 write $TOP
}

#------------------------------------------------------------------------------
# Oracle Executable Tests
#------------------------------------------------------------------------------

=head2 O_US - Oracle Executables Owned by Different Users of a Same Group

Lists Oracle executable occurrences that belong to a same group but having
different owners. This check is applicable for UNIX only.

=cut

macro OR_user
{import $TOP

 debug ' Inside TLsecure module, check for same group with different users'
 write '---+ Oracle Executables Owned by Different Users of a Same Group'
 write
 prefix
  write '| *Group ID*| *User ID*|*Executable*|'
 var %tbl = ()
 loop $fil ('/etc/oratab','/var/opt/oracle/oratab')
 {loop $lin (grepFile($fil,'^[^#]'))
  {var (undef,$hom) = split(':',$lin,3)
   if @sta = getStat(catFile($hom,'bin','oracle'))
    var $tbl{$sta[5],$sta[4],encode(lastFile())} = 1
  }
 }
 loop $gid (keys(%tbl,'IA'))
 {var $cnt = @uid = keys($tbl{$gid},'IA')
  if expr('>',$cnt,1)
  {loop $uid (@uid)
    write '| ',$gid,'| ',$uid,'|',join('%BR%',keys($tbl{$gid,$uid})),' |'
  }
 }
 if !hasOutput(true)
  write 'No occurrences found%BR%'
 write $TOP
}

#------------------------------------------------------------------------------
# Main program
#------------------------------------------------------------------------------

echo tput('bold'),'Identification of Potential Security Risks ...',tput('off')

call setAbbr('SEC')

report risks
prefix
{write '---+!! Potential Security Risks'
 write $TOC
}

# Get the check list
if getSetting('TST_ARGS')
 var $arg = last
else
{call requestSetting('TLsecure')
 var $arg = getSetting('SECURE_LIST')
}
if match($arg,'ALL')
 var @opt = ('ALL')
else
 var @opt = split(',',$arg)

# Check database connection
if match($arg,'ALL|\bD_')
{call get_login_info()
 if testSql()
 {echo 'Cannot connect to the database: ',getSqlMessage()
  write 'Cannot connect to the database (',getSqlMessage(),')'
 }
 else
  var $DBVER = get_db_version(false,'10')
}

# Perform the tests
var ($lsn,$net) = ()
loop $opt (@opt)
{if match($opt,'ALL|D_DP')
  call DB_default_pwd()
 if match($opt,'ALL|D_KP')
  call DB_known_pwd()
 if match($opt,'ALL|D_NV')
  call DB_not_visible()
 if match($opt,'ALL|D_OS')
  call DB_os_password()
 if match($opt,'ALL|D_PG')
  call DB_grants()
 if match($opt,'ALL|D_PW')
  call DB_pwfile()
 if match($opt,'ALL|D_ST')
  call DB_system()

 if match($opt,'ALL|L_NP')
  var $lsn = join('|','np',$lsn)
 if match($opt,'ALL|L_PL')
  var $lsn = join('|','pl',$lsn)
 if match($opt,'ALL|L_RT')
  var $lsn = join('|','rt',$lsn)

 if match($opt,'ALL|N_AS')
  var $net = join('|','as',$net)

 if isUnix()
 {if match($opt,'ALL|O_US')
   call OR_user()
 }
}
if $lsn
 call LSN_checks($lsn)
if $net
 call NET_checks($net)

# Render the report
if isCreated(true)
{call renderFile()
 echo 'Result file: ',last
}
else
 echo 'No results'

=head1 WARNING

Any action based on these checks should be performed only after careful
planning and additional analysis. If you are not sure about the action you
intend to perform, you should perform proper analysis to ensure it will not
affect the current functionality.

=head1 SEE ALSO

L<DBinfo.def|modules::DBinfo>

=begin credits

=over 10

=item RDA 4.12:  Francois Lange.

=item RDA 4.13:  Francois Lange, Cameron Melvin.

=back

=end credits

=head1 COPYRIGHT NOTICE

Copyright (c) 2002, 2012, Oracle and/or its affiliates. All rights reserved.

=head1 TRADEMARK NOTICE

Oracle and Java are registered trademarks of Oracle and/or its
affiliates. Other names may be trademarks of their respective owners.

=cut
