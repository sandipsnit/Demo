<!DOCTYPE TargetMetadata SYSTEM "../dtds/TargetMetadata.dtd">
<TargetMetadata META_VER="1.0" TYPE="microsoft_exchange" CATEGORY_PROPERTIES="AgentType">
  <Display>
    <Label NLSID="MS_EXCHANGE_LABEL">Microsoft Exchange Server</Label>
    <Description NLSID="MS_EXCHANGE_DESC">Microsoft Exchange Server</Description>
  </Display>

  <!--  Response  
  Values{"Unknown", "OK", "Warning",
  "Error"},
  ValueMap{"0", "1", "2", "3"}] uint8 ServicesSt

  -->
  <Metric NAME="Response" TYPE="TABLE">
    <Display>
      <Label NLSID="RESPONSE_LBL">Response</Label>
      <Description NLSID="RESPONSE_DESC">Response of the Server</Description>
    </Display>
    <TableDescriptor>
      <ColumnDescriptor NAME="Status" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="RESPONSE_STATUS_LBL">Status</Label>
          <Description NLSID="RESPONSE_STATUS_DESC">Current Status of the Server</Description>
        </Display>
      </ColumnDescriptor>
    </TableDescriptor>

    <ExecutionDescriptor>
      <GetTable NAME="EXCH_EState"/>
      <GetView NAME="STAE_SERVICESSTATE" FROM_TABLE="EXCH_EState">
        <Column NAME="Status"/>
      </GetView>
    </ExecutionDescriptor>      
  </Metric>

  <!-- ********************** -->
  <!-- CONFIG Metrics Start Here -->
  <!-- ********************** --> 
  <!-- ********************** -->

  <!-- Exchange Server -->
  <Metric NAME="EXCH_Server" TYPE="RAW"  CONFIG="TRUE">
    <TableDescriptor TABLE_NAME="MGMT_EXCHANGE_SERVER">
      <ColumnDescriptor NAME="Name"  COLUMN_NAME = "NAME"  TYPE="STRING" IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="AdministrativeGroup"  COLUMN_NAME = "ADMINISTRATIVEGROUP"  TYPE="STRING" IS_KEY="FALSE" />
      <ColumnDescriptor NAME="AdministrativeNote"  COLUMN_NAME = "ADMINISTRATIVENOTE"  TYPE="STRING" IS_KEY="FALSE" />
      <ColumnDescriptor NAME="CreationTime"  COLUMN_NAME = "CREATIONTIME"  TYPE="STRING" IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="DN"  COLUMN_NAME = "DN"  TYPE="STRING" IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="ExchangeVersion"  COLUMN_NAME = "EXCHANGEVERSION"  TYPE="STRING" IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="FQDN"  COLUMN_NAME = "FQDN"  TYPE="STRING" IS_KEY="TRUE"/>
      <ColumnDescriptor NAME="GUID"  COLUMN_NAME = "EXCHANGE_SERVER_WGUID"  TYPE="STRING" IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="IsFrontEndServer"  COLUMN_NAME = "ISFRONTENDSERVER"  TYPE="STRING" IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="LastModificationTime"  COLUMN_NAME = "LASTMODIFICATIONTIME"  TYPE="STRING" IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="MessageTrackingEnabled"  COLUMN_NAME = "MESSAGETRACKINGENABLED"  TYPE="STRING" IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="MessageTrackingLogFileLifetime"  COLUMN_NAME = "MESSAGETRACKINGLOGFILELIFETIME"  TYPE="NUMBER" IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="MessageTrackingLogFilePath"  COLUMN_NAME = "MESSAGETRACKINGLOGFILEPATH"  TYPE="STRING" IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="MonitoringEnabled"  COLUMN_NAME = "MONITORINGENABLED"  TYPE="STRING" IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="MTADataPath"  COLUMN_NAME = "MTADATAPATH"  TYPE="STRING" IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="RoutingGroup"  COLUMN_NAME = "ROUTINGGROUP"  TYPE="STRING" IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="SubjectLoggingEnabled"  COLUMN_NAME = "SUBJECTLOGGINGENABLED"  TYPE="STRING" IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="Type"  COLUMN_NAME = "TYPE"  TYPE="NUMBER" IS_KEY="FALSE"/>
    </TableDescriptor>
    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="local"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select Name,AdministrativeGroup,AdministrativeNote,CreationTime,DN,ExchangeVersion,FQDN,GUID,IsFrontEndServer,LastModificationTime,MessageTrackingEnabled,MessageTrackingLogFileLifetime,MessageTrackingLogFilePath,MonitoringEnabled,MTADataPath,RoutingGroup,SubjectLoggingEnabled,Type from Exchange_Server where FQDN is not null and name='%DISPLAY_NAME%'</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">name,administrativegroup,administrativenote,creationtime,dn,exchangeversion,fqdn,guid,isfrontendserver,lastmodificationtime,messagetrackingenabled,messagetrackinglogfilelifetime,messagetrackinglogfilepath,monitoringenabled,mtadatapath,routinggroup,subjectloggingenabled,type</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\MicrosoftExchangeV2</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>
    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="remote"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="STDINWBEM_HOST" SCOPE="INSTANCE">Host</Property>
      <Property NAME="STDINWBEM_USERNAME" SCOPE="INSTANCE" OPTIONAL="TRUE">SysUsername</Property>
      <Property NAME="STDINWBEM_PASSWORD" SCOPE="INSTANCE" OPTIONAL="TRUE">SysPassword</Property>
      <Property NAME="ENVWBEM_REMOTE" SCOPE="GLOBAL">1</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select Name,AdministrativeGroup,AdministrativeNote,CreationTime,DN,ExchangeVersion,FQDN,GUID,IsFrontEndServer,LastModificationTime,MessageTrackingEnabled,MessageTrackingLogFileLifetime,MessageTrackingLogFilePath,MonitoringEnabled,MTADataPath,RoutingGroup,SubjectLoggingEnabled,Type from Exchange_Server where FQDN is not null and name='%DISPLAY_NAME%'</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">name,administrativegroup,administrativenote,creationtime,dn,exchangeversion,fqdn,guid,isfrontendserver,lastmodificationtime,messagetrackingenabled,messagetrackinglogfilelifetime,messagetrackinglogfilepath,monitoringenabled,mtadatapath,routinggroup,subjectloggingenabled,type</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\MicrosoftExchangeV2</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>
  </Metric>

  <!-- Advanced Queuing Engine (Internal Queues)(ExchangeLink)(CONFIG METRICS)-->  	
  <Metric NAME="EXCH_Link" TYPE="RAW"  CONFIG="TRUE" >
    <TableDescriptor TABLE_NAME="MGMT_EXCHANGE_LINK">
      <ColumnDescriptor NAME="LinkName" TYPE="STRING"  COLUMN_NAME = "LINKNAME"  IS_KEY="TRUE"/>
      <ColumnDescriptor NAME="LinkDN" TYPE="STRING"  COLUMN_NAME = "LINKDN"  IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="ActionFreeze" TYPE="STRING"  COLUMN_NAME = "ACTIONFREEZE"  IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="ActionKick" TYPE="STRING"  COLUMN_NAME = "ACTIONKICK"  IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="ActionThaw" TYPE="STRING"  COLUMN_NAME = "ACTIONTHAW"  IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="ProtocolName" TYPE="STRING"  COLUMN_NAME = "PROTOCOLNAME"  IS_KEY="TRUE"/>
      <ColumnDescriptor NAME="TypeCurrentlyUnreachable" TYPE="STRING"  COLUMN_NAME = "TYPECURRENTLYUNREACHABLE"  IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="TypeDeferredDelivery" TYPE="STRING"  COLUMN_NAME = "TYPEDEFERREDDELIVERY"  IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="TypeInternal" TYPE="STRING"  COLUMN_NAME = "TYPEINTERNAL"  IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="TypeLocalDelivery" TYPE="STRING"  COLUMN_NAME = "TYPELOCALDELIVERY"  IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="TypePendingCategorization" TYPE="STRING"  COLUMN_NAME = "TYPEPENDINGCATEGORIZATION"  IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="TypePendingRouting" TYPE="STRING"  COLUMN_NAME = "TYPEPENDINGROUTING"  IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="TypePendingSubmission" TYPE="STRING"  COLUMN_NAME = "TYPEPENDINGSUBMISSION"  IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="TypeRemoteDelivery" TYPE="STRING"  COLUMN_NAME = "TYPEREMOTEDELIVERY"  IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="Version" TYPE="NUMBER"  COLUMN_NAME = "VERSION"  IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="VirtualMachine" TYPE="STRING"  COLUMN_NAME = "VIRTUALMACHINE"  IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="VirtualServerName" TYPE="STRING"  COLUMN_NAME = "VIRTUALSERVERNAME"  IS_KEY="TRUE"/>
    </TableDescriptor>
    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="local"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>     
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select LinkName,LinkDN,ActionFreeze,ActionKick,ActionThaw,ExtendedStateInfo,ProtocolName,TypeCurrentlyUnreachable,TypeDeferredDelivery,TypeInternal,TypeLocalDelivery,TypePendingCategorization,TypePendingRouting,TypePendingSubmission,TypeRemoteDelivery,Version,VirtualMachine,VirtualServerName from ExchangeLink where LinkName is not null</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">linkname,linkdn,actionfreeze,actionkick,actionthaw,protocolname,typecurrentlyunreachable,typedeferreddelivery,typeinternal,typelocaldelivery,typependingcategorization,typependingrouting,typependingsubmission,typeremotedelivery,version,virtualmachine,virtualservername</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2\applications\exchange</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>
    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="remote"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="STDINWBEM_HOST" SCOPE="INSTANCE">Host</Property>
      <Property NAME="STDINWBEM_USERNAME" SCOPE="INSTANCE" OPTIONAL="TRUE">SysUsername</Property>
      <Property NAME="STDINWBEM_PASSWORD" SCOPE="INSTANCE" OPTIONAL="TRUE">SysPassword</Property>
      <Property NAME="ENVWBEM_REMOTE" SCOPE="GLOBAL">1</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select LinkName,LinkDN,ActionFreeze,ActionKick,ActionThaw,ExtendedStateInfo,ProtocolName,TypeCurrentlyUnreachable,TypeDeferredDelivery,TypeInternal,TypeLocalDelivery,TypePendingCategorization,TypePendingRouting,TypePendingSubmission,TypeRemoteDelivery,Version,VirtualMachine,VirtualServerName from ExchangeLink where LinkName is not null</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">linkname,linkdn,actionfreeze,actionkick,actionthaw,protocolname,typecurrentlyunreachable,typedeferreddelivery,typeinternal,typelocaldelivery,typependingcategorization,typependingrouting,typependingsubmission,typeremotedelivery,version,virtualmachine,virtualservername</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2\applications\exchange</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>
  </Metric>																																																																					    
  <!-- CONNECTORS Config -->
  <Metric NAME="EXCH_Connectors_CONFIG" TYPE="RAW"  CONFIG="TRUE" >
    <TableDescriptor TABLE_NAME="MGMT_EXCHANGE_CONNECTOR">
      <ColumnDescriptor NAME="Name" TYPE="STRING"  COLUMN_NAME = "NAME"  IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="DN" TYPE="STRING"  COLUMN_NAME = "DN"  IS_KEY="TRUE"/>
      <ColumnDescriptor NAME="GroupDN" TYPE="STRING"  COLUMN_NAME = "GROUPDN"  IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="GroupGUID" TYPE="STRING"  COLUMN_NAME = "GROUPGUID"  IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="GUID" TYPE="STRING"  COLUMN_NAME = "EXCHANGE_CONNECTOR_WGUID"  IS_KEY="FALSE"/>
    </TableDescriptor>
    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="local"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2\applications\exchange</Property>
      <Property NAME="ENVWBEM_PROPERTIES" SCOPE="GLOBAL">Name,DN,GroupDN,GroupGUID,GUID</Property>
      <Property NAME="ENVWBEM_CLASSNAME" SCOPE="GLOBAL">ExchangeConnectorState</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>
    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="remote"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="STDINWBEM_HOST" SCOPE="INSTANCE">Host</Property>
      <Property NAME="STDINWBEM_USERNAME" SCOPE="INSTANCE" OPTIONAL="TRUE">SysUsername</Property>
      <Property NAME="STDINWBEM_PASSWORD" SCOPE="INSTANCE" OPTIONAL="TRUE">SysPassword</Property>
      <Property NAME="ENVWBEM_REMOTE" SCOPE="GLOBAL">1</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2\applications\exchange</Property>
      <Property NAME="ENVWBEM_PROPERTIES" SCOPE="GLOBAL">Name,DN,GroupDN,GroupGUID,GUID</Property>
      <Property NAME="ENVWBEM_CLASSNAME" SCOPE="GLOBAL">ExchangeConnectorState</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>
  </Metric>    

  <!-- Cluster Resources (CONFIG)--> 	  	
  <Metric NAME="EXCH_ClusterRsc_CONFIG" TYPE="RAW"  CONFIG="TRUE" >
    <TableDescriptor TABLE_NAME="MGMT_EXCHANGE_CLUSTERRSC">
      <ColumnDescriptor NAME="Name" TYPE="STRING"  COLUMN_NAME = "NAME"  IS_KEY="TRUE"/>
      <ColumnDescriptor NAME="Owner" TYPE="STRING"  COLUMN_NAME = "OWNER"  IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="Type" TYPE="STRING"  COLUMN_NAME = "TYPE"  IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="VirtualMachine" TYPE="STRING"  COLUMN_NAME = "VIRTUALMACHINE"  IS_KEY="TRUE"/>
    </TableDescriptor>
    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="local"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2\applications\exchange</Property>
      <Property NAME="ENVWBEM_PROPERTIES" SCOPE="GLOBAL">Name,Owner,Type,VirtualMachine</Property>
      <Property NAME="ENVWBEM_CLASSNAME" SCOPE="GLOBAL">ExchangeClusterResource</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>
    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="remote"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="STDINWBEM_HOST" SCOPE="INSTANCE">Host</Property>
      <Property NAME="STDINWBEM_USERNAME" SCOPE="INSTANCE" OPTIONAL="TRUE">SysUsername</Property>
      <Property NAME="STDINWBEM_PASSWORD" SCOPE="INSTANCE" OPTIONAL="TRUE">SysPassword</Property>
      <Property NAME="ENVWBEM_REMOTE" SCOPE="GLOBAL">1</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2\applications\exchange</Property>
      <Property NAME="ENVWBEM_PROPERTIES" SCOPE="GLOBAL">Name,Owner,Type,VirtualMachine</Property>
      <Property NAME="ENVWBEM_CLASSNAME" SCOPE="GLOBAL">ExchangeClusterResource</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>    
  </Metric>

  <!-- DS Access Domain Control (CONFIG) metrics -->  	
  <Metric NAME="EXCH_DSAccess_Config"  TYPE="RAW"  CONFIG="TRUE" >
    <TableDescriptor TABLE_NAME="MGMT_EXCHANGE_DSACCESS">
      <ColumnDescriptor NAME="Name" TYPE="STRING"  COLUMN_NAME = "NAME"  IS_KEY="TRUE"/>
      <ColumnDescriptor NAME="ConfigurationType" TYPE="NUMBER"  COLUMN_NAME = "CONFIGURATIONTYPE"  IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="LDAPPort" TYPE="NUMBER"  COLUMN_NAME = "LDAPPORT"  IS_KEY="FALSE"/>
      <ColumnDescriptor NAME="Type" TYPE="NUMBER"  COLUMN_NAME = "TYPE"  IS_KEY="TRUE"/>
    </TableDescriptor>
    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="local"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select Name,ConfigurationType,LDAPPort,Type from Exchange_DSAccessDC where name is not null</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">name,configurationtype, ldapport,type</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\microsoftexchangev2</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>
    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="remote"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="STDINWBEM_HOST" SCOPE="INSTANCE">Host</Property>
      <Property NAME="STDINWBEM_USERNAME" SCOPE="INSTANCE" OPTIONAL="TRUE">SysUsername</Property>
      <Property NAME="STDINWBEM_PASSWORD" SCOPE="INSTANCE" OPTIONAL="TRUE">SysPassword</Property>
      <Property NAME="ENVWBEM_REMOTE" SCOPE="GLOBAL">1</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select Name,ConfigurationType,LDAPPort,Type from Exchange_DSAccessDC where name is not null</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">name,configurationtype, ldapport,type</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\microsoftexchangev2</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>
  </Metric>

  <!-- ********************** -->
  <!-- PERF Metrics Start Here -->
  <!-- ********************** --> 
  <!-- ********************** -->

  <!-- Exchange - Server State -->
  <Metric NAME="EXCH_EState" TYPE="TABLE">
    <Display>
      <Label NLSID="EXCH_ESTATE_LBL">Exchange - Server State</Label>
      <Description NLSID="EXCH_ESTATE_DESC">Provides the information about the computer running Microsoft Exchange Server</Description>
    </Display>

    <TableDescriptor>

      <ColumnDescriptor NAME="DN" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_ESTATE_DN_LBL">DN</Label>
          <Description NLSID="EXCH_ESTATE_DN_DESC">This property specifies the Microsoft Active Directory distinguished name (DN) of the Exchange server object</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="GroupDN" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_ESTATE_GROUPDN_LBL">Group DN</Label>
          <Description NLSID="EXCH_ESTATE_GROUPDN_DESC">This property specifies the DN of the Exchange Server routing group in Active Directory</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="GroupGUID" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_ESTATE_GROUPGUID_LBL">Group GUID</Label>
          <Description NLSID="EXCH_ESTATE_GROUPGUID_DESC">This property specifies the globally unique identifier (GUID) of the Exchange Server routing group in Active Directory</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="GUID" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_ESTATE_GUID_LBL">GUID</Label>
          <Description NLSID="EXCH_ESTATE_GUID_DESC">This property specifies the GUID of the Exchange Server object in Active Directory</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="ServerMaintenance" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_ESTATE_SERVERMAINTENANCE_LBL">Server Maintenance</Label>
          <Description NLSID="EXCH_ESTATE_SERVERMAINTENANCE_DESC">Indicates if the notifications set up in the Exchange Server System Manager Monitoring and Status page have been disabled</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="ServerStateString" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_ESTATE_SERVERSTATESTRING_LBL">Server State String</Label>
          <Description NLSID="EXCH_ESTATE_SERVERSTATESTRING_DESC">This property specifies the current state of the computer running Exchange Server</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="ServicesState" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_ESTATE_SERVICESSTATE_LBL">Services State</Label>
          <Description NLSID="EXCH_ESTATE_SERVICESSTATE_DESC">This property specifies the current state of the monitoring services running on the Exchange Server computer</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="ServicesStateString" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_ESTATE_SERVICESSTATESTRING_LBL">Services State String</Label>
          <Description NLSID="EXCH_ESTATE_SERVICESSTATESTRING_DESC">This property specifies the current state of the monitoring services running on the Exchange Server computer</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="Status" TYPE="NUMBER" COMPUTE_EXPR="ServicesState>1?0:ServicesState">
        <Display>
          <Label NLSID="EXCH_ESTATE_STATUS_LBL">Server State</Label>
          <Description NLSID="EXCH_ESTATE_STATUS_DESC">Current Status of Microsoft Exchange Server</Description>
        </Display>
      </ColumnDescriptor>

    </TableDescriptor>
    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="local"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select DN, GroupDN, GroupGUID, GUID, ServerMaintenance,  ServerStateString, ServicesState, ServicesStateString from ExchangeServerState where Name='%DISPLAY_NAME%'</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">dn,groupdn,groupguid,guid,servermaintenance,serverstatestring,servicesstate,servicesstatestring</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2\applications\exchange</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>
    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="remote"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="STDINWBEM_HOST" SCOPE="INSTANCE">Host</Property>
      <Property NAME="STDINWBEM_USERNAME" SCOPE="INSTANCE" OPTIONAL="TRUE">SysUsername</Property>
      <Property NAME="STDINWBEM_PASSWORD" SCOPE="INSTANCE" OPTIONAL="TRUE">SysPassword</Property>
      <Property NAME="ENVWBEM_REMOTE" SCOPE="GLOBAL">1</Property>     
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select DN, GroupDN, GroupGUID, GUID, ServerMaintenance,  ServerStateString, ServicesState, ServicesStateString from ExchangeServerState where Name='%DISPLAY_NAME%'</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">dn,groupdn,groupguid,guid,servermaintenance,serverstatestring,servicesstate,servicesstatestring</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2\applications\exchange</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>
  </Metric>

  <!-- TOP Public Folders metrics -->  	  
  <Metric NAME="EXCH_TOP_PFOLDER" TYPE="TABLE">
    <Display>
      <Label NLSID="EXCH_TOP_PFOLDER_LBL">Exchange - Top Sized Public Folders </Label>
      <Description NLSID="EXCH_TOP_PFOLDER_DESC">Exchange - Top Sized Public Folders</Description>
    </Display>

    <TableDescriptor>

      <ColumnDescriptor NAME="Name" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_TOP_PFOLDER_NAME_LBL">Name</Label>
          <Description NLSID="EXCH_TOP_PFOLDER_NAME_DESC">Name of the Public Folder</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="Url" TYPE="STRING" IS_KEY="TRUE">
        <Display>
          <Label NLSID="EXCH_TOP_PFOLDER_URL_LBL">Url</Label>
          <Description NLSID="EXCH_TOP_PFOLDER_URL_DESC">Url of the Public Folder</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="TotalMessageSize" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_TOP_PFOLDER_TOTALMESSAGESIZE_LBL">Total Message Size</Label>
          <Description NLSID="EXCH_TOP_PFOLDER_TOTALMESSAGESIZE_DESC">Total size of the folder in bytes</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="TotalMessageSizeMB" TYPE="NUMBER" COMPUTE_EXPR="TotalMessageSize/(1024*1024)">
        <Display>
          <Label NLSID="EXCH_TOP_PFOLDER_TOTALMESSAGESIZEMB_LBL">Total Message Size (MB)</Label>
          <Description NLSID="EXCH_TOP_PFOLDER_TOTALMESSAGESIZEMB_DESC">Total size of the folder in MB</Description>
        </Display>
      </ColumnDescriptor>

    </TableDescriptor>
    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="local"/>
      </ValidIf>

      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="scriptsDir" SCOPE="SYSTEMGLOBAL">scriptsDir</Property>
      <Property NAME="perlBin" SCOPE="SYSTEMGLOBAL">perlBin</Property>
      <Property NAME="command" SCOPE="GLOBAL">%perlBin%/perl</Property>
      <Property NAME="script" SCOPE="GLOBAL">%scriptsDir%/exchange/top_mailbox.pl publicfolder 5</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="remote"/>
      </ValidIf>	 
      <Property NAME="ENVWBEM_REMOTE" SCOPE="GLOBAL">1</Property>
      <Property NAME="STDINWBEM_HOST" SCOPE="INSTANCE">Host</Property>
      <Property NAME="STDINWBEM_USERNAME" SCOPE="INSTANCE" OPTIONAL="TRUE">SysUsername</Property>
      <Property NAME="STDINWBEM_PASSWORD" SCOPE="INSTANCE" OPTIONAL="TRUE">SysPassword</Property>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="scriptsDir" SCOPE="SYSTEMGLOBAL">scriptsDir</Property>
      <Property NAME="perlBin" SCOPE="SYSTEMGLOBAL">perlBin</Property>
      <Property NAME="command" SCOPE="GLOBAL">%perlBin%/perl</Property>
      <Property NAME="script" SCOPE="GLOBAL">%scriptsDir%/exchange/top_mailbox.pl publicfolder 5</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>

    </QueryDescriptor>
  </Metric>

  <!--  Exchange Mailbox -Gives the Top sized  'n' number of mailboxes-->
  <Metric NAME="EXCH_TOP_MAILBOX" TYPE="TABLE">
    <Display>
      <Label NLSID="EXCH_TOP_MAILBOX_LBL">Exchange - Top Sized Mailboxes</Label>
      <Description NLSID="EXCH_TOP_MAILBOX_DESC">Exchange - Top Sized Mailboxes</Description>
    </Display>
    <TableDescriptor>

      <ColumnDescriptor NAME="MailboxDisplayName" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_TOP_MAILBOX_MAILBOXDISPLAYNAME_LBL">Mailbox Display Name</Label>
          <Description NLSID="EXCH_TOP_MAILBOX_MAILBOXDISPLAYNAME_DESC">Display Name of the Mailbox</Description>
        </Display>
      </ColumnDescriptor> 

      <ColumnDescriptor NAME="MailboxGUID" TYPE="STRING" IS_KEY="TRUE">
        <Display>
          <Label NLSID="EXCH_TOP_MAILBOX_MAILBOXGUID_LBL">Mailbox GUID</Label>
          <Description NLSID="EXCH_TOP_MAILBOX_MAILBOXGUID_DESC">This property indicates the globally unique identifier (GUID) that links the Mailbox to a user in Active Directory</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="Size" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_TOP_MAILBOX_SIZE_LBL">Size (bytes)</Label>
          <Description NLSID="EXCH_TOP_MAILBOX_SIZE_DESC"> The Size property indicates the cumulative size of all of the messages in the Mailbox, in bytes</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="StorageGroupName" TYPE="STRING" IS_KEY="TRUE">
        <Display>
          <Label NLSID="EXCH_TOP_MAILBOX_STORAGEGROUPNAME_LBL">Storage Group Name</Label>
          <Description NLSID="EXCH_TOP_MAILBOX_STORAGEGROUPNAME_DESC">The name of the storage group that contains the mailbox</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="StoreName" TYPE="STRING" IS_KEY="TRUE">
        <Display>
          <Label NLSID="EXCH_TOP_MAILBOX_STORENAME_LBL">Store Name</Label>
          <Description NLSID="EXCH_TOP_MAILBOX_STORENAME_DESC">The name of the message database (MDB) that contains the mailbox</Description>
        </Display>
      </ColumnDescriptor>


      <ColumnDescriptor NAME="SizeMB" TYPE="NUMBER" COMPUTE_EXPR="Size/(1024*1024)">
        <Display>
          <Label NLSID="EXCH_TOP_MAILBOX_SIZEMB_LBL">Size (MB)</Label>
          <Description NLSID="EXCH_TOP_MAILBOX_SIZEMB_DESC"> The Size property indicates the cumulative size of all of the messages in the Mailbox, in MB</Description>
        </Display>
      </ColumnDescriptor>

    </TableDescriptor>

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="local"/>
      </ValidIf>

      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="scriptsDir" SCOPE="SYSTEMGLOBAL">scriptsDir</Property>
      <Property NAME="perlBin" SCOPE="SYSTEMGLOBAL">perlBin</Property>
      <Property NAME="command" SCOPE="GLOBAL">%perlBin%/perl</Property>
      <Property NAME="script" SCOPE="GLOBAL">%scriptsDir%/exchange/top_mailbox.pl mailbox 5</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="remote"/>
      </ValidIf>	 
      <Property NAME="ENVWBEM_REMOTE" SCOPE="GLOBAL">1</Property>
      <Property NAME="STDINWBEM_HOST" SCOPE="INSTANCE">Host</Property>
      <Property NAME="STDINWBEM_USERNAME" SCOPE="INSTANCE" OPTIONAL="TRUE">SysUsername</Property>
      <Property NAME="STDINWBEM_PASSWORD" SCOPE="INSTANCE" OPTIONAL="TRUE">SysPassword</Property>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="scriptsDir" SCOPE="SYSTEMGLOBAL">scriptsDir</Property>
      <Property NAME="perlBin" SCOPE="SYSTEMGLOBAL">perlBin</Property>
      <Property NAME="command" SCOPE="GLOBAL">%perlBin%/perl</Property>
      <Property NAME="script" SCOPE="GLOBAL">%scriptsDir%/exchange/top_mailbox.pl mailbox 5</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>

    </QueryDescriptor>
  </Metric>


  <!-- COnnector status  -->  	
  <Metric NAME="EXCH_ConnectorStatus" TYPE="TABLE">
    <Display>
      <Label NLSID="EXCH_CONNECTORSTATUS_LBL">Exchange - Connectors Status</Label>
      <Description NLSID="EXCH_CONNECTORSTATUS_DESC">Exchange - Connectors Status</Description>
    </Display>

    <TableDescriptor>

      <ColumnDescriptor NAME="DN" TYPE="STRING" IS_KEY="TRUE">
        <Display>
          <Label NLSID="EXCH_CONNECTORSTATUS_DN_LBL">DN</Label>
          <Description NLSID="EXCH_CONNECTORSTATUS_DN_DESC">The Active Directory distinguished name (dn) of the exchange connector object</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="GroupDN" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_CONNECTORSTATUS_GROUPDN_LBL">GroupDN</Label>
          <Description NLSID="EXCH_CONNECTORSTATUS_GROUPDN_DESC">The distinguished Name (DN) in Active Directory of the routing group</Description>
        </Display>
      </ColumnDescriptor>


      <ColumnDescriptor NAME="Name" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_CONNECTORSTATUS_NAME_LBL">Name</Label>
          <Description NLSID="EXCH_CONNECTORSTATUS_NAME_DESC">The name of the Exchange Connector</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="IsUp" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_CONNECTORSTATUS_ISUP_LBL">Is Up</Label>
          <Description NLSID="EXCH_CONNECTORSTATUS_ISUP_DESC">When True specifies that the Exchange Connector is operating normally </Description>
        </Display>
      </ColumnDescriptor>

    </TableDescriptor>
    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="local"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2\applications\exchange</Property>
      <Property NAME="ENVWBEM_PROPERTIES" SCOPE="GLOBAL">DN,GroupDN,Name,IsUp</Property>
      <Property NAME="ENVWBEM_CLASSNAME" SCOPE="GLOBAL">ExchangeConnectorState</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>
    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="remote"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="STDINWBEM_HOST" SCOPE="INSTANCE">Host</Property>
      <Property NAME="STDINWBEM_USERNAME" SCOPE="INSTANCE" OPTIONAL="TRUE">SysUsername</Property>
      <Property NAME="STDINWBEM_PASSWORD" SCOPE="INSTANCE" OPTIONAL="TRUE">SysPassword</Property>
      <Property NAME="ENVWBEM_REMOTE" SCOPE="GLOBAL">1</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2\applications\exchange</Property>
      <Property NAME="ENVWBEM_PROPERTIES" SCOPE="GLOBAL">DN,GroupDN,Name,IsUp</Property>
      <Property NAME="ENVWBEM_CLASSNAME" SCOPE="GLOBAL">ExchangeConnectorState</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>    
  </Metric>


  <!-- Cluster Resources  (State)-->
  <Metric NAME="EXCH_ClusterRsc_STATE" TYPE="TABLE">
    <Display>
      <Label NLSID="EXCH_CLUSTERRSC_STATE_LBL">Exchange - Cluster Resource State</Label>
      <Description NLSID="EXCH_CLUSTERRSC_STATE_DESC">Information about a MS Exchange cluster resource </Description>
    </Display>

    <TableDescriptor>
      <ColumnDescriptor NAME="Name" TYPE="STRING" IS_KEY="TRUE">
        <Display>
          <Label NLSID="EXCH_CLUSTERRSC_STATE_NAME_LBL">Name</Label>
          <Description NLSID="EXCH_CLUSTERRSC_STATE_NAME_DESC">The name of the Exchange cluster resource</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="State" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_CLUSTERRSC_STATE_STATE_LBL">State</Label>
          <Description NLSID="EXCH_CLUSTERRSC_STATE_STATE_DESC">The current state of the cluster resource</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="VirtualMachine" TYPE="STRING" IS_KEY="TRUE">
        <Display>
          <Label NLSID="EXCH_CLUSTERRSC_STATE_VIRTUALMACHINE_LBL">Virtual Machine</Label>
          <Description NLSID="EXCH_CLUSTERRSC_STATE_VIRTUALMACHINE_DESC">The name of the virtual machine that owns this resource</Description>
        </Display>
      </ColumnDescriptor>
    </TableDescriptor>
    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="local"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2\applications\exchange</Property>
      <Property NAME="ENVWBEM_PROPERTIES" SCOPE="GLOBAL">Name,State,VirtualMachine</Property>
      <Property NAME="ENVWBEM_CLASSNAME" SCOPE="GLOBAL">ExchangeClusterResource</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>
    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="remote"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="STDINWBEM_HOST" SCOPE="INSTANCE">Host</Property>
      <Property NAME="STDINWBEM_USERNAME" SCOPE="INSTANCE" OPTIONAL="TRUE">SysUsername</Property>
      <Property NAME="STDINWBEM_PASSWORD" SCOPE="INSTANCE" OPTIONAL="TRUE">SysPassword</Property>
      <Property NAME="ENVWBEM_REMOTE" SCOPE="GLOBAL">1</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2\applications\exchange</Property>
      <Property NAME="ENVWBEM_PROPERTIES" SCOPE="GLOBAL">Name,State,VirtualMachine</Property>
      <Property NAME="ENVWBEM_CLASSNAME" SCOPE="GLOBAL">ExchangeClusterResource</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>
  </Metric>

  <!-- Exchange Link(PERF METRICS)--> 

  <Metric NAME="EXCH_Link_Perf" TYPE="TABLE" >
    <Display>
      <Label NLSID="EXCH_LINK_PERF_LBL">Exchange - Links Performance Metrics</Label>
      <Description NLSID="EXCH_LINK_PERF_DESC">Exchange - Links Performance Metrics</Description>
    </Display>

    <TableDescriptor>  

      <ColumnDescriptor NAME="LinkName" TYPE="STRING" IS_KEY="TRUE">
        <Display>
          <Label NLSID="EXCH_LINK_PERF_LINKNAME_LBL">Link Name</Label>
          <Description NLSID="EXCH_LINK_PERF_LINKNAME_DESC">The name of the link </Description>
        </Display>
      </ColumnDescriptor>


      <ColumnDescriptor NAME="ProtocolName" TYPE="STRING" IS_KEY="TRUE">
        <Display>
          <Label NLSID="EXCH_LINK_PERF_PROTOCOLNAME_LBL">Protocol Name</Label>
          <Description NLSID="EXCH_LINK_PERF_PROTOCOLNAME_DESC">The transmission protocol used by the link</Description>
        </Display>
      </ColumnDescriptor>


      <ColumnDescriptor NAME="VirtualServerName" TYPE="STRING" IS_KEY="TRUE">
        <Display>
          <Label NLSID="EXCH_LINK_PERF_VIRTUALSERVERNAME_LBL">Virtual Server Name</Label>
          <Description NLSID="EXCH_LINK_PERF_VIRTUALSERVERNAME_DESC">This number is the Microsoft Active Directory common name (CN) for the virtual server object</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="GlobalStop" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_LINK_PERF_GLOBALSTOP_LBL">Global Stop</Label>
          <Description NLSID="EXCH_LINK_PERF_GLOBALSTOP_DESC">Indicates whether the virtual server for the link is in disabled mode. If True, the virtual server is disabled</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="IncreasingTime" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_LINK_PERF_INCREASINGTIME_LBL">Increasing-Time(milliseconds)</Label>
          <Description NLSID="EXCH_LINK_PERF_INCREASINGTIME_DESC">Time, in milliseconds, that the number of messages waiting to be transferred by the link has been increasing</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="NumberOfMessages" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_LINK_PERF_NUMBEROFMESSAGES_LBL">Number Of Messages</Label>
          <Description NLSID="EXCH_LINK_PERF_NUMBEROFMESSAGES_DESC">The number of messages that are waiting for transmission across the link</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="OldestMessage" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_LINK_PERF_OLDESTMESSAGE_LBL">Oldest Message</Label>
          <Description NLSID="EXCH_LINK_PERF_OLDESTMESSAGE_DESC">The date and time that the oldest message that is still waiting to be transmitted was received into the link</Description>
        </Display>
      </ColumnDescriptor>


      <ColumnDescriptor NAME="SizeOfQueue" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_LINK_PERF_SIZEOFQUEUE_LBL">Size Of Queue(Bytes)</Label>
          <Description NLSID="EXCH_LINK_PERF_SIZEOFQUEUE_DESC">The total size of the messages in the link, in bytes</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="StateActive" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_LINK_PERF_STATEACTIVE_LBL">State Active</Label>
          <Description NLSID="EXCH_LINK_PERF_STATEACTIVE_DESC">When True, specifies that the link is active</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="StateFrozen" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_LINK_PERF_STATEFROZEN_LBL">State Frozen</Label>
          <Description NLSID="EXCH_LINK_PERF_STATEFROZEN_DESC">Indicates whether the link is currently frozen</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="StateReady" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_LINK_PERF_STATEREADY_LBL">State Ready</Label>
          <Description NLSID="EXCH_LINK_PERF_STATEREADY_DESC">When True, specifies that the link is ready to accept new messages</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="StateRemote" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_LINK_PERF_STATEREMOTE_LBL">State Remote</Label>
          <Description NLSID="EXCH_LINK_PERF_STATEREMOTE_DESC">Indicates if the destination for messages in this link is on a remote server</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="StateRetry" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_LINK_PERF_STATERETRY_LBL">State Retry</Label>
          <Description NLSID="EXCH_LINK_PERF_STATERETRY_DESC">When True, specifies that the link is retrying a transmission that was unsuccessful</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="StateScheduled" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_LINK_PERF_STATESCHEDULED_LBL">State Scheduled</Label>
          <Description NLSID="EXCH_LINK_PERF_STATESCHEDULED_DESC">When True, specifies that the link is scheduled for periodic activation, as compared with asynchronous, on-demand activation </Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="SizeOfQueueMB" TYPE="NUMBER" COMPUTE_EXPR="SizeOfQueue/(1024*1024)">
        <Display>
          <Label NLSID="EXCH_LINK_PERF_SIZEOFQUEUEMB_LBL">Size Of Queue(MB)</Label>
          <Description NLSID="EXCH_LINK_PERF_SIZEOFQUEUEMB_DESC">The total size of the messages in the link, in MB</Description>
        </Display>
      </ColumnDescriptor>

    </TableDescriptor>
    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="local"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>     
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select LinkName, ProtocolName, VirtualServerName, GlobalStop, IncreasingTime, NumberOfMessages, OldestMessage, SizeOfQueue, StateActive,  StateFrozen, StateReady, StateRemote, StateRetry, StateScheduled from ExchangeLink where LinkName is not null</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">linkname, protocolname, virtualservername, globalstop, increasingtime, numberofmessages, oldestmessage, sizeofqueue, stateactive,  statefrozen, stateready, stateremote, stateretry, statescheduled</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2\applications\exchange</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>
    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="remote"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="STDINWBEM_HOST" SCOPE="INSTANCE">Host</Property>
      <Property NAME="STDINWBEM_USERNAME" SCOPE="INSTANCE" OPTIONAL="TRUE">SysUsername</Property>
      <Property NAME="STDINWBEM_PASSWORD" SCOPE="INSTANCE" OPTIONAL="TRUE">SysPassword</Property>
      <Property NAME="ENVWBEM_REMOTE" SCOPE="GLOBAL">1</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select LinkName, ProtocolName, VirtualServerName, GlobalStop, IncreasingTime, NumberOfMessages, OldestMessage, SizeOfQueue, StateActive,  StateFrozen, StateReady, StateRemote, StateRetry, StateScheduled from ExchangeLink where LinkName is not null</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">linkname, protocolname, virtualservername, globalstop, increasingtime, numberofmessages, oldestmessage, sizeofqueue, stateactive,  statefrozen, stateready, stateremote, stateretry, statescheduled</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2\applications\exchange</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>
  </Metric>


  <!-- DS Access reachability -->

  <Metric NAME="EXCH_DSAccess_Reachability" TYPE="TABLE" >    
    <Display>
      <Label NLSID="EXCH_DSACCESS_REACHABILITY_LBL">DSAccess Domain Controllers Reachability</Label>
      <Description NLSID="EXCH_DSACCESS_REACHABILITY_DESC">DSAccess Domain Controllers Reachability</Description>
    </Display>
    <TableDescriptor>
      <ColumnDescriptor NAME="Name" TYPE="STRING" IS_KEY="TRUE">
        <Display>
          <Label NLSID="EXCH_DSACCESS_REACHABILITY_NAME_LBL">Name</Label>
          <Description NLSID="EXCH_DSACCESS_REACHABILITY_NAME_DESC">This property specifies the computer name of the domain controller </Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="Type" TYPE="NUMBER" IS_KEY="TRUE">
        <Display>
          <Label NLSID="EXCH_DSACCESS_REACHABILITY_TYPE_LBL">Type</Label>
          <Description NLSID="EXCH_DSACCESS_REACHABILITY_TYPE_DESC">Specifies the role that the domain controller plays in the Exchange system - (Configuration, Local ,Global Catalog)</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="IsFast" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_DSACCESS_REACHABILITY_ISFAST_LBL">IsFast</Label>
          <Description NLSID="EXCH_DSACCESS_REACHABILITY_ISFAST_DESC">When True, indicates the domain controller response time has been less than two seconds</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="IsInSync" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_DSACCESS_REACHABILITY_ISINSYNC_LBL">IsInSync</Label>
          <Description NLSID="EXCH_DSACCESS_REACHABILITY_ISINSYNC_DESC">Specifies if the domain controller is synchronized with the Global Catalog server and with the Configuration domain controller</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="IsUp" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_DSACCESS_REACHABILITY_ISUP_LBL">IsUp</Label>
          <Description NLSID="EXCH_DSACCESS_REACHABILITY_ISUP_DESC">Indicates whether the domain controller was available the last time Exchange attempted to access it </Description>
        </Display>
      </ColumnDescriptor>

    </TableDescriptor>

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="local"/>
      </ValidIf>

      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select Name,Type, IsUp,IsInSync, IsFast from Exchange_DSAccessDC where name is not null</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">name,type,isfast,isinsync,isup</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\microsoftexchangev2</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>
    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="remote"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="STDINWBEM_HOST" SCOPE="INSTANCE">Host</Property>
      <Property NAME="STDINWBEM_USERNAME" SCOPE="INSTANCE" OPTIONAL="TRUE">SysUsername</Property>
      <Property NAME="STDINWBEM_PASSWORD" SCOPE="INSTANCE" OPTIONAL="TRUE">SysPassword</Property>
      <Property NAME="ENVWBEM_REMOTE" SCOPE="GLOBAL">1</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select Name,Type, IsUp,IsInSync, IsFast from Exchange_DSAccessDC where name is not null</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">name,type,isfast,isinsync,isup</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\microsoftexchangev2</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>
  </Metric>





  <!-- ********************** -->
  <!-- WIn32Perf Metrics Start Here -->
  <!-- ********************** --> 
  <!-- ********************** -->

  <!-- DS Access Performance FORMATTED-->  
  <Metric NAME="EXCH_DSAccess_Perf" TYPE="TABLE" >          
    <Display>
      <Label NLSID="EXCH_DSACCESS_PERF_LBL">Exchange - Directory Service Performance</Label>
      <Description NLSID="EXCH_DSACCESS_PERF_DESC">>Exchange - Directory Service Performance</Description>
    </Display>

    <TableDescriptor> 

      <ColumnDescriptor NAME="Name" TYPE="STRING" IS_KEY="TRUE">
        <Display>
          <Label NLSID="EXCH_DSACCESS_PERF_NAME_LBL">Name</Label>
          <Description NLSID="EXCH_DSACCESS_PERF_NAME_DESC">The Name property specifies the computer name of the domain controller</Description>
        </Display>
      </ColumnDescriptor> 	

      <ColumnDescriptor NAME="FormattedLDAPReadTime" TYPE="NUMBER" IS_KEY="FALSE" >
        <Display>
          <Label NLSID="EXCH_DSACCESS_PERF_FORMATTEDLDAPREADTIME_LBL">LDAP Read Time(in ms)</Label>
          <Description NLSID="EXCH_DSACCESS_PERF_FORMATTEDLDAPREADTIME_DESC">It is the time (in ms) taken to send an LDAP read request to the specified Domain Controller and receive a response</Description>
        </Display>
      </ColumnDescriptor>


      <ColumnDescriptor NAME="FormattedLDAPSearchTime" TYPE="NUMBER" IS_KEY="FALSE" >
        <Display>
          <Label NLSID="EXCH_DSACCESS_PERF_FORMATTEDLDAPSEARCHTIME_LBL">LDAP Search Time(in ms)</Label>
          <Description NLSID="EXCH_DSACCESS_PERF_FORMATTEDLDAPSEARCHTIME_DESC">Time (in ms) taken to send an LDAP search request and receive a response</Description>
        </Display>
      </ColumnDescriptor>


      <ColumnDescriptor NAME="FormattedLDAPReadcallsPerSec" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_DSACCESS_PERF_FORMATTEDLDAPREADCALLSPERSEC_LBL">LDAP Read calls Per Second</Label>	
          <Description NLSID="EXCH_DSACCESS_PERF_FORMATTEDLDAPREADCALLSPERSEC_DESC">It is the number of Depth 0 LDAP search calls made by this process per second</Description>
        </Display>

      </ColumnDescriptor>    

      <ColumnDescriptor NAME="FormattedLDAPSearchcallsPerSec" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_DSACCESS_PERF_FORMATTEDLDAPSEARCHCALLSPERSEC_LBL">LDAP Search Calls Per Second</Label>
          <Description NLSID="EXCH_DSACCESS_PERF_FORMATTEDLDAPSEARCHCALLSPERSEC_DESC">The number of Depth 1 or 2 LDAP Search calls made by this process per second</Description>
        </Display>
      </ColumnDescriptor> 

    </TableDescriptor>
    <ExecutionDescriptor>
      <GetTable NAME="EXCH_DSAccess_Perf_RAW"/>
    </ExecutionDescriptor> 
  </Metric>



  <!-- DS Access Flags  -->  	
  <Metric NAME="EXCH_DSAccess_Flags" TYPE="TABLE">          
    <Display>
      <Label NLSID="EXCH_DSACCESS_FLAGS_LBL">Exchange - Directory Service Flags</Label>
      <Description NLSID="EXCH_DSACCESS_FLAGS_DESC"> Exchange - Directory Service Flags</Description>
    </Display>

    <TableDescriptor> 

      <ColumnDescriptor NAME="Name" TYPE="STRING" IS_KEY="TRUE">
        <Display>
          <Label NLSID="EXCH_DSACCESS_FLAGS_NAME_LBL">Name</Label>
          <Description NLSID="EXCH_DSACCESS_FLAGS_NAME_DESC">Specifies the computer name of the domain controller</Description>
        </Display>
      </ColumnDescriptor> 

      <ColumnDescriptor NAME="SACLRightFlag" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_DSACCESS_FLAGS_SACLRIGHTFLAG_LBL">SACL-Right Flag</Label>
          <Description NLSID="EXCH_DSACCESS_FLAGS_SACLRIGHTFLAG_DESC">SACL right flag is 1 if the Exchange server has a SeSecurityPrivilege on the Domain Controller, 0 otherwise</Description>
        </Display>
      </ColumnDescriptor>


      <ColumnDescriptor NAME="OSVersionFlag" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_DSACCESS_FLAGS_OSVERSIONFLAG_LBL">OS Version Flag</Label>
          <Description NLSID="EXCH_DSACCESS_FLAGS_OSVERSIONFLAG_DESC">OS Version flag is 1 when the DC satisfies DSAccess OS/Service Pack requirements, 0 otherwise</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="Netlogonflag" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_DSACCESS_FLAGS_NETLOGONFLAG_LBL">Netlogon Flag</Label>
          <Description NLSID="EXCH_DSACCESS_FLAGS_NETLOGONFLAG_DESC">Netlogon flag is 1 when DsGetDcName to the DC succeeds, indicating that NetLogon service is running, 0 otherwise</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="IsSynchronizedflag" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_DSACCESS_FLAGS_ISSYNCHRONIZEDFLAG_LBL">Is-Synchronized Flag</Label>
          <Description NLSID="EXCH_DSACCESS_FLAGS_ISSYNCHRONIZEDFLAG_DESC">If the value of this flag is 1 it indicates the Domain Controller is synchronized</Description>
        </Display>
      </ColumnDescriptor>


      <ColumnDescriptor NAME="GCcapableflag" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_DSACCESS_FLAGS_GCCAPABLEFLAG_LBL">GC-Capable Flag</Label>
          <Description NLSID="EXCH_DSACCESS_FLAGS_GCCAPABLEFLAG_DESC">GC capable flag is 1 if the Domain Controllder is also a Global Catalog Server, 0 otherwise</Description>
        </Display>
      </ColumnDescriptor> 


      <ColumnDescriptor NAME="CriticalDataflag" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_DSACCESS_FLAGS_CRITICALDATAFLAG_LBL">Critical-Data Flag</Label>	
          <Description NLSID="EXCH_DSACCESS_FLAGS_CRITICALDATAFLAG_DESC">Critical Data flag is 1 if the Domain Controllder contains the Exchange server account, 0 otherwise</Description>
        </Display>
      </ColumnDescriptor> 

    </TableDescriptor>

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="local"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select Name, SACLRightFlag, OSVersionFlag, Netlogonflag, IsSynchronizedflag,GCcapableflag,CriticalDataflag from Win32_PerfFormattedData_MSExchangeDSAccess_MSExchangeDSAccessDomainControllers where Name is not null</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">name, saclrightflag, osversionflag, netlogonflag, issynchronizedflag,gccapableflag,criticaldataflag</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="remote"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="STDINWBEM_HOST" SCOPE="INSTANCE">Host</Property>
      <Property NAME="STDINWBEM_USERNAME" SCOPE="INSTANCE" OPTIONAL="TRUE">SysUsername</Property>
      <Property NAME="STDINWBEM_PASSWORD" SCOPE="INSTANCE" OPTIONAL="TRUE">SysPassword</Property>
      <Property NAME="ENVWBEM_REMOTE" SCOPE="GLOBAL">1</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select Name, SACLRightFlag, OSVersionFlag, Netlogonflag, IsSynchronizedflag,GCcapableflag,CriticalDataflag from Win32_PerfFormattedData_MSExchangeDSAccess_MSExchangeDSAccessDomainControllers where Name is not null</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">name, saclrightFlag, osversionFlag, netlogonflag, issynchronizedflag,gccapableflag,criticaldataflag</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2</Property>        
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>     
  </Metric>



  <!-- DS Access Performance (CHECK)-->  	
  <Metric NAME="EXCH_DSAccess_Perf_RAW" TYPE="TABLE" USAGE_TYPE="HIDDEN_COLLECT">          

    <TableDescriptor> 

      <ColumnDescriptor NAME="Name" TYPE="STRING" IS_KEY="TRUE">		
      </ColumnDescriptor> 

      <!-- cooking type  = PERF_COUNTER_COUNTER-->
      <ColumnDescriptor NAME="LDAPReadcallsPerSec" TYPE="NUMBER" IS_KEY="FALSE">	
      </ColumnDescriptor>	

      <!-- cooking type  PERF_AVERAGE_BULK -->
      <ColumnDescriptor NAME="LDAPReadTime" TYPE="NUMBER" IS_KEY="FALSE">		
      </ColumnDescriptor>

      <!-- cooking type  = PERF_COUNTER_COUNTER-->
      <ColumnDescriptor NAME="LDAPSearchcallsPerSec" TYPE="NUMBER" IS_KEY="FALSE">		
      </ColumnDescriptor>

      <!-- cooking type  PERF_AVERAGE_BULK -->
      <ColumnDescriptor NAME="LDAPSearchTime" TYPE="NUMBER" IS_KEY="FALSE">		
      </ColumnDescriptor>

      <ColumnDescriptor NAME="Timestamp_Sys100NS" TYPE="NUMBER" IS_KEY="FALSE">		
      </ColumnDescriptor>     

      <ColumnDescriptor NAME="Frequency_Sys100NS" TYPE="NUMBER" IS_KEY="FALSE">
      </ColumnDescriptor>     

      <ColumnDescriptor NAME="FormattedLDAPReadTime" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="(LDAPReadTime-_LDAPReadTime)/(LDAPReadcallsPerSec - _LDAPReadcallsPerSec)">		
      </ColumnDescriptor>


      <ColumnDescriptor NAME="FormattedLDAPSearchTime" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="(LDAPSearchTime-_LDAPSearchTime)/(LDAPSearchcallsPerSec - _LDAPSearchcallsPerSec)">
      </ColumnDescriptor>


      <ColumnDescriptor NAME="LDAPReadcallsPerSecDiff" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="(LDAPReadcallsPerSec - _LDAPReadcallsPerSec)">
      </ColumnDescriptor>      

      <ColumnDescriptor NAME="LDAPSearchcallsPerSecDiff" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="(LDAPSearchcallsPerSec - _LDAPSearchcallsPerSec)">
      </ColumnDescriptor>    


      <ColumnDescriptor NAME="TimeDiffSys" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="(Timestamp_Sys100NS - _Timestamp_Sys100NS)">
      </ColumnDescriptor>

      <ColumnDescriptor NAME="FormattedLDAPReadcallsPerSec" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="((LDAPReadcallsPerSecDiff/TimeDiffSys) * Frequency_Sys100NS)">
      </ColumnDescriptor>    

      <ColumnDescriptor NAME="FormattedLDAPSearchcallsPerSec" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="((LDAPSearchcallsPerSecDiff/TimeDiffSys) * Frequency_Sys100NS)">
      </ColumnDescriptor> 

    </TableDescriptor>

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="local"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select Name, LDAPReadcallsPerSec, LDAPReadTime, LDAPSearchcallsPerSec, LDAPSearchTime, Timestamp_Sys100NS, Frequency_Sys100NS from Win32_PerfRawData_MSExchangeDSAccess_MSExchangeDSAccessDomainControllers where Name is not null</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">name, ldapreadcallspersec, ldapreadtime, ldapsearchcallspersec, ldapsearchtime, timestamp_sys100ns, frequency_sys100ns</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="remote"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="STDINWBEM_HOST" SCOPE="INSTANCE">Host</Property>
      <Property NAME="STDINWBEM_USERNAME" SCOPE="INSTANCE" OPTIONAL="TRUE">SysUsername</Property>
      <Property NAME="STDINWBEM_PASSWORD" SCOPE="INSTANCE" OPTIONAL="TRUE">SysPassword</Property>
      <Property NAME="ENVWBEM_REMOTE" SCOPE="GLOBAL">1</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select Name, LDAPReadcallsPerSec, LDAPReadTime, LDAPSearchcallsPerSec, LDAPSearchTime, Timestamp_Sys100NS, Frequency_Sys100NS from Win32_PerfRawData_MSExchangeDSAccess_MSExchangeDSAccessDomainControllers where Name is not null</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">name, ldapreadcallspersec, ldapreadtime, ldapsearchcallspersec, ldapsearchtime, timestamp_sys100ns, frequency_sys100ns</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2</Property>        
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>     
  </Metric>


  <!-- MTA CONNECTIONS (TODO CHECK) -->  	
  <Metric NAME="EXCH_MTA_Connections" TYPE="TABLE">          
    <Display>
      <Label NLSID="EXCH_MTA_CONNECTIONS_LBL">MTA Connections</Label>
      <Description NLSID="EXCH_MTA_CONNECTIONS_DESC">MTA Connections</Description>
    </Display>

    <TableDescriptor> 

      <ColumnDescriptor NAME="Name" TYPE="STRING" IS_KEY="TRUE">
        <Display>
          <Label NLSID="EXCH_MTA_CONNECTIONS_NAME_LBL">Name</Label>
          <Description NLSID="EXCH_MTA_CONNECTIONS_NAME_DESC">Name of the connection</Description>
        </Display>
      </ColumnDescriptor> 

      <ColumnDescriptor NAME="ConnectorIndex" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_MTA_CONNECTIONS_CONNECTORINDEX_LBL">Connector Index</Label>
          <Description NLSID="EXCH_MTA_CONNECTIONS_CONNECTORINDEX_DESC">Connector Index is a unique index associated with a connector entity</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="SendMessagesPersec" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_MTA_CONNECTIONS_SENDMESSAGESPERSEC_LBL">Messages Sent Per Second</Label>
          <Description NLSID="EXCH_MTA_CONNECTIONS_SENDMESSAGESPERSEC_DESC">It is the rate that messages are sent to the connected entity</Description>
        </Display>
      </ColumnDescriptor> 

      <ColumnDescriptor NAME="ReceiveMessagesPersec" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_MTA_CONNECTIONS_RECEIVEMESSAGESPERSEC_LBL">Messages Received Per Second</Label>
          <Description NLSID="EXCH_MTA_CONNECTIONS_RECEIVEMESSAGESPERSEC_DESC">It is the rate that messages are received from the connected entity</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="QueueLength" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_MTA_CONNECTIONS_QUEUELENGTH_LBL">Size of OutBound Messages Queue</Label>
          <Description NLSID="EXCH_MTA_CONNECTIONS_QUEUELENGTH_DESC">The number of outstanding messages queued for transfer to the entity</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="CurrentOutboundAssociations" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_MTA_CONNECTIONS_CURRENTOUTBOUNDASSOCIATIONS_LBL">Current Outbound Connections</Label>
          <Description NLSID="EXCH_MTA_CONNECTIONS_CURRENTOUTBOUNDASSOCIATIONS_DESC">The current number of outbound (locally initiated) associations with the entity</Description>
        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="CurrentInboundAssociations" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_MTA_CONNECTIONS_CURRENTINBOUNDASSOCIATIONS_LBL">Current Inbound Connections</Label>
          <Description NLSID="EXCH_MTA_CONNECTIONS_CURRENTINBOUNDASSOCIATIONS_DESC">The current number of inbound (remote initiated) associations with the entity</Description>
        </Display>
      </ColumnDescriptor>
    </TableDescriptor>

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="local"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select Name,ConnectorIndex, CurrentInboundAssociations, CurrentOutboundAssociations, QueueLength, ReceiveMessagesPersec, SendMessagesPersec from Win32_PerfFormattedData_MSExchangeMTA_MSExchangeMTAConnections where Name is not null</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">name,connectorindex, sendmessagespersec, receivemessagespersec, queuelength, currentoutboundassociations, currentinboundassociations</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="remote"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="STDINWBEM_HOST" SCOPE="INSTANCE">Host</Property>
      <Property NAME="STDINWBEM_USERNAME" SCOPE="INSTANCE" OPTIONAL="TRUE">SysUsername</Property>
      <Property NAME="STDINWBEM_PASSWORD" SCOPE="INSTANCE" OPTIONAL="TRUE">SysPassword</Property>
      <Property NAME="ENVWBEM_REMOTE" SCOPE="GLOBAL">1</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select Name,ConnectorIndex, CurrentInboundAssociations, CurrentOutboundAssociations, QueueLength, ReceiveMessagesPersec, SendMessagesPersec from Win32_PerfFormattedData_MSExchangeMTA_MSExchangeMTAConnections where Name is not null</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">name,connectorindex, sendmessagespersec, receivemessagespersec, queuelength, currentoutboundassociations, currentinboundassociations</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2</Property>        
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>     
  </Metric>

  <!-- MTA Work Queue (TODO CHECK) -->    
  <Metric NAME="EXCH_MTA_WORK_QUEUE" TYPE="TABLE" USAGE_TYPE="HIDDEN">          
    <TableDescriptor>          
      <ColumnDescriptor NAME="WorkQueueLength" TYPE="NUMBER" IS_KEY="FALSE">
      </ColumnDescriptor>                                  
    </TableDescriptor>       

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="local"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select WorkQueueLength from Win32_PerfFormattedData_MSExchangeMTA_MSExchangeMTA</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">workqueuelength</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="remote"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="STDINWBEM_HOST" SCOPE="INSTANCE">Host</Property>
      <Property NAME="STDINWBEM_USERNAME" SCOPE="INSTANCE" OPTIONAL="TRUE">SysUsername</Property>
      <Property NAME="STDINWBEM_PASSWORD" SCOPE="INSTANCE" OPTIONAL="TRUE">SysPassword</Property>
      <Property NAME="ENVWBEM_REMOTE" SCOPE="GLOBAL">1</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select WorkQueueLength from Win32_PerfFormattedData_MSExchangeMTA_MSExchangeMTA</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">workqueuelength</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2</Property>        
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>     
  </Metric>



  <!-- Information Store General RAW Metrics  Win32_PerfRawData_MSExchangeIS_MSExchangeIS
  problem: ActiveUserCount metric is not returning any value-->   
  <Metric NAME="EXCH_IS_GENERAL" TYPE="TABLE" >          

    <Display>
      <Label NLSID="EXCH_IS_GENERAL_LBL">Information Store General Metrics</Label>
      <Description NLSID="EXCH_IS_GENERAL_DESC">Information Store General Metrics</Description>
    </Display>         

    <TableDescriptor>         

      <ColumnDescriptor NAME="ActiveUserCount" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_IS_GENERAL_ACTIVEUSERCOUNT_LBL">Active User Count</Label>
          <Description NLSID="EXCH_IS_GENERAL_ACTIVEUSERCOUNT_DESC">Number of user connections that have shown some activity in the last 10 minutes </Description>
        </Display>
      </ColumnDescriptor>                                  

      <ColumnDescriptor NAME="UserCount" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_IS_GENERAL_USERCOUNT_LBL">User Count</Label>
          <Description NLSID="EXCH_IS_GENERAL_USERCOUNT_DESC">User Count is the number of users connected to the information store</Description>
        </Display>
      </ColumnDescriptor>                                  

      <ColumnDescriptor NAME="ConnectionCount" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_IS_GENERAL_CONNECTIONCOUNT_LBL">Connection Count</Label>
          <Description NLSID="EXCH_IS_GENERAL_CONNECTIONCOUNT_DESC">The number of client processes connected to the information store</Description>
        </Display>
      </ColumnDescriptor>  

      <ColumnDescriptor NAME="ActiveConnectionCount" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_IS_GENERAL_ACTIVECONNECTIONCOUNT_LBL">Active Connection Count</Label>
          <Description NLSID="EXCH_IS_GENERAL_ACTIVECONNECTIONCOUNT_DESC">Number of connections that have shown some activity in the last 10 minutes</Description>
        </Display>
      </ColumnDescriptor>  

      <ColumnDescriptor NAME="VirusScanFilesScannedPersec" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_IS_GENERAL_VIRUSSCANFILESSCANNEDPERSEC_LBL">Virus Scan Files Scanned Per Second</Label>
          <Description NLSID="EXCH_IS_GENERAL_VIRUSSCANFILESSCANNEDPERSEC_DESC">The rate at which separate files are processed by virus scanner</Description>
        </Display>
      </ColumnDescriptor>                                  


      <ColumnDescriptor NAME="VirusScanQueueLength" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_IS_GENERAL_VIRUSSCANQUEUELENGTH_LBL">Virus Scan Queue Length</Label>
          <Description NLSID="EXCH_IS_GENERAL_VIRUSSCANQUEUELENGTH_DESC">Current number of outstanding requests that are queued for virus scanning</Description>
        </Display>
      </ColumnDescriptor>                                  


      <ColumnDescriptor NAME="VirusScanFilesQuarantinedPersec" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_IS_GENERAL_VIRUSSCANFILESQUARANTINEDPERSEC_LBL">Virus Scan Files Quarantined Per Second</Label>
          <Description NLSID="EXCH_IS_GENERAL_VIRUSSCANFILESQUARANTINEDPERSEC_DESC">The rate at which separate files are put into quarantine by virus scanner</Description>
        </Display>
      </ColumnDescriptor>                                  


      <ColumnDescriptor NAME="RPCAveragedLatency" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_IS_GENERAL_RPCAVERAGEDLATENCY_LBL">RPC Averaged Latency</Label>
          <Description NLSID="EXCH_IS_GENERAL_RPCAVERAGEDLATENCY_DESC">RPC latency in milliseconds averaged for the past 1024 packets</Description>
        </Display>
      </ColumnDescriptor>  


      <ColumnDescriptor NAME="FormattedRPCOperationsPersec" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_IS_GENERAL_RPCOPERATIONSPERSEC_LBL">RPC Operations Per second</Label>
          <Description NLSID="EXCH_IS_GENERAL_RPCOPERATIONSPERSEC_DESC">The rate at which the RPC operations occur</Description>
        </Display>
      </ColumnDescriptor>      

    </TableDescriptor>     
    <ExecutionDescriptor>
      <GetTable NAME="EXCH_IS_GENERAL_RAW"/>
    </ExecutionDescriptor>
  </Metric>




  <!-- MTA CONNECTIONS TOTAL  METRICS only for reports -->
  <Metric NAME="EXCH_MTA_TOTAL" TYPE="TABLE" USAGE_TYPE="COLLECT_UPLOAD">  
    <TableDescriptor> 

      <ColumnDescriptor NAME="TotalOutgoingMessagesPerSec" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_MTA_TOTAL_LBL">Total Outgoing Messages Per Second</Label>

        </Display>
      </ColumnDescriptor> 

      <ColumnDescriptor NAME="TotalIncomingMessagesPerSec" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="MTAC_TotalIncomingMessagesPerSec">Total Incoming Messages Per Second</Label>

        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="TotalOutboundQueueLength" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="MTAC_TotalOutboundQueueLength">Total OutBound Queue Length</Label>

        </Display>
      </ColumnDescriptor>

      <ColumnDescriptor NAME="WorkQueueLength" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="MTAC_WorkQueueLength">Work Queue Length</Label>

        </Display>
      </ColumnDescriptor>    

      <ColumnDescriptor NAME="TotalOutboundAssociations" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="MTAC_TotalOutboundAssociations">Total Outbound Connections</Label>

        </Display>	
      </ColumnDescriptor>

      <ColumnDescriptor NAME="TotalInboundAssociations" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="MTAC_TotalInboundAssociations">Total Inbound Connections</Label>
        </Display>
      </ColumnDescriptor>


    </TableDescriptor>

    <ExecutionDescriptor>

      <GetTable NAME="EXCH_MTA_WORK_QUEUE"/>
      <GetTable NAME="EXCH_MTA_Connections"/>         
      <GroupBy NAME="Total" FROM_TABLE="EXCH_MTA_Connections">	
        <AggregateColumn NAME="TotalOutgoingMessagesPerSec" COLUMN_NAME="SendMessagesPersec" OPERATOR="SUM"/>
        <AggregateColumn NAME="TotalIncomingMessagesPerSec" COLUMN_NAME="ReceiveMessagesPersec" OPERATOR="SUM"/>
        <AggregateColumn NAME="TotalOutboundQueueLength" COLUMN_NAME="QueueLength" OPERATOR="SUM"/>
        <AggregateColumn NAME="TotalOutboundAssociations" COLUMN_NAME="CurrentOutboundAssociations" OPERATOR="SUM"/>
        <AggregateColumn NAME="TotalInboundAssociations" COLUMN_NAME="CurrentInboundAssociations" OPERATOR="SUM"/>	    	
      </GroupBy>
      <JoinTables NAME="all" OUTER="FALSE">
        <Table NAME="Total" />
        <Table NAME="EXCH_MTA_WORK_QUEUE" />
      </JoinTables>
    </ExecutionDescriptor>
  </Metric>



  <!-- Information Store General RAW Metrics  Win32_PerfRawData_MSExchangeIS_MSExchangeIS
  problem: ActiveUserCount metric is not returning any value-->   
  <Metric NAME="EXCH_IS_GENERAL_RAW" TYPE="TABLE" USAGE_TYPE="HIDDEN_COLLECT">          

    <TableDescriptor>         

      <!-- cooking type = PERF_COUNTER_RAWCOUNT (No computation required) --> 
      <ColumnDescriptor NAME="ActiveUserCount" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>                                  

      <!-- cooking type = PERF_COUNTER_RAWCOUNT (No computation required) -->
      <ColumnDescriptor NAME="UserCount" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>                                  

      <!-- cooking type = PERF_COUNTER_COUNTER (No computation required) -->
      <ColumnDescriptor NAME="VirusScanFilesScannedPersec" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>                                  

      <!-- cooking type = PERF_COUNTER_RAWCOUNT (No computation required)  -->
      <ColumnDescriptor NAME="VirusScanQueueLength" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>                                  

      <!-- cooking type = PERF_COUNTER_RAWCOUNT  (No computation required) -->
      <ColumnDescriptor NAME="VirusScanFilesQuarantinedPersec" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>                                  


      <!-- cooking type = PERF_COUNTER_COUNTER ( time and frequency req.)  -->
      <ColumnDescriptor NAME="RPCOperationsPersec" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>                                  

      <!-- cooking type = PERF_COUNTER_RAWCOUNT(No computation required)  -->
      <ColumnDescriptor NAME="RPCAveragedLatency" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>  

      <!-- cooking type = PERF_COUNTER_RAWCOUNT(No computation required)  -->
      <ColumnDescriptor NAME="ConnectionCount" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>  

      <!-- cooking type = PERF_COUNTER_RAWCOUNT(No computation required)  -->
      <ColumnDescriptor NAME="ActiveConnectionCount" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>  

      <ColumnDescriptor NAME="Timestamp_Sys100NS" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>


      <ColumnDescriptor NAME="Frequency_Sys100NS" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor> 


      <ColumnDescriptor NAME="RPCOperationsPersecDiff" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="(RPCOperationsPersec - _RPCOperationsPersec)">

      </ColumnDescriptor>    


      <ColumnDescriptor NAME="TimeDiffSys" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="(Timestamp_Sys100NS - _Timestamp_Sys100NS)">

      </ColumnDescriptor>

      <ColumnDescriptor NAME="FormattedRPCOperationsPersec" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="((RPCOperationsPersecDiff/TimeDiffSys) * Frequency_Sys100NS)">

      </ColumnDescriptor>      


    </TableDescriptor>     

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="local"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select ActiveUserCount, UserCount, VirusScanFilesScannedPersec, VirusScanQueueLength, VirusScanFilesQuarantinedPersec, RPCOperationsPersec, RPCAveragedLatency,ConnectionCount, ActiveConnectionCount, Timestamp_Sys100NS,Frequency_Sys100NS from Win32_PerfRawData_MSExchangeIS_MSExchangeIS</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">activeusercount, usercount, virusscanfilesscannedpersec, virusscanqueuelength, virusscanfilesquarantinedpersec, rpcoperationspersec, rpcaveragedlatency,connectioncount, activeconnectioncount,timestamp_sys100ns,frequency_sys100ns</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="remote"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="STDINWBEM_HOST" SCOPE="INSTANCE">Host</Property>
      <Property NAME="STDINWBEM_USERNAME" SCOPE="INSTANCE" OPTIONAL="TRUE">SysUsername</Property>
      <Property NAME="STDINWBEM_PASSWORD" SCOPE="INSTANCE" OPTIONAL="TRUE">SysPassword</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select ActiveUserCount, UserCount, VirusScanFilesScannedPersec, VirusScanQueueLength, VirusScanFilesQuarantinedPersec, RPCOperationsPersec, RPCAveragedLatency,ConnectionCount, ActiveConnectionCount, Timestamp_Sys100NS,Frequency_Sys100NS from Win32_PerfRawData_MSExchangeIS_MSExchangeIS</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">activeusercount, usercount, virusscanfilesscannedpersec, virusscanqueuelength, virusscanfilesquarantinedpersec, rpcoperationspersec, rpcaveragedlatency,connectioncount, activeconnectioncount,timestamp_sys100ns,frequency_sys100ns</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>                    
  </Metric>

  <!-- Information Store Mailbox TOTAL only for reports  -->
  <Metric NAME="EXCH_IS_MAILBOX_FORMATTED_TOTAL" TYPE="TABLE"  USAGE_TYPE="COLLECT_UPLOAD">            

    <TableDescriptor>   

      <ColumnDescriptor NAME="AverageDeliveryTime" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="exch_mb_averagedeliverytime">Mailbox stores average delivery time</Label>
        </Display>
      </ColumnDescriptor>                                  


      <ColumnDescriptor NAME="FormattedLocaldeliveryrate" TYPE="NUMBER" IS_KEY="FALSE">    
        <Display>
          <Label NLSID="EXCH_IS_MAILBOX_FORMATTED_TOTAL_LBL">Mailbox Stores Local Delivery Rate</Label>
        </Display>
      </ColumnDescriptor>  

      <ColumnDescriptor NAME="ReceiveQueueSize" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_IS_ReceiveQueueSize">Mailbox Stores Receive Queue Size</Label>

        </Display>
      </ColumnDescriptor>                                  


      <ColumnDescriptor NAME="sendqueuesize" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_IS_sendqueuesize">Mailbox Stores Send Queue Size</Label>
        </Display>
      </ColumnDescriptor>     


      <ColumnDescriptor NAME="MessagesDeliveredPerSec" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_IS_MessagesSentPerSec">Mailbox Stores Messages Delivered Per Second</Label>
        </Display>
      </ColumnDescriptor>                                  


      <ColumnDescriptor NAME="MessagesSubmittedPerSec" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_IS_MessagesSubmittedPerSec">Mailbox Stores Messages Submitted Per Second</Label>
        </Display>
      </ColumnDescriptor>   
    </TableDescriptor>           
    <ExecutionDescriptor>
      <GetTable NAME="EXCH_IS_MAILBOX_FORMATTED"/>
      <GetView NAME="this" FROM_TABLE="EXCH_IS_MAILBOX_FORMATTED">
        <Filter COLUMN_NAME="Name" OPERATOR="EQ">_Total</Filter>
      </GetView>
    </ExecutionDescriptor>      

  </Metric>

  <!-- Information Store Mailbox FORMATEED Metrics Win32_PerfRawData_MSExchangeIS_MSExchangeISMailbox -->
  <Metric NAME="EXCH_IS_MAILBOX_FORMATTED" TYPE="TABLE" >          

    <Display>
      <Label NLSID="EXCH_IS_MAILBOX_FORMATTED_LBL">Information Store Mailbox Stores</Label>
      <Description NLSID="EXCH_IS_MAILBOX_FORMATTED_DESC">Information Store Mailbox Stores</Description>
    </Display>        

    <TableDescriptor>   

      <ColumnDescriptor NAME="Name" TYPE="STRING" IS_KEY="TRUE">
        <Display>
          <Label NLSID="EXCH_IS_MAILBOX_FORMATTED_NAME_LBL">Name</Label>
          <Description NLSID="EXCH_IS_MAILBOX_FORMATTED_NAME_DESC">Name of the Mailbox Store</Description>
        </Display>
      </ColumnDescriptor>          


      <ColumnDescriptor NAME="AverageDeliveryTime" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_IS_MAILBOX_FORMATTED_AVERAGEDELIVERYTIME_LBL">Average Delivery Time</Label>
          <Description NLSID="EXCH_IS_MAILBOX_FORMATTED_AVERAGEDELIVERYTIME_DESC">Avg time (ms) between the submission to the mailbox store and the delivery to all local recipients for the last 10 messages</Description>
        </Display>
      </ColumnDescriptor>                                  


      <ColumnDescriptor NAME="FormattedLocaldeliveryrate" TYPE="NUMBER" IS_KEY="FALSE">    
        <Display>
          <Label NLSID="EXCH_IS_MAILBOX_FORMATTED_LOCALDELIVERYRATE_LBL">Local Delivery Rate</Label>
          <Description NLSID="EXCH_IS_MAILBOX_FORMATTED_LOCALDELIVERYRATE_DESC"> Rate at which messages are delivered locally</Description>
        </Display>
      </ColumnDescriptor>  

      <ColumnDescriptor NAME="ReceiveQueueSize" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_IS_MAILBOX_FORMATTED_RECEIVEQUEUESIZE_LBL">Receive Queue Size</Label>
          <Description NLSID="EXCH_IS_MAILBOX_FORMATTED_RECEIVEQUEUESIZE_DESC">The number of messages in the mailbox store's receive queue.</Description>
        </Display>
      </ColumnDescriptor>                                  


      <ColumnDescriptor NAME="sendqueuesize" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_IS_MAILBOX_FORMATTED_SENDQUEUESIZE_LBL">Send Queue Size</Label>
          <Description NLSID="EXCH_IS_MAILBOX_FORMATTED_SENDQUEUESIZE_DESC">The number of messages in the mailbox store's send queue.</Description>
        </Display>
      </ColumnDescriptor>     


      <ColumnDescriptor NAME="MessagesDeliveredPerSec" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_IS_MAILBOX_FORMATTED_MESSAGESDELIVEREDPERSEC_LBL">Messages Delivered Per Second</Label>
          <Description NLSID="EXCH_IS_MAILBOX_FORMATTED_MESSAGESDELIVEREDPERSEC_DESC">The rate at which messages are delivered to all recipients.</Description>
        </Display>
      </ColumnDescriptor>                                  


      <ColumnDescriptor NAME="MessagesSubmittedPerSec" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_IS_MAILBOX_FORMATTED_MESSAGESSUBMITTEDPERSEC_LBL">Messages Submitted Per Second</Label>
          <Description NLSID="EXCH_IS_MAILBOX_FORMATTED_MESSAGESSUBMITTEDPERSEC_DESC">The rate at which clients submit messages.</Description>
        </Display>
      </ColumnDescriptor>   
    </TableDescriptor>     


    <ExecutionDescriptor>
      <GetTable NAME="EXCH_IS_MAILBOX_RAW"/>
    </ExecutionDescriptor>      

  </Metric>


  <!-- Information Store Mailbox RAW Metrics Win32_PerfRawData_MSExchangeIS_MSExchangeISMailbox -->
  <Metric NAME="EXCH_IS_MAILBOX_RAW" TYPE="TABLE" USAGE_TYPE="HIDDEN_COLLECT">  

    <TableDescriptor>   

      <ColumnDescriptor NAME="Name" TYPE="STRING" IS_KEY="TRUE">

      </ColumnDescriptor>          

      <!-- cooking type = PERF_COUNTER_RAWCOUNT  (No computation required)-->
      <ColumnDescriptor NAME="AverageDeliveryTime" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>                                  

      <!-- cooking type =  PERF_COUNTER_COUNTER -->
      <ColumnDescriptor NAME="Localdeliveryrate" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>                                  

      <!-- cooking type = PERF_COUNTER_RAWCOUNT(No computation required)  -->
      <ColumnDescriptor NAME="ReceiveQueueSize" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>                                  

      <!-- cooking type = PERF_COUNTER_RAWCOUNT  (No computation required)-->
      <ColumnDescriptor NAME="sendqueuesize" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>                                  

      <!-- cooking type =  PERF_COUNTER_RAWCOUNT (No computation required)-->
      <ColumnDescriptor NAME="MessagesDeliveredPermin" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>                                  

      <!-- cooking type = PERF_COUNTER_RAWCOUNT (No computation required) -->
      <ColumnDescriptor NAME="MessagesSubmittedPermin" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>


      <ColumnDescriptor NAME="Timestamp_Sys100NS" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>


      <ColumnDescriptor NAME="Frequency_Sys100NS" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor> 


      <ColumnDescriptor NAME="LocaldeliveryrateDiff" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="(Localdeliveryrate - _Localdeliveryrate)">

      </ColumnDescriptor>    


      <ColumnDescriptor NAME="TimeDiffSys" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="(Timestamp_Sys100NS - _Timestamp_Sys100NS)">

      </ColumnDescriptor>

      <ColumnDescriptor NAME="FormattedLocaldeliveryrate" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="((LocaldeliveryrateDiff/TimeDiffSys) * Frequency_Sys100NS)">

      </ColumnDescriptor>    


      <ColumnDescriptor NAME="MessagesDeliveredPerSec" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="(MessagesDeliveredPermin/60)">

      </ColumnDescriptor>                                  


      <ColumnDescriptor NAME="MessagesSubmittedPerSec" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="(MessagesSubmittedPermin/60)">

      </ColumnDescriptor>        

    </TableDescriptor>     

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="local"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select  Name, AverageDeliveryTime, Localdeliveryrate, ReceiveQueueSize,SendQueueSize, MessagesDeliveredPermin, MessagesSubmittedPermin, Timestamp_Sys100NS, Frequency_Sys100NS from Win32_PerfRawData_MSExchangeIS_MSExchangeISMailbox</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">name, averagedeliverytime, localdeliveryrate, receivequeuesize,sendqueuesize,  messagesdeliveredpermin, messagessubmittedpermin, timestamp_sys100ns, frequency_sys100ns</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="remote"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="STDINWBEM_HOST" SCOPE="INSTANCE">Host</Property>
      <Property NAME="STDINWBEM_USERNAME" SCOPE="INSTANCE" OPTIONAL="TRUE">SysUsername</Property>
      <Property NAME="STDINWBEM_PASSWORD" SCOPE="INSTANCE" OPTIONAL="TRUE">SysPassword</Property>
      <Property NAME="ENVWBEM_REMOTE" SCOPE="GLOBAL">1</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select  Name, AverageDeliveryTime, Localdeliveryrate, ReceiveQueueSize,SendQueueSize, MessagesDeliveredPermin, MessagesSubmittedPermin, Timestamp_Sys100NS, Frequency_Sys100NS from Win32_PerfRawData_MSExchangeIS_MSExchangeISMailbox</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">name, averagedeliverytime, localdeliveryrate, receivequeuesize,sendqueuesize,  messagesdeliveredpermin, messagessubmittedpermin, timestamp_sys100ns, frequency_sys100ns</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>     

  </Metric>


  <!-- Information Store PUBLIC TOTAL only for reports  -->
  <Metric NAME="EXCH_IS_PUBLIC_TOTAL" TYPE="TABLE"  USAGE_TYPE="COLLECT_UPLOAD">            

    <Display>
      <Label NLSID="EXCH_IS_PUBLIC_TOTAL_LBL">Information Store Public Stores Total Metrics</Label>
    </Display>        

    <TableDescriptor>   

      <ColumnDescriptor NAME="AverageDeliveryTime" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_MB_AverageDeliveryTime">Public Stores Average Delivery Time(ms)</Label>
        </Display>
      </ColumnDescriptor>                                  

      <ColumnDescriptor NAME="ReceiveQueueSize" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_MB_ReceiveQueueSize">Public Stores Receive Queue Size</Label>
        </Display>
      </ColumnDescriptor>                                  


      <ColumnDescriptor NAME="sendqueuesize" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_MB_sendqueuesize">Public Stores Send Queue Size</Label>
        </Display>
      </ColumnDescriptor>     


      <ColumnDescriptor NAME="MessagesDeliveredPerSec" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_MB_MessagesSentPerSec">Public Stores Messages Delivered Per Second</Label>
        </Display>
      </ColumnDescriptor>                                  	

      <ColumnDescriptor NAME="MessagesSubmittedPerSec" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_MessagesSubmittedPerSec">Public Stores Messages Submitted Per Second</Label>
        </Display>
      </ColumnDescriptor>   
    </TableDescriptor>           
    <ExecutionDescriptor>
      <GetTable NAME="EXCH_IS_PUBLIC"/>
      <GetView NAME="this" FROM_TABLE="EXCH_IS_PUBLIC">
        <Filter COLUMN_NAME="Name" OPERATOR="EQ">_Total</Filter>
      </GetView>
    </ExecutionDescriptor>      

  </Metric>


  <!-- Information Store PUBLIC Metrics Win32_PerfRawData_MSExchangeIS_MSExchangeISMailbox -->
  <Metric NAME="EXCH_IS_PUBLIC" TYPE="TABLE" >  
    <Display>
      <Label NLSID="EXCH_IS_PUBLIC_LBL">Information Store Public Stores Metrics</Label>
      <Description NLSID="EXCH_IS_PUBLIC_DESC">Information Store Public Stores Metrics</Description>
    </Display>    

    <TableDescriptor>   

      <ColumnDescriptor NAME="Name" TYPE="STRING" IS_KEY="TRUE">
        <Display>
          <Label NLSID="EXCH_IS_PUBLIC_NAME_LBL">Name</Label>
          <Description NLSID="EXCH_IS_PUBLIC_NAME_DESC">Name of the Public Store</Description>
        </Display>
      </ColumnDescriptor>          

      <!-- cooking type = PERF_COUNTER_RAWCOUNT  (No computation required)-->
      <ColumnDescriptor NAME="AverageDeliveryTime" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_IS_PUBLIC_AVERAGEDELIVERYTIME_LBL">Average Delivery Time(ms)</Label>
          <Description NLSID="EXCH_IS_PUBLIC_AVERAGEDELIVERYTIME_DESC">Avg time (ms) between the submission to the public store and the delivery to all local recipients for the last 10 messages</Description>
        </Display>

      </ColumnDescriptor>                                  


      <ColumnDescriptor NAME="ReceiveQueueSize" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_IS_PUBLIC_RECEIVEQUEUESIZE_LBL">Receive Queue Size</Label>
          <Description NLSID="EXCH_IS_PUBLIC_RECEIVEQUEUESIZE_DESC">The number of messages in the public store's receive queue.</Description>
        </Display>
      </ColumnDescriptor>                                  


      <ColumnDescriptor NAME="sendqueuesize" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_IS_PUBLIC_SENDQUEUESIZE_LBL">Send Queue Size</Label>
          <Description NLSID="EXCH_IS_PUBLIC_SENDQUEUESIZE_DESC">The number of messages in the public store's send queue</Description>
        </Display>
      </ColumnDescriptor>     


      <!-- cooking type =  PERF_COUNTER_RAWCOUNT (No computation required)-->
      <ColumnDescriptor NAME="MessagesDeliveredPermin" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_IS_PUBLIC_MESSAGESDELIVEREDPERMIN_LBL">Messages Delivered Per Minute</Label>
          <Description NLSID="EXCH_IS_PUBLIC_MESSAGESDELIVEREDPERMIN_DESC">The rate at which messages are delivered to all recipients</Description>
        </Display>

      </ColumnDescriptor>                                  

      <!-- cooking type = PERF_COUNTER_RAWCOUNT (No computation required) -->
      <ColumnDescriptor NAME="MessagesSubmittedPermin" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_IS_PUBLIC_MESSAGESSUBMITTEDPERMIN_LBL">Messages Submitted Per Minute</Label>
          <Description NLSID="EXCH_IS_PUBLIC_MESSAGESSUBMITTEDPERMIN_DESC">The rate at which messages are submitted by clients </Description>
        </Display>
      </ColumnDescriptor>	    


      <ColumnDescriptor NAME="MessagesDeliveredPerSec" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="(MessagesDeliveredPermin/60)">
        <Display>
          <Label NLSID="EXCH_IS_PUBLIC_MESSAGESDELIVEREDPERSEC_LBL">Messages Delivered Per Second</Label>
          <Description NLSID="EXCH_IS_PUBLIC_MESSAGESDELIVEREDPERSEC_DESC">The rate at which messages are delivered to all recipients</Description>
        </Display>

      </ColumnDescriptor>                                  


      <ColumnDescriptor NAME="MessagesSubmittedPerSec" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="(MessagesSubmittedPermin/60)">
        <Display>
          <Label NLSID="EXCH_IS_PUBLIC_MESSAGESSUBMITTEDPERSEC_LBL">Messages Submitted Per Second</Label>
          <Description NLSID="EXCH_IS_PUBLIC_MESSAGESSUBMITTEDPERSEC_DESC">The rate at which messages are submitted by clients </Description>
        </Display>
      </ColumnDescriptor>        

    </TableDescriptor>     

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="local"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select  Name, AverageDeliveryTime,  ReceiveQueueSize,SendQueueSize, MessagesDeliveredPermin, MessagesSubmittedPermin from Win32_PerfRawData_MSExchangeIS_MSExchangeISPublic</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">name, averagedeliverytime,  receivequeuesize,sendqueuesize,  messagesdeliveredpermin, messagessubmittedpermin</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="remote"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="STDINWBEM_HOST" SCOPE="INSTANCE">Host</Property>
      <Property NAME="STDINWBEM_USERNAME" SCOPE="INSTANCE" OPTIONAL="TRUE">SysUsername</Property>
      <Property NAME="STDINWBEM_PASSWORD" SCOPE="INSTANCE" OPTIONAL="TRUE">SysPassword</Property>
      <Property NAME="ENVWBEM_REMOTE" SCOPE="GLOBAL">1</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select  Name, AverageDeliveryTime,  ReceiveQueueSize,SendQueueSize, MessagesDeliveredPermin, MessagesSubmittedPermin from Win32_PerfRawData_MSExchangeIS_MSExchangeISPublic</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">name, averagedeliverytime,  receivequeuesize,sendqueuesize,  messagesdeliveredpermin, messagessubmittedpermin</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>     

  </Metric>


  <!-- SMTP Metrics  -->  

  <Metric NAME="EXCH_SMTP" TYPE="TABLE" >          

    <Display>
      <Label NLSID="EXCH_SMTP_LBL">SMTP Server Metrics</Label>
      <Description NLSID="EXCH_SMTP_DESC">SMTP Server Metrics</Description>
    </Display>        

    <TableDescriptor>   

      <ColumnDescriptor NAME="Name" TYPE="STRING" IS_KEY="TRUE">
        <Display>
          <Label NLSID="EXCH_SMTP_NAME_LBL">Name</Label>
          <Description NLSID="EXCH_SMTP_NAME_DESC">Name of the SMTP Server</Description>
        </Display>
      </ColumnDescriptor>          

      <ColumnDescriptor NAME="InboundConnectionsCurrent" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_SMTP_INBOUNDCONNECTIONSCURRENT_LBL">Inbound Connections Current</Label>
          <Description NLSID="EXCH_SMTP_INBOUNDCONNECTIONSCURRENT_DESC">The total number of connections currently inbound</Description>
        </Display>
      </ColumnDescriptor>                                  

      <ColumnDescriptor NAME="OutboundConnectionsCurrent" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_SMTP_OUTBOUNDCONNECTIONSCURRENT_LBL">Outbound Connections Current</Label>
          <Description NLSID="EXCH_SMTP_OUTBOUNDCONNECTIONSCURRENT_DESC">The number of connections currently outbound</Description>
        </Display>
      </ColumnDescriptor>                                  

      <ColumnDescriptor NAME="LocalQueueLength" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_SMTP_LOCALQUEUELENGTH_LBL">Local Queue Length</Label>
          <Description NLSID="EXCH_SMTP_LOCALQUEUELENGTH_DESC">The number of messages in the local queue</Description>
        </Display>
      </ColumnDescriptor>                                  

      <ColumnDescriptor NAME="RemoteQueueLength" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_SMTP_REMOTEQUEUELENGTH_LBL">Remote Queue Length</Label>
          <Description NLSID="EXCH_SMTP_REMOTEQUEUELENGTH_DESC">The number of messages in the remote queue</Description>
        </Display>
      </ColumnDescriptor>                                  

      <ColumnDescriptor NAME="FormattedMessagesReceivedPersec" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_SMTP_FORMATTEDMESSAGESRECEIVEDPERSEC_LBL">Messages Received Per Second</Label>
          <Description NLSID="EXCH_SMTP_FORMATTEDMESSAGESRECEIVEDPERSEC_DESC">The rate at which inbound messages are being received</Description>
        </Display>
      </ColumnDescriptor>                                  

      <ColumnDescriptor NAME="FormattedMessagesSentPersec" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_SMTP_FORMATTEDMESSAGESSENTPERSEC_LBL">Messages Sent Per Second</Label>
          <Description NLSID="EXCH_SMTP_FORMATTEDMESSAGESSENTPERSEC_DESC">The rate at which outbound messages are being sent </Description>
        </Display>
      </ColumnDescriptor>                                  
    </TableDescriptor>     


    <ExecutionDescriptor>
      <GetTable NAME="EXCH_SMTP_RAW"/>
    </ExecutionDescriptor>      


  </Metric>																		
  <!-- SMTP Metrics  (RAW)-->  

  <Metric NAME="EXCH_SMTP_RAW" TYPE="TABLE" USAGE_TYPE="HIDDEN_COLLECT">           

    <Display>
      <Label NLSID="EXCH_SMTP_RAW_LBL">SMTP Server Metrics</Label>
    </Display>        

    <TableDescriptor>   

      <ColumnDescriptor NAME="Name" TYPE="STRING" IS_KEY="TRUE">

      </ColumnDescriptor>          

      <!-- cooking type = PERF_COUNTER_RAWCOUNT(No computation required)  -->
      <ColumnDescriptor NAME="InboundConnectionsCurrent" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>                                  

      <!-- cooking type = PERF_COUNTER_RAWCOUNT(No computation required)  -->
      <ColumnDescriptor NAME="OutboundConnectionsCurrent" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>                                  

      <!-- cooking type = PERF_COUNTER_RAWCOUNT(No computation required)  -->
      <ColumnDescriptor NAME="LocalQueueLength" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>                                  

      <!-- cooking type = PERF_COUNTER_RAWCOUNT(No computation required)  -->
      <ColumnDescriptor NAME="RemoteQueueLength" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>                                  


      <!-- cooking type = PERF_COUNTER_COUNTER(No computation required)  -->
      <ColumnDescriptor NAME="MessagesReceivedPersec" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>                                  
      <!-- cooking type = PERF_COUNTER_COUNTER(No computation required)  -->
      <ColumnDescriptor NAME="MessagesSentPersec" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>                                  


      <ColumnDescriptor NAME="Timestamp_Sys100NS" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>     

      <ColumnDescriptor NAME="Frequency_Sys100NS" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>     

      <ColumnDescriptor NAME="MessagesReceivedPersecDiff" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="(MessagesReceivedPersec - _MessagesReceivedPersec)">

      </ColumnDescriptor>      

      <ColumnDescriptor NAME="MessagesSentPersecDiff" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="(MessagesSentPersec - _MessagesSentPersec)">

      </ColumnDescriptor>    


      <ColumnDescriptor NAME="TimeDiffSys" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="(Timestamp_Sys100NS - _Timestamp_Sys100NS)">

      </ColumnDescriptor>

      <ColumnDescriptor NAME="FormattedMessagesReceivedPersec" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="((MessagesReceivedPersecDiff/TimeDiffSys) * Frequency_Sys100NS)">

      </ColumnDescriptor>    


      <ColumnDescriptor NAME="FormattedMessagesSentPersec" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="((MessagesSentPersecDiff/TimeDiffSys) * Frequency_Sys100NS)">
      </ColumnDescriptor>    


    </TableDescriptor>  

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="local"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select  Name, InboundConnectionsCurrent, OutboundConnectionsCurrent, LocalQueueLength, RemoteQueueLength, MessagesReceivedPersec, MessagesSentPersec,Timestamp_Sys100NS,Frequency_Sys100NS from Win32_PerfRawData_SMTPSVC_SMTPServer where Name='_Total'</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">name, inboundconnectionscurrent, outboundconnectionscurrent, localqueuelength, remotequeuelength, messagesreceivedpersec, messagessentpersec,timestamp_sys100ns,frequency_sys100ns</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="remote"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="STDINWBEM_HOST" SCOPE="INSTANCE">Host</Property>
      <Property NAME="STDINWBEM_USERNAME" SCOPE="INSTANCE" OPTIONAL="TRUE">SysUsername</Property>
      <Property NAME="STDINWBEM_PASSWORD" SCOPE="INSTANCE" OPTIONAL="TRUE">SysPassword</Property>
      <Property NAME="ENVWBEM_REMOTE" SCOPE="GLOBAL">1</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select  Name, InboundConnectionsCurrent, OutboundConnectionsCurrent, LocalQueueLength, RemoteQueueLength, MessagesReceivedPersec, MessagesSentPersec,Timestamp_Sys100NS,Frequency_Sys100NS from Win32_PerfRawData_SMTPSVC_SMTPServer where Name='_Total'</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">name, inboundconnectionscurrent, outboundconnectionscurrent, localqueuelength, remotequeuelength, messagesreceivedpersec, messagessentpersec,timestamp_sys100ns,frequency_sys100ns</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>     

  </Metric>	  																																 

  <!-- Exchange Core Processes FORMATTED-->
  <Metric NAME="EXCH_PROC" TYPE="TABLE" >        	
    <Display>
      <Label NLSID="EXCH_PROC_LBL">Exchange Core Processes Performance</Label>
      <Description NLSID="EXCH_PROC_DESC">Exchange Core Processes Performance</Description>
    </Display>        

    <TableDescriptor>   

      <ColumnDescriptor NAME="Name" TYPE="STRING" IS_KEY="TRUE">
        <Display>
          <Label NLSID="EXCH_PROC_NAME_LBL">Name</Label>
          <Description NLSID="EXCH_PROC_NAME_DESC">Name of the process</Description>
        </Display>
      </ColumnDescriptor>     

      <ColumnDescriptor NAME="FormattedPercentProcessorTime" TYPE="NUMBER" IS_KEY="FALSE" >
        <Display>
          <Label NLSID="EXCH_PROC_FORMATTEDPERCENTPROCESSORTIME_LBL">CPU utilization(%)</Label>
          <Description NLSID="EXCH_PROC_FORMATTEDPERCENTPROCESSORTIME_DESC">The percentage of elapsed time that all of process threads used the processor to execute instructions</Description>
        </Display>
      </ColumnDescriptor>    

      <ColumnDescriptor NAME="VirtualBytesMB" TYPE="NUMBER" IS_KEY="FALSE" >
        <Display>
          <Label NLSID="EXCH_PROC_VIRTUALBYTESMB_LBL">Virtual Bytes (MB)</Label>
          <Description NLSID="EXCH_PROC_VIRTUALBYTESMB_DESC">Virtual Bytes is the current size, in bytes, of the virtual address space the process is using</Description>
        </Display>
      </ColumnDescriptor>                                  

      <ColumnDescriptor NAME="WorkingSetMB" TYPE="NUMBER" IS_KEY="FALSE" >
        <Display>
          <Label NLSID="EXCH_PROC_WORKINGSETMB_LBL">Working Set (MB)</Label>
          <Description NLSID="EXCH_PROC_WORKINGSETMB_DESC">The current size, in Megabytes, of the Working Set of this process</Description>
        </Display>
      </ColumnDescriptor>     

    </TableDescriptor>                                

    <ExecutionDescriptor>
      <GetTable NAME="EXCH_PROC_RAW" USE_CACHE="FALSE"/>
    </ExecutionDescriptor>    

  </Metric>

  <!-- Exchange Core Processes  RAW -->
  <Metric NAME="EXCH_PROC_RAW" TYPE="TABLE" USAGE_TYPE="HIDDEN_COLLECT">  


    <TableDescriptor>   

      <ColumnDescriptor NAME="Name" TYPE="STRING" IS_KEY="TRUE">

      </ColumnDescriptor>          

      <!-- cooking  type  = PERF_100NSEC_TIMER -->
      <ColumnDescriptor NAME="percentprocessortime" TYPE="NUMBER" IS_KEY="FALSE" TRANSIENT="TRUE">

      </ColumnDescriptor>  

      <!-- cooking type = PERF_COUNTER_LARGE_RAWCOUNT (No computation required)-->
      <ColumnDescriptor NAME="VirtualBytes" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>                                  

      <!-- cooking type = PERF_COUNTER_LARGE_RAWCOUNT (No computation required)-->
      <ColumnDescriptor NAME="WorkingSet" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>        

      <ColumnDescriptor NAME="timestamp_sys100ns" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>

      <ColumnDescriptor NAME="PercentProcessorTimeDiff" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="(percentprocessortime - _percentprocessortime)">

      </ColumnDescriptor>      

      <ColumnDescriptor NAME="TimeDiffSys" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="(timestamp_sys100ns - _timestamp_sys100ns)">

      </ColumnDescriptor>

      <ColumnDescriptor NAME="FormattedPercentProcessorTime" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="((PercentProcessorTimeDiff/TimeDiffSys) * 100)">

      </ColumnDescriptor>  

      <ColumnDescriptor NAME="VirtualBytesMB" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="((VirtualBytes)/(1024*1024))">

      </ColumnDescriptor>                                  

      <!-- cooking type = PERF_COUNTER_LARGE_RAWCOUNT (No computation required)-->
      <ColumnDescriptor NAME="WorkingSetMB" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="((WorkingSet)/(1024*1024))">

      </ColumnDescriptor>     


    </TableDescriptor>                                

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="local"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select name, percentprocessortime, virtualbytes, workingset, timestamp_sys100ns from  Win32_PerfRawData_PerfProc_Process where Name='store' or Name='mad' or Name='emsmta'</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">name, percentprocessortime, virtualbytes, workingset, timestamp_sys100ns</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="remote"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="STDINWBEM_HOST" SCOPE="INSTANCE">Host</Property>
      <Property NAME="STDINWBEM_USERNAME" SCOPE="INSTANCE" OPTIONAL="TRUE">SysUsername</Property>
      <Property NAME="STDINWBEM_PASSWORD" SCOPE="INSTANCE" OPTIONAL="TRUE">SysPassword</Property>
      <Property NAME="ENVWBEM_REMOTE" SCOPE="GLOBAL">1</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select name, percentprocessortime, virtualbytes, workingset, timestamp_sys100ns from  Win32_PerfRawData_PerfProc_Process where Name='store' or Name='mad' or Name='emsmta' </Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">name, percentprocessortime, virtualbytes, workingset, timestamp_sys100ns</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>     

  </Metric>

  <!-- Exchange Host  FORMATTED -->
  <Metric NAME="EXCH_HOST_TOTAL" TYPE="TABLE" >          

    <Display>
      <Label NLSID="EXCH_HOST_TOTAL_LBL">Exchange Host Metrics</Label>
      <Description NLSID="EXCH_HOST_TOTAL_DESC">Metrics about the Host on which Exchange Server is running</Description>
    </Display>   

    <TableDescriptor>   


      <ColumnDescriptor NAME="FormattedPercentProcessorTime" TYPE="NUMBER"  IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_HOST_TOTAL_FORMATTEDPERCENTPROCESSORTIME_LBL">CPU Utilization (%) </Label>
          <Description NLSID="EXCH_HOST_TOTAL_FORMATTEDPERCENTPROCESSORTIME_DESC">The total percentage CPU utilization by all the processes running on the host</Description>
        </Display>
      </ColumnDescriptor>  


      <ColumnDescriptor NAME="WorkingSetMB" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_HOST_TOTAL_WORKINGSETMB_LBL">Memory Utilization</Label>
          <Description NLSID="EXCH_HOST_TOTAL_WORKINGSETMB_DESC">The total Memory Utilization, in Megabytes, of all processes</Description>
        </Display>
      </ColumnDescriptor>  

      <ColumnDescriptor NAME="TotalPhysicalMemoryMB" TYPE="NUMBER" IS_KEY="FALSE"> 
        <Display>
          <Label NLSID="EXCH_HOST_TOTAL_TOTALPHYSICALMEMORYMB_LBL">Total Physical Memory</Label>
          <Description NLSID="EXCH_HOST_TOTAL_TOTALPHYSICALMEMORYMB_DESC">Total Main Memory installed on the host</Description>
        </Display>
      </ColumnDescriptor> 

      <ColumnDescriptor NAME="PercentageMemoryUtilization" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="(WorkingSetMB*100/TotalPhysicalMemoryMB)"> 
        <Display>
          <Label NLSID="EXCH_HOST_TOTAL_PERCENTAGEMEMORYUTILIZATION_LBL">Memory Utilization (%)</Label>
          <Description NLSID="EXCH_HOST_TOTAL_PERCENTAGEMEMORYUTILIZATION_DESC">Percentage of Main Memory used by the processes running on the host</Description>
        </Display>
      </ColumnDescriptor> 

    </TableDescriptor>

    <ExecutionDescriptor>
      <GetTable NAME="EXCH_HOST_TOTAL_MEM"/>	
      <GetTable NAME="EXCH_HOST_MEM"/>

      <GetView NAME="TOTAL_MEM" FROM_TABLE="EXCH_HOST_TOTAL_MEM">
        <Column NAME="TotalPhysicalMemoryMB" COLUMN_NAME="TotalPhysicalMemoryMB" /> 
      </GetView>


      <GetTable NAME="EXCH_HOST_CPU"/>	

      <JoinTables NAME="EXCH_HOST_TOTAL" OUTER="FALSE">		
        <Table NAME="EXCH_HOST_MEM" /> 
        <Table NAME="TOTAL_MEM" /> 
        <Table NAME="EXCH_HOST_CPU" />
      </JoinTables>
    </ExecutionDescriptor>
  </Metric>

  <!-- Exchange Host  MEM -->
  <Metric NAME="EXCH_HOST_MEM" TYPE="TABLE" USAGE_TYPE="HIDDEN_COLLECT">                      

    <TableDescriptor>   

      <!-- cooking type = PERF_COUNTER_LARGE_RAWCOUNT (No computation required)-->
      <ColumnDescriptor NAME="WorkingSet" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>        


      <!-- cooking type = PERF_COUNTER_LARGE_RAWCOUNT (No computation required)-->
      <ColumnDescriptor NAME="WorkingSetMB" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="((WorkingSet)/(1024*1024))">

      </ColumnDescriptor>                                             
    </TableDescriptor>                                

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="local"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select  workingset from Win32_PerfRawData_PerfProc_Process where Name='_total'</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">workingset</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="remote"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="STDINWBEM_HOST" SCOPE="INSTANCE">Host</Property>
      <Property NAME="STDINWBEM_USERNAME" SCOPE="INSTANCE" OPTIONAL="TRUE">SysUsername</Property>
      <Property NAME="STDINWBEM_PASSWORD" SCOPE="INSTANCE" OPTIONAL="TRUE">SysPassword</Property>
      <Property NAME="ENVWBEM_REMOTE" SCOPE="GLOBAL">1</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select  workingset from Win32_PerfRawData_PerfProc_Process where Name='_total'</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">workingset</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>     

  </Metric>

  <!-- Exchange HOST CPU  -->
  <Metric NAME="EXCH_HOST_CPU" TYPE="TABLE" USAGE_TYPE="HIDDEN">            
    <TableDescriptor>   

      <ColumnDescriptor NAME="FormattedPercentProcessorTime" TYPE="NUMBER"  IS_KEY="FALSE">

      </ColumnDescriptor>         

    </TableDescriptor>   

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="local"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="scriptsDir" SCOPE="SYSTEMGLOBAL">scriptsDir</Property>
      <Property NAME="perlBin" SCOPE="SYSTEMGLOBAL">perlBin</Property>
      <Property NAME="command" SCOPE="GLOBAL">%perlBin%/perl</Property>
      <Property NAME="script" SCOPE="GLOBAL">%scriptsDir%/exchange/cpu.pl</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>
    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="remote"/>
      </ValidIf>
      <Property NAME="ENVWBEM_REMOTE" SCOPE="GLOBAL">1</Property>
      <Property NAME="STDINWBEM_HOST" SCOPE="INSTANCE">Host</Property>
      <Property NAME="STDINWBEM_USERNAME" SCOPE="INSTANCE" OPTIONAL="TRUE">SysUsername</Property>
      <Property NAME="STDINWBEM_PASSWORD" SCOPE="INSTANCE" OPTIONAL="TRUE">SysPassword</Property>			
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="scriptsDir" SCOPE="SYSTEMGLOBAL">scriptsDir</Property>
      <Property NAME="perlBin" SCOPE="SYSTEMGLOBAL">perlBin</Property>
      <Property NAME="command" SCOPE="GLOBAL">%perlBin%/perl</Property>
      <Property NAME="script" SCOPE="GLOBAL">%scriptsDir%/exchange/cpu.pl</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>	
    </QueryDescriptor>
  </Metric>

  <!-- Exchange Host TOTAL Mem (RAW)-->
  <Metric NAME="EXCH_HOST_TOTAL_MEM" TYPE="TABLE" USAGE_TYPE="HIDDEN">            


    <TableDescriptor>   
      <ColumnDescriptor NAME="Name" TYPE="STRING" IS_KEY="TRUE">

      </ColumnDescriptor> 

      <ColumnDescriptor NAME="TotalPhysicalMemory" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>          


      <ColumnDescriptor NAME="TotalPhysicalMemoryMB" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="(TotalPhysicalMemory / (1024*1024))"> 

      </ColumnDescriptor> 



    </TableDescriptor>                                

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="local"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select name,   TotalPhysicalMemory from  Win32_ComputerSystem</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">name, totalphysicalmemory</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="remote"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="STDINWBEM_HOST" SCOPE="INSTANCE">Host</Property>
      <Property NAME="STDINWBEM_USERNAME" SCOPE="INSTANCE" OPTIONAL="TRUE">SysUsername</Property>
      <Property NAME="STDINWBEM_PASSWORD" SCOPE="INSTANCE" OPTIONAL="TRUE">SysPassword</Property>
      <Property NAME="ENVWBEM_REMOTE" SCOPE="GLOBAL">1</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select name,   TotalPhysicalMemory from  Win32_ComputerSystem</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">name, totalphysicalmemory</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>     

  </Metric>

  <!-- Exchange File System Driver -->    
  <Metric NAME="EXCH_FS_DRIVER" TYPE="TABLE">

    <Display>
      <Label NLSID="EXCH_FS_DRIVER_LBL">Exchange File System Driver Status</Label>
      <Description NLSID="EXCH_FS_DRIVER_DESC">Exchange File System Driver Status</Description>
    </Display>        

    <TableDescriptor>   
      <ColumnDescriptor NAME="Name" TYPE="STRING" IS_KEY="TRUE">
        <Display>
          <Label NLSID="EXCH_FS_DRIVER_NAME_LBL">Name</Label>
          <Description NLSID="EXCH_FS_DRIVER_NAME_DESC">Name of the Driver </Description>
        </Display>
      </ColumnDescriptor> 

      <ColumnDescriptor NAME="Started" TYPE="STRING" IS_KEY="TRUE">
        <Display>
          <Label NLSID="EXCH_FS_DRIVER_STARTED_LBL">Started</Label>
          <Description NLSID="EXCH_FS_DRIVER_STARTED_DESC">Started is a boolean indicating whether the service has been started (TRUE), or stopped (FALSE)</Description>
        </Display>
      </ColumnDescriptor> 

      <ColumnDescriptor NAME="Status" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_FS_DRIVER_STATUS_LBL">Status</Label>
          <Description NLSID="EXCH_FS_DRIVER_STATUS_DESC">Indicates the current status of the object.</Description>
        </Display>
      </ColumnDescriptor> 
    </TableDescriptor>   

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="local"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select Name,Started,Status from Win32_SystemDriver where name='EXIFS'</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">name,started,status</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="remote"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="STDINWBEM_HOST" SCOPE="INSTANCE">Host</Property>
      <Property NAME="STDINWBEM_USERNAME" SCOPE="INSTANCE" OPTIONAL="TRUE">SysUsername</Property>
      <Property NAME="STDINWBEM_PASSWORD" SCOPE="INSTANCE" OPTIONAL="TRUE">SysPassword</Property>
      <Property NAME="ENVWBEM_REMOTE" SCOPE="GLOBAL">1</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select Name,Started,Status from Win32_SystemDriver where name='EXIFS'</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">name,started,status</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2</Property>        
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>     
  </Metric>


  <!-- EXCHANGE Services Metrics  -->
  <Metric NAME="EXCH_SVC" TYPE="TABLE" >          

    <Display>
      <Label NLSID="EXCH_SVC_LBL">Exchange Services</Label>
      <Description NLSID="EXCH_SVC_DESC">Information on the performance of Exchange Services</Description>
    </Display>        

    <TableDescriptor>   

      <ColumnDescriptor NAME="Name" TYPE="STRING" IS_KEY="TRUE">
        <Display>
          <Label NLSID="EXCH_SVC_NAME_LBL">Name</Label>
          <Description NLSID="EXCH_SVC_NAME_DESC">Name of the Service</Description>
        </Display>
      </ColumnDescriptor>          

      <ColumnDescriptor NAME="Description" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_SVC_DESCRIPTION_LBL">Description</Label>
          <Description NLSID="EXCH_SVC_DESCRIPTION_DESC">Description of the Service</Description>
        </Display>
      </ColumnDescriptor>                                  

      <ColumnDescriptor NAME="DisplayName" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_SVC_DISPLAYNAME_LBL">Caption</Label>
          <Description NLSID="EXCH_SVC_DISPLAYNAME_DESC">A short textual description (one-line string) of the Service</Description>
        </Display>
      </ColumnDescriptor>                                  

      <ColumnDescriptor NAME="PathName" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_SVC_PATHNAME_LBL">PathName</Label>
          <Description NLSID="EXCH_SVC_PATHNAME_DESC">The fully qualified path to the service binary file that implements the service</Description>
        </Display>
      </ColumnDescriptor>                                                                        


      <ColumnDescriptor NAME="State" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_SVC_STATE_LBL">State</Label>
          <Description NLSID="EXCH_SVC_STATE_DESC">Indicates the current state of the base service</Description>
        </Display>
      </ColumnDescriptor> 


      <ColumnDescriptor NAME="Status" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_SVC_STATUS_LBL">Status</Label>
          <Description NLSID="EXCH_SVC_STATUS_DESC">Indicates the current status of the object.</Description>
        </Display>
      </ColumnDescriptor> 

      <ColumnDescriptor NAME="ProcessId" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_SVC_PROCESSID_LBL">ProcessId</Label>
          <Description NLSID="EXCH_SVC_PROCESSID_DESC">Specifies the process identifier of the service</Description>
        </Display>
      </ColumnDescriptor> 

    </TableDescriptor>     


    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="local"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select Name, Description, DisplayName, PathName, State, Status, ProcessId from Win32_Service where Name='MSExchangeIS' or Name='MSExchangeMTA'or Name='MSExchangeSA' or Name='MSExchangeES' or  Name='MSExchangeMGMT' or    Name='MSExchangeGWRtr' or Name='MSExchangeSRS'   or Name='RESvc' or Name='MSExchangeCalCon' or Name='MSExchangeCOCO' or Name='LME-NOTES' or Name='LME-GWISE' </Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">name, description, displayname, pathname, state, status, processid</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="remote"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="STDINWBEM_HOST" SCOPE="INSTANCE">Host</Property>
      <Property NAME="STDINWBEM_USERNAME" SCOPE="INSTANCE" OPTIONAL="TRUE">SysUsername</Property>
      <Property NAME="STDINWBEM_PASSWORD" SCOPE="INSTANCE" OPTIONAL="TRUE">SysPassword</Property>
      <Property NAME="ENVWBEM_REMOTE" SCOPE="GLOBAL">1</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select Name, Description, DisplayName, PathName, State, Status, ProcessId from Win32_Service where Name='MSExchangeIS' or Name='MSExchangeMTA'or Name='MSExchangeSA' or Name='MSExchangeES' or  Name='MSExchangeMGMT' or    Name='MSExchangeGWRtr' or Name='MSExchangeSRS'   or Name='RESvc' or Name='MSExchangeCalCon' or Name='MSExchangeCOCO' or Name='LME-NOTES' or Name='LME-GWISE' </Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">name, description, displayname, pathname, state, status, processid</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2</Property>        
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>                       
  </Metric>

  <!-- Disk  AGG (EXCH_DISK_AGG) FORMATTED -->
  <Metric NAME="EXCH_DISK_TOTAL" TYPE="TABLE" USAGE_TYPE="COLLECT_UPLOAD" HELP="NO_HELP">    

    <TableDescriptor>          
      <ColumnDescriptor NAME="Name" TYPE="STRING" IS_KEY="TRUE">
        <Display>
          <Label NLSID="EXCH_DISK_TOTAL_NAME_LBL">Name</Label>
          <Description NLSID="EXCH_DISK_TOTAL_NAME_DESC">Name of the Logical Disk</Description>
        </Display>
      </ColumnDescriptor>    

      <ColumnDescriptor NAME="FreeMegabytes" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_DISK_TOTAL_FREEMEGABYTES_LBL">Free Space (MB)</Label>
          <Description NLSID="EXCH_DISK_TOTAL_FREEMEGABYTES_DESC">Amount of free space on the logical disk in MB</Description>
        </Display>
      </ColumnDescriptor>      

      <ColumnDescriptor NAME="PercentFreeSpace_Base" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_DISK_TOTAL_PERCENTFREESPACE_BASE_LBL">Disk Size(MB)</Label>
          <Description NLSID="EXCH_DISK_TOTAL_PERCENTFREESPACE_BASE_DESC">Size of the logical Disk</Description>
        </Display>
      </ColumnDescriptor>     

      <ColumnDescriptor NAME="FormattedPercentFreeSpace" TYPE="NUMBER" IS_KEY="FALSE" >
        <Display>
          <Label NLSID="EXCH_DISK_TOTAL_FORMATTEDPERCENTFREESPACE_LBL">Free Space (%)</Label>
          <Description NLSID="EXCH_DISK_TOTAL_FORMATTEDPERCENTFREESPACE_DESC">Percentage of free Space on the disk</Description>
        </Display>
      </ColumnDescriptor>      

      <ColumnDescriptor NAME="FormattedDiskReadsPersec" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_DISK_TOTAL_FORMATTEDDISKREADSPERSEC_LBL">Disk Reads Per Second</Label>
          <Description NLSID="EXCH_DISK_TOTAL_FORMATTEDDISKREADSPERSEC_DESC">Number of disk reads per Second</Description>
        </Display>
      </ColumnDescriptor>                                  

      <ColumnDescriptor NAME="FormattedDiskWritesPersec" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_DISK_TOTAL_FORMATTEDDISKWRITESPERSEC_LBL">Disk Writes Per Second</Label>
          <Description NLSID="EXCH_DISK_TOTAL_FORMATTEDDISKWRITESPERSEC_DESC">Number of disk writes per second</Description>
        </Display>
      </ColumnDescriptor>      

    </TableDescriptor>    
    <ExecutionDescriptor>
      <GetTable NAME="EXCH_DISK_AGG"/>
      <GetView NAME="this" FROM_TABLE="EXCH_DISK_AGG">
        <Filter COLUMN_NAME="Name" OPERATOR="EQ">_Total</Filter>
      </GetView>
    </ExecutionDescriptor>    
  </Metric>

  <!-- Disk  AGG (EXCH_DISK_AGG) FORMATTED -->
  <Metric NAME="EXCH_DISK_AGG" TYPE="TABLE" >          
    <Display>
      <Label NLSID="EXCH_DISK_AGG_LBL">Logical Disk Performance Metrics</Label>
      <Description NLSID="EXCH_DISK_AGG_DESC">Logical Disk Performance Metrics</Description>
    </Display>

    <TableDescriptor>          
      <ColumnDescriptor NAME="Name" TYPE="STRING" IS_KEY="TRUE">
        <Display>
          <Label NLSID="EXCH_DISK_AGG_NAME_LBL">Name</Label>
          <Description NLSID="EXCH_DISK_AGG_NAME_DESC">Name of the Logical Disk</Description>
        </Display>
      </ColumnDescriptor>    

      <ColumnDescriptor NAME="FreeMegabytes" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_DISK_AGG_FREEMEGABYTES_LBL">Free Space (MB)</Label>
          <Description NLSID="EXCH_DISK_AGG_FREEMEGABYTES_DESC">Amount of free space on the logical disk in MB</Description>
        </Display>
      </ColumnDescriptor>      

      <ColumnDescriptor NAME="PercentFreeSpace_Base" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_DISK_AGG_PERCENTFREESPACE_BASE_LBL">Disk Size(MB)</Label>
          <Description NLSID="EXCH_DISK_AGG_PERCENTFREESPACE_BASE_DESC">Size of the logical Disk</Description>
        </Display>
      </ColumnDescriptor>     

      <ColumnDescriptor NAME="FormattedPercentFreeSpace" TYPE="NUMBER" IS_KEY="FALSE" >
        <Display>
          <Label NLSID="EXCH_DISK_AGG_FORMATTEDPERCENTFREESPACE_LBL">Free Space (%)</Label>
          <Description NLSID="EXCH_DISK_AGG_FORMATTEDPERCENTFREESPACE_DESC">Percentage of free Space on the disk</Description>
        </Display>
      </ColumnDescriptor>      

      <ColumnDescriptor NAME="FormattedDiskReadsPersec" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_DISK_AGG_FORMATTEDDISKREADSPERSEC_LBL">Disk Reads Per Second</Label>
          <Description NLSID="EXCH_DISK_AGG_FORMATTEDDISKREADSPERSEC_DESC">Number of disk reads per Second</Description>
        </Display>
      </ColumnDescriptor>                                  

      <ColumnDescriptor NAME="FormattedDiskWritesPersec" TYPE="NUMBER" IS_KEY="FALSE">
        <Display>
          <Label NLSID="EXCH_DISK_AGG_FORMATTEDDISKWRITESPERSEC_LBL">Disk Writes Per Second</Label>
          <Description NLSID="EXCH_DISK_AGG_FORMATTEDDISKWRITESPERSEC_DESC">Number of disk writes per second</Description>
        </Display>
      </ColumnDescriptor>      

    </TableDescriptor>  

    <ExecutionDescriptor>
      <GetTable NAME="EXCH_DISK_PERF_RAW" USE_CACHE="FALSE"/>		
    </ExecutionDescriptor>

  </Metric>


  <!-- DISK WIN32 RAW  PERF (EXCH_DISK_PERF_RAW) -->
  <Metric NAME="EXCH_DISK_PERF_RAW" TYPE="TABLE" USAGE_TYPE="HIDDEN_COLLECT">
    <TableDescriptor>          
      <ColumnDescriptor NAME="Name" TYPE="STRING" IS_KEY="TRUE">

      </ColumnDescriptor>                                  	 

      <!-- cooking type  = PERF_RAW_FRACTION  -->
      <ColumnDescriptor NAME="PercentFreeSpace" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>      

      <ColumnDescriptor NAME="PercentFreeSpace_Base" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>   


      <!-- cooking type  = PERF_COUNTER_COUNTER -->
      <ColumnDescriptor NAME="DiskReadsPersec" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>                                  

      <!-- cooking type  = PERF_COUNTER_COUNTER -->                  
      <ColumnDescriptor NAME="DiskWritesPersec" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>      

      <!-- cooking type  = PERF_COUNTER_RAWCOUNT (No computation required) -->
      <ColumnDescriptor NAME="FreeMegabytes" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>      

      <ColumnDescriptor NAME="Timestamp_Sys100NS" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>     

      <ColumnDescriptor NAME="Frequency_Sys100NS" TYPE="NUMBER" IS_KEY="FALSE">

      </ColumnDescriptor>     

      <ColumnDescriptor NAME="DiskWritesPersecDiff" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="(DiskWritesPersec - _DiskWritesPersec)">

      </ColumnDescriptor>      

      <ColumnDescriptor NAME="DiskReadsPersecDiff" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="(DiskReadsPersec - _DiskReadsPersec)">

      </ColumnDescriptor>    


      <ColumnDescriptor NAME="TimeDiffSys" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="(Timestamp_Sys100NS - _Timestamp_Sys100NS)">

      </ColumnDescriptor>

      <ColumnDescriptor NAME="FormattedDiskWritesPersec" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="((DiskWritesPersecDiff/TimeDiffSys) * Frequency_Sys100NS)">

      </ColumnDescriptor>    


      <ColumnDescriptor NAME="FormattedDiskReadsPersec" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="((DiskReadsPersecDiff/TimeDiffSys) * Frequency_Sys100NS)">

      </ColumnDescriptor>   


      <ColumnDescriptor NAME="FormattedPercentFreeSpace" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="((PercentFreeSpace/PercentFreeSpace_Base) * 100)">

      </ColumnDescriptor>   


    </TableDescriptor>       

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="local"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select Name, PercentFreeSpace,PercentFreeSpace_Base,DiskReadsPersec,DiskWritesPersec,FreeMegabytes,Timestamp_Sys100NS,Frequency_Sys100NS from Win32_PerfRawData_PerfDisk_LogicalDisk where Name is not null</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">name,percentfreespace,percentfreespace_base,diskreadspersec,diskwritespersec,freemegabytes,timestamp_sys100ns,frequency_sys100ns </Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>

    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="remote"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="command" SCOPE="GLOBAL">%emdRoot%/bin/nmefwmi</Property>
      <Property NAME="STDINWBEM_HOST" SCOPE="INSTANCE">Host</Property>
      <Property NAME="STDINWBEM_USERNAME" SCOPE="INSTANCE" OPTIONAL="TRUE">SysUsername</Property>
      <Property NAME="STDINWBEM_PASSWORD" SCOPE="INSTANCE" OPTIONAL="TRUE">SysPassword</Property>
      <Property NAME="ENVWBEM_REMOTE" SCOPE="GLOBAL">1</Property>
      <Property NAME="ENVWBEM_WQL" SCOPE="GLOBAL">select Name, PercentFreeSpace,PercentFreeSpace_Base,DiskReadsPersec,DiskWritesPersec,FreeMegabytes,Timestamp_Sys100NS,Frequency_Sys100NS from Win32_PerfRawData_PerfDisk_LogicalDisk where Name is not null</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">name,percentfreespace,percentfreespace_base,diskreadspersec,diskwritespersec,freemegabytes,timestamp_sys100ns,frequency_sys100ns </Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2</Property>  
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>     
  </Metric>

  <!-- ""Error Events""  APPLICATION EVENT Log for MS EXCHANGE  -->
  <Metric NAME="MSEXCHANGE_ERROR_Events" TYPE="TABLE">
    <Display>
      <Label NLSID="MSEXCHANGE_ERROR_EVENTS_LBL">Windows Event log - MS Exchange Error Events</Label>
      <Description NLSID="MSEXCHANGE_ERROR_EVENTS_DESC">Windows Event log - MS Exchange Error Events</Description>
    </Display>
    <TableDescriptor>
      <ColumnDescriptor NAME="type" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="MSEXCHANGE_ERROR_EVENTS_TYPE_LBL">Windows Event Severity</Label>
          <Description NLSID="MSEXCHANGE_ERROR_EVENTS_TYPE_DESC">Severity of the Windows Event </Description>
        </Display>
      </ColumnDescriptor>
      <ColumnDescriptor NAME="timegenerated" TYPE="STRING" IS_KEY="TRUE">
        <Display>
          <Label NLSID="MSEXCHANGE_ERROR_EVENTS_TIMEGENERATED_LBL">Date-Time</Label>
          <Description NLSID="MSEXCHANGE_ERROR_EVENTS_TIMEGENERATED_DESC">Specifies the date and time at which the source generated the event</Description>
        </Display>
      </ColumnDescriptor>
      <ColumnDescriptor NAME="sourcename" TYPE="STRING" IS_KEY="TRUE">
        <Display>
          <Label NLSID="MSEXCHANGE_ERROR_EVENTS_SOURCENAME_LBL">Source</Label>
          <Description NLSID="MSEXCHANGE_ERROR_EVENTS_SOURCENAME_DESC">The variable-length null-terminated string specifying the name of the source that generated the entry</Description>
        </Display>
      </ColumnDescriptor>
      <ColumnDescriptor NAME="eventidentifier" TYPE="NUMBER" IS_KEY="TRUE">
        <Display>
          <Label NLSID="MSEXCHANGE_ERROR_EVENTS_EVENTIDENTIFIER_LBL">Event Identifier</Label>
          <Description NLSID="MSEXCHANGE_ERROR_EVENTS_EVENTIDENTIFIER_DESC">Identifies the event</Description>
        </Display>
      </ColumnDescriptor>
      <ColumnDescriptor NAME="logfile" TYPE="STRING" IS_KEY="TRUE">
        <Display>
          <Label NLSID="MSEXCHANGE_ERROR_EVENTS_LOGFILE_LBL">Log Name</Label>
          <Description NLSID="MSEXCHANGE_ERROR_EVENTS_LOGFILE_DESC">The name of NT Eventlog logfile. This is used together with the RecordNumber to uniquely identify an instance of this class</Description>
        </Display>
      </ColumnDescriptor>
      <ColumnDescriptor NAME="message" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="MSEXCHANGE_ERROR_EVENTS_MESSAGE_LBL">Description</Label>
          <Description NLSID="MSEXCHANGE_ERROR_EVENTS_MESSAGE_DESC">The event message as it appears in the NT Eventlog</Description>
        </Display>
      </ColumnDescriptor>
      <ColumnDescriptor NAME="recordnumber" TYPE="STRING" IS_KEY="FALSE">
        <Display>
          <Label NLSID="MSEXCHANGE_ERROR_EVENTS_RECORDNUMBER_LBL">Record Number</Label>
          <Description NLSID="MSEXCHANGE_ERROR_EVENTS_RECORDNUMBER_DESC">Identifies the event within the NT Eventlog logfile</Description>
        </Display>
      </ColumnDescriptor>

    </TableDescriptor>
    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="local"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="scriptsDir" SCOPE="SYSTEMGLOBAL">scriptsDir</Property>
      <Property NAME="perlBin" SCOPE="SYSTEMGLOBAL">perlBin</Property>
      <Property NAME="command" SCOPE="GLOBAL">%perlBin%/perl</Property>
      <Property NAME="script" SCOPE="GLOBAL">%scriptsDir%/exchange/microsofteventlog.pl</Property>
      <Property NAME="ENVWBEM_FILENAME" SCOPE="GLOBAL">SYSTEM</Property>
      <Property NAME="ENVWBEM_SOURCENAME" SCOPE="GLOBAL">sourcename='ESE' or sourcename='MSExchangeActiveSyncNotify' or sourcename='MSExchangeAL' or sourcename='MSExchangeDSAccess' or sourcename='MSExchangeFBPublish' or sourcename='MSExchangeIS' or sourcename='MSExchangeIS Mailbox Store' or sourcename='MSExchangeIS Public Store' or sourcename='MSExchangeMGMT' or sourcename='MSExchangeMTA' or sourcename='MSExchangeSA' or sourcename='MSExchangeTransport'</Property>
      <Property NAME="ENVWBEM_SINCELASTUPLOAD" SCOPE="GLOBAL">Y</Property>
      <Property NAME="ENVWBEM_EVENTTYPE" SCOPE="GLOBAL">Error</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">type,timegenerated,sourcename,eventidentifier,logfile,message,recordnumber</Property>
      <Property NAME="ENVWBEM_KEYCOLUMNS" SCOPE="GLOBAL">logfile,sourcename,eventidentifier,timegenerated,recordnumber</Property>
      <Property NAME="ENVWBEM_REMOTE" SCOPE="GLOBAL">0</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>
    <QueryDescriptor FETCHLET_ID="OSLineToken">
      <ValidIf>
        <CategoryProp NAME="AgentType" CHOICES="remote"/>
      </ValidIf>
      <Property NAME="emdRoot" SCOPE="SYSTEMGLOBAL">emdRoot</Property>
      <Property NAME="scriptsDir" SCOPE="SYSTEMGLOBAL">scriptsDir</Property>
      <Property NAME="perlBin" SCOPE="SYSTEMGLOBAL">perlBin</Property>
      <Property NAME="command" SCOPE="GLOBAL">%perlBin%/perl</Property>
      <Property NAME="ENVWBEM_NAMESPACE" SCOPE="GLOBAL">root\cimv2</Property>
      <Property NAME="ENVWBEM_REMOTE" SCOPE="GLOBAL">1</Property>
      <Property NAME="STDINWBEM_HOST" SCOPE="INSTANCE">Host</Property>
      <Property NAME="STDINWBEM_USERNAME" SCOPE="INSTANCE" OPTIONAL="TRUE">SysUsername</Property>
      <Property NAME="STDINWBEM_PASSWORD" SCOPE="INSTANCE" OPTIONAL="TRUE">SysPassword</Property>
      <Property NAME="script" SCOPE="GLOBAL">%scriptsDir%/exchange/microsofteventlog.pl</Property>
      <Property NAME="ENVWBEM_FILENAME" SCOPE="GLOBAL">SYSTEM</Property>
      <Property NAME="ENVWBEM_SOURCENAME" SCOPE="GLOBAL">sourcename='ESE' or sourcename='MSExchangeActiveSyncNotify' or sourcename='MSExchangeAL' or sourcename='MSExchangeDSAccess' or sourcename='MSExchangeFBPublish' or sourcename='MSExchangeIS' or sourcename='MSExchangeIS Mailbox Store' or sourcename='MSExchangeIS Public Store' or sourcename='MSExchangeMGMT' or sourcename='MSExchangeMTA' or sourcename='MSExchangeSA' or sourcename='MSExchangeTransport'</Property>
      <Property NAME="ENVWBEM_SINCELASTUPLOAD" SCOPE="GLOBAL">Y</Property>
      <Property NAME="ENVWBEM_EVENTTYPE" SCOPE="GLOBAL">Error</Property>
      <Property NAME="ENVWBEM_WQL_COLUMN_ORDER" SCOPE="GLOBAL">type,timegenerated,sourcename,eventcode,logfile,message,recordnumber</Property>
      <Property NAME="ENVWBEM_KEYCOLUMNS" SCOPE="GLOBAL">logfile,sourcename,eventcode,timegenerated,recordnumber</Property>
      <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      <Property NAME="delimiter" SCOPE="GLOBAL">|</Property>
      <Property NAME="NEED_CONDITION_CONTEXT" SCOPE="GLOBAL">TRUE</Property>
    </QueryDescriptor>
  </Metric>

  <!-- Aggregating outgoing and incoming message Traffic  -->
  <Metric NAME="EXCH_MSG_TRFC" TYPE="TABLE" USAGE_TYPE="COLLECT_UPLOAD">          
    <Display>
      <Label NLSID="EXCH_MSG_TRFC_LBL">Message Traffic</Label>

    </Display>

    <TableDescriptor>        


      <!-- MTA -->
      <ColumnDescriptor NAME="TotalOutgoingMessagesPerSec" TYPE="NUMBER" IS_KEY="FALSE">        
      </ColumnDescriptor> 

      <!-- SMTP -->

      <ColumnDescriptor NAME="FormattedMessagesSentPersec" TYPE="NUMBER" IS_KEY="FALSE">        
      </ColumnDescriptor>  

      <ColumnDescriptor NAME="MessagesDeliveredPerSec" TYPE="NUMBER" IS_KEY="FALSE">        
      </ColumnDescriptor>  



      <!-- TOTAL -->

      <ColumnDescriptor NAME="TotalOutgoingTraffic" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="(FormattedMessagesSentPersec+TotalOutgoingMessagesPerSec)" >
        <Display>
          <Label NLSID="MESGTRFC_TotalOutgoingTraffic">Total Outgoing Traffic</Label>
        </Display>

      </ColumnDescriptor>    	

      <ColumnDescriptor NAME="TotalIncomingTraffic" TYPE="NUMBER" IS_KEY="FALSE" COMPUTE_EXPR="(MessagesDeliveredPerSec)">

        <Display>
          <Label NLSID="MESGTRFC_TotalIncomingTraffic">Total Incoming Traffic</Label>
        </Display>
      </ColumnDescriptor>


    </TableDescriptor>      
    <ExecutionDescriptor>

      <GetTable NAME="EXCH_SMTP" USE_CACHE="FALSE"/>
      <GetTable NAME="EXCH_IS_MAILBOX_FORMATTED_TOTAL" USE_CACHE="FALSE"/>
      <GetTable NAME="EXCH_IS_PUBLIC_TOTAL" USE_CACHE="FALSE"/>
      <GetTable NAME="EXCH_MTA_TOTAL" USE_CACHE="FALSE"/>

      <GetView NAME="inmailstore" FROM_TABLE="EXCH_IS_MAILBOX_FORMATTED_TOTAL">
        <Column NAME="MessagesDeliveredPerSec"/>
      </GetView>
      <GetView NAME="inpublicstore" FROM_TABLE="EXCH_IS_PUBLIC_TOTAL">
        <Column NAME="MessagesDeliveredPerSec"/>
      </GetView>


      <Union NAME="intraffic">
        <Table NAME="inmailstore" />
        <Table NAME="inpublicstore" />
      </Union>
      <GroupBy NAME="finalintraffic" FROM_TABLE="intraffic">
        <AggregateColumn NAME="MessagesDeliveredPerSec" COLUMN_NAME="MessagesDeliveredPerSec" OPERATOR="SUM"/>
      </GroupBy> 
      <JoinTables NAME="EXCH_MSG_TRFC" OUTER="FALSE">
        <Table NAME="EXCH_SMTP" />
        <Table NAME="finalintraffic" />
        <Table NAME="EXCH_MTA_TOTAL" />		   
      </JoinTables>

    </ExecutionDescriptor>
  </Metric>



  <InstanceProperties>
    <InstanceProperty NAME="Host" CREDENTIAL="FALSE" OPTIONAL="FALSE">
      <Display>
        <Label NLSID="HOST">Host Name</Label>
      </Display>
    </InstanceProperty>
    <InstanceProperty NAME="SysUsername" CREDENTIAL="TRUE" OPTIONAL="TRUE">
      <Display>
        <Label NLSID="SysUsername">System Username(Needed when Exchange Server is remote to Agent)</Label>
      </Display>
    </InstanceProperty>
    <InstanceProperty NAME="SysPassword" CREDENTIAL="TRUE" OPTIONAL="TRUE">
      <Display>
        <Label NLSID="SysPassword">System Password(Needed when Exchange Server is remote to Agent)</Label>
      </Display>
    </InstanceProperty>
    <InstanceProperty NAME="AGENT_TYPE" CREDENTIAL="FALSE" OPTIONAL="FALSE">
      <Display>
        <Label NLSID="AGENT_TYPE">Agent Location (specify 'remote' or 'local')</Label>
      </Display>
    </InstanceProperty>
    <DynamicProperties NAME="ComputeAgentType" FORMAT="ROW"
      PROP_LIST="AgentType">
      <QueryDescriptor FETCHLET_ID="OSLineToken">
        <Property NAME="scriptsDir" SCOPE="SYSTEMGLOBAL">scriptsDir</Property>
        <Property NAME="perlBin" SCOPE="SYSTEMGLOBAL">perlBin</Property>
        <Property NAME="command" SCOPE="GLOBAL">%perlBin%/perl</Property>
        <Property NAME="agenttype" SCOPE="INSTANCE">AGENT_TYPE</Property>
        <Property NAME="script" SCOPE="GLOBAL">%scriptsDir%/echoBack.pl "%agenttype%"</Property>
        <Property NAME="startsWith" SCOPE="GLOBAL">em_result=</Property>
      </QueryDescriptor>
    </DynamicProperties>
  </InstanceProperties>
</TargetMetadata>
